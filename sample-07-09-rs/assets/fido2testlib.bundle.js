/*! For license information please see fido2testlib.bundle.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("crypto")):"function"==typeof define&&define.amd?define(["crypto"],t):"object"==typeof exports?exports.fido2testlib=t(require("crypto")):e.fido2testlib=t(e.crypto)}(this,(e=>(()=>{var t={3650:(e,t,r)=>{"use strict";const n=r(2993),i=t,o={"2 5 29 9":"subjectDirectoryAttributes","2 5 29 14":"subjectKeyIdentifier","2 5 29 15":"keyUsage","2 5 29 17":"subjectAlternativeName","2 5 29 18":"issuerAlternativeName","2 5 29 19":"basicConstraints","2 5 29 20":"cRLNumber","2 5 29 21":"reasonCode","2 5 29 24":"invalidityDate","2 5 29 27":"deltaCRLIndicator","2 5 29 28":"issuingDistributionPoint","2 5 29 29":"certificateIssuer","2 5 29 30":"nameConstraints","2 5 29 31":"cRLDistributionPoints","2 5 29 32":"certificatePolicies","2 5 29 33":"policyMappings","2 5 29 35":"authorityKeyIdentifier","2 5 29 36":"policyConstraints","2 5 29 37":"extendedKeyUsage","2 5 29 46":"freshestCRL","2 5 29 54":"inhibitAnyPolicy","1 3 6 1 5 5 7 1 1":"authorityInformationAccess","1 3 6 1 5 5 7 11":"subjectInformationAccess"},s=n.define("CertificateList",(function(){this.seq().obj(this.key("tbsCertList").use(p),this.key("signatureAlgorithm").use(a),this.key("signature").bitstr())}));i.CertificateList=s;const a=n.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional().any())}));i.AlgorithmIdentifier=a;const u=n.define("Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(c),this.key("signatureAlgorithm").use(a),this.key("signature").bitstr())}));i.Certificate=u;const c=n.define("TBSCertificate",(function(){this.seq().obj(this.key("version").def("v1").explicit(0).use(f),this.key("serialNumber").int(),this.key("signature").use(a),this.key("issuer").use(v),this.key("validity").use(l),this.key("subject").use(v),this.key("subjectPublicKeyInfo").use(d),this.key("issuerUniqueID").optional().implicit(1).bitstr(),this.key("subjectUniqueID").optional().implicit(2).bitstr(),this.key("extensions").optional().explicit(3).seqof(b))}));i.TBSCertificate=c;const f=n.define("Version",(function(){this.int({0:"v1",1:"v2",2:"v3"})}));i.Version=f;const l=n.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(h),this.key("notAfter").use(h))}));i.Validity=l;const h=n.define("Time",(function(){this.choice({utcTime:this.utctime(),genTime:this.gentime()})}));i.Time=h;const d=n.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())}));i.SubjectPublicKeyInfo=d;const p=n.define("TBSCertList",(function(){this.seq().obj(this.key("version").optional().int(),this.key("signature").use(a),this.key("issuer").use(v),this.key("thisUpdate").use(h),this.key("nextUpdate").use(h),this.key("revokedCertificates").optional().seqof(y),this.key("crlExtensions").explicit(0).optional().seqof(b))}));i.TBSCertList=p;const y=n.define("RevokedCertificate",(function(){this.seq().obj(this.key("userCertificate").use(I),this.key("revocationDate").use(h),this.key("crlEntryExtensions").optional().seqof(b))})),b=n.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(o),this.key("critical").bool().def(!1),this.key("extnValue").octstr().contains((function(e){return Pe[e.extnID]||n.define("OctString",(function(){this.any()}))})))}));i.Extension=b;const v=n.define("Name",(function(){this.choice({rdnSequence:this.use(A)})}));i.Name=v;const g=n.define("GeneralName",(function(){this.choice({otherName:this.implicit(0).use(w),rfc822Name:this.implicit(1).ia5str(),dNSName:this.implicit(2).ia5str(),directoryName:this.explicit(4).use(v),ediPartyName:this.implicit(5).use(S),uniformResourceIdentifier:this.implicit(6).ia5str(),iPAddress:this.implicit(7).octstr(),registeredID:this.implicit(8).objid()})}));i.GeneralName=g;const m=n.define("GeneralNames",(function(){this.seqof(g)}));i.GeneralNames=m;const w=n.define("AnotherName",(function(){this.seq().obj(this.key("type-id").objid(),this.key("value").explicit(0).any())}));i.AnotherName=w;const S=n.define("EDIPartyName",(function(){this.seq().obj(this.key("nameAssigner").implicit(0).optional().use(B),this.key("partyName").implicit(1).use(B))}));i.EDIPartyName=S;const A=n.define("RDNSequence",(function(){this.seqof(_)}));i.RDNSequence=A;const _=n.define("RelativeDistinguishedName",(function(){this.setof(M)}));i.RelativeDistinguishedName=_;const M=n.define("AttributeTypeAndValue",(function(){this.seq().obj(this.key("type").use(x),this.key("value").use(E))}));i.AttributeTypeAndValue=M;const k=n.define("Attribute",(function(){this.seq().obj(this.key("type").use(x),this.key("values").setof(E))}));i.Attribute=k;const x=n.define("AttributeType",(function(){this.objid()}));i.AttributeType=x;const E=n.define("AttributeValue",(function(){this.any()}));i.AttributeValue=E;const B=n.define("DirectoryString",(function(){this.choice({teletexString:this.t61str(),printableString:this.printstr(),universalString:this.unistr(),utf8String:this.utf8str(),bmpString:this.bmpstr()})}));i.DirectoryString=B;const O=n.define("AuthorityKeyIdentifier",(function(){this.seq().obj(this.key("keyIdentifier").implicit(0).optional().use(j),this.key("authorityCertIssuer").implicit(1).optional().use(m),this.key("authorityCertSerialNumber").implicit(2).optional().use(I))}));i.AuthorityKeyIdentifier=O;const j=n.define("KeyIdentifier",(function(){this.octstr()}));i.KeyIdentifier=j;const I=n.define("CertificateSerialNumber",(function(){this.int()}));i.CertificateSerialNumber=I;const P=n.define("ORAddress",(function(){this.seq().obj(this.key("builtInStandardAttributes").use(C),this.key("builtInDomainDefinedAttributes").optional().use(V),this.key("extensionAttributes").optional().use(J))}));i.ORAddress=P;const C=n.define("BuiltInStandardAttributes",(function(){this.seq().obj(this.key("countryName").optional().use(N),this.key("administrationDomainName").optional().use(U),this.key("networkAddress").implicit(0).optional().use(T),this.key("terminalIdentifier").implicit(1).optional().use(D),this.key("privateDomainName").explicit(2).optional().use(K),this.key("organizationName").implicit(3).optional().use(L),this.key("numericUserIdentifier").implicit(4).optional().use(z),this.key("personalName").implicit(5).optional().use(H),this.key("organizationalUnitNames").implicit(6).optional().use(q))}));i.BuiltInStandardAttributes=C;const N=n.define("CountryName",(function(){this.choice({x121DccCode:this.numstr(),iso3166Alpha2Code:this.printstr()})}));i.CountryName=N;const U=n.define("AdministrationDomainName",(function(){this.choice({numeric:this.numstr(),printable:this.printstr()})}));i.AdministrationDomainName=U;const T=n.define("NetworkAddress",(function(){this.use(R)}));i.NetworkAddress=T;const R=n.define("X121Address",(function(){this.numstr()}));i.X121Address=R;const D=n.define("TerminalIdentifier",(function(){this.printstr()}));i.TerminalIdentifier=D;const K=n.define("PrivateDomainName",(function(){this.choice({numeric:this.numstr(),printable:this.printstr()})}));i.PrivateDomainName=K;const L=n.define("OrganizationName",(function(){this.printstr()}));i.OrganizationName=L;const z=n.define("NumericUserIdentifier",(function(){this.numstr()}));i.NumericUserIdentifier=z;const H=n.define("PersonalName",(function(){this.set().obj(this.key("surname").implicit(0).printstr(),this.key("givenName").implicit(1).printstr(),this.key("initials").implicit(2).printstr(),this.key("generationQualifier").implicit(3).printstr())}));i.PersonalName=H;const q=n.define("OrganizationalUnitNames",(function(){this.seqof(F)}));i.OrganizationalUnitNames=q;const F=n.define("OrganizationalUnitName",(function(){this.printstr()}));i.OrganizationalUnitName=F;const V=n.define("BuiltInDomainDefinedAttributes",(function(){this.seqof($)}));i.BuiltInDomainDefinedAttributes=V;const $=n.define("BuiltInDomainDefinedAttribute",(function(){this.seq().obj(this.key("type").printstr(),this.key("value").printstr())}));i.BuiltInDomainDefinedAttribute=$;const J=n.define("ExtensionAttributes",(function(){this.seqof(W)}));i.ExtensionAttributes=J;const W=n.define("ExtensionAttribute",(function(){this.seq().obj(this.key("extensionAttributeType").implicit(0).int(),this.key("extensionAttributeValue").any().explicit(1).int())}));i.ExtensionAttribute=W;const G=n.define("SubjectKeyIdentifier",(function(){this.use(j)}));i.SubjectKeyIdentifier=G;const Z=n.define("KeyUsage",(function(){this.bitstr()}));i.KeyUsage=Z;const Y=n.define("CertificatePolicies",(function(){this.seqof(X)}));i.CertificatePolicies=Y;const X=n.define("PolicyInformation",(function(){this.seq().obj(this.key("policyIdentifier").use(Q),this.key("policyQualifiers").optional().use(ee))}));i.PolicyInformation=X;const Q=n.define("CertPolicyId",(function(){this.objid()}));i.CertPolicyId=Q;const ee=n.define("PolicyQualifiers",(function(){this.seqof(te)}));i.PolicyQualifiers=ee;const te=n.define("PolicyQualifierInfo",(function(){this.seq().obj(this.key("policyQualifierId").use(re),this.key("qualifier").any())}));i.PolicyQualifierInfo=te;const re=n.define("PolicyQualifierId",(function(){this.objid()}));i.PolicyQualifierId=re;const ne=n.define("PolicyMappings",(function(){this.seqof(ie)}));i.PolicyMappings=ne;const ie=n.define("PolicyMapping",(function(){this.seq().obj(this.key("issuerDomainPolicy").use(Q),this.key("subjectDomainPolicy").use(Q))}));i.PolicyMapping=ie;const oe=n.define("SubjectAlternativeName",(function(){this.use(m)}));i.SubjectAlternativeName=oe;const se=n.define("IssuerAlternativeName",(function(){this.use(m)}));i.IssuerAlternativeName=se;const ae=n.define("SubjectDirectoryAttributes",(function(){this.seqof(k)}));i.SubjectDirectoryAttributes=ae;const ue=n.define("BasicConstraints",(function(){this.seq().obj(this.key("cA").bool().def(!1),this.key("pathLenConstraint").optional().int())}));i.BasicConstraints=ue;const ce=n.define("NameConstraints",(function(){this.seq().obj(this.key("permittedSubtrees").implicit(0).optional().use(fe),this.key("excludedSubtrees").implicit(1).optional().use(fe))}));i.NameConstraints=ce;const fe=n.define("GeneralSubtrees",(function(){this.seqof(le)}));i.GeneralSubtrees=fe;const le=n.define("GeneralSubtree",(function(){this.seq().obj(this.key("base").use(g),this.key("minimum").implicit(0).def(0).use(he),this.key("maximum").implicit(0).optional().use(he))}));i.GeneralSubtree=le;const he=n.define("BaseDistance",(function(){this.int()}));i.BaseDistance=he;const de=n.define("PolicyConstraints",(function(){this.seq().obj(this.key("requireExplicitPolicy").implicit(0).optional().use(pe),this.key("inhibitPolicyMapping").implicit(1).optional().use(pe))}));i.PolicyConstraints=de;const pe=n.define("SkipCerts",(function(){this.int()}));i.SkipCerts=pe;const ye=n.define("ExtendedKeyUsage",(function(){this.seqof(be)}));i.ExtendedKeyUsage=ye;const be=n.define("KeyPurposeId",(function(){this.objid()}));i.KeyPurposeId=be;const ve=n.define("CRLDistributionPoints",(function(){this.seqof(ge)}));i.CRLDistributionPoints=ve;const ge=n.define("DistributionPoint",(function(){this.seq().obj(this.key("distributionPoint").optional().explicit(0).use(me),this.key("reasons").optional().implicit(1).use(we),this.key("cRLIssuer").optional().implicit(2).use(m))}));i.DistributionPoint=ge;const me=n.define("DistributionPointName",(function(){this.choice({fullName:this.implicit(0).use(m),nameRelativeToCRLIssuer:this.implicit(1).use(_)})}));i.DistributionPointName=me;const we=n.define("ReasonFlags",(function(){this.bitstr()}));i.ReasonFlags=we;const Se=n.define("InhibitAnyPolicy",(function(){this.use(pe)}));i.InhibitAnyPolicy=Se;const Ae=n.define("FreshestCRL",(function(){this.use(ve)}));i.FreshestCRL=Ae;const _e=n.define("AuthorityInfoAccessSyntax",(function(){this.seqof(Me)}));i.AuthorityInfoAccessSyntax=_e;const Me=n.define("AccessDescription",(function(){this.seq().obj(this.key("accessMethod").objid(),this.key("accessLocation").use(g))}));i.AccessDescription=Me;const ke=n.define("SubjectInformationAccess",(function(){this.seqof(Me)}));i.SubjectInformationAccess=ke;const xe=n.define("CRLNumber",(function(){this.int()}));i.CRLNumber=xe;const Ee=n.define("DeltaCRLIndicator",(function(){this.use(xe)}));i.DeltaCRLIndicator=Ee;const Be=n.define("IssuingDistributionPoint",(function(){this.seq().obj(this.key("distributionPoint").explicit(0).optional().use(me),this.key("onlyContainsUserCerts").implicit(1).def(!1).bool(),this.key("onlyContainsCACerts").implicit(2).def(!1).bool(),this.key("onlySomeReasons").implicit(3).optional().use(we),this.key("indirectCRL").implicit(4).def(!1).bool(),this.key("onlyContainsAttributeCerts").implicit(5).def(!1).bool())}));i.IssuingDistributionPoint=Be;const Oe=n.define("ReasonCode",(function(){this.enum({0:"unspecified",1:"keyCompromise",2:"cACompromise",3:"affiliationChanged",4:"superseded",5:"cessationOfOperation",6:"certificateHold",8:"removeFromCRL",9:"privilegeWithdrawn",10:"aACompromise"})}));i.ReasonCode=Oe;const je=n.define("InvalidityDate",(function(){this.gentime()}));i.InvalidityDate=je;const Ie=n.define("CertificateIssuer",(function(){this.use(m)}));i.CertificateIssuer=Ie;const Pe={subjectDirectoryAttributes:ae,subjectKeyIdentifier:G,keyUsage:Z,subjectAlternativeName:oe,issuerAlternativeName:se,basicConstraints:ue,cRLNumber:xe,reasonCode:Oe,invalidityDate:je,deltaCRLIndicator:Ee,issuingDistributionPoint:Be,certificateIssuer:Ie,nameConstraints:ce,cRLDistributionPoints:ve,certificatePolicies:Y,policyMappings:ne,authorityKeyIdentifier:O,policyConstraints:de,extendedKeyUsage:ye,freshestCRL:Ae,inhibitAnyPolicy:Se,authorityInformationAccess:_e,subjectInformationAccess:ke}},2993:(e,t,r)=>{"use strict";const n=t;n.bignum=r(1172),n.define=r(1050).define,n.base=r(5251),n.constants=r(2599),n.decoders=r(8620),n.encoders=r(8588)},1050:(e,t,r)=>{"use strict";const n=r(8588),i=r(8620),o=r(2937);function s(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}t.define=function(e,t){return new s(e,t)},s.prototype._createNamed=function(e){const t=this.name;function r(e){this._initNamed(e,t)}return o(r,e),r.prototype._initNamed=function(t,r){e.call(this,t,r)},new r(this)},s.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(i[e])),this.decoders[e]},s.prototype.decode=function(e,t,r){return this._getDecoder(t).decode(e,r)},s.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(n[e])),this.encoders[e]},s.prototype.encode=function(e,t,r){return this._getEncoder(t).encode(e,r)}},6443:(e,t,r)=>{"use strict";const n=r(2937),i=r(3399).b,o=r(5446).Buffer;function s(e,t){i.call(this,t),o.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function a(e,t){if(Array.isArray(e))this.length=0,this.value=e.map((function(e){return a.isEncoderBuffer(e)||(e=new a(e,t)),this.length+=e.length,e}),this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=o.byteLength(e);else{if(!o.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}n(s,i),t.C=s,s.isDecoderBuffer=function(e){return e instanceof s||"object"==typeof e&&o.isBuffer(e.base)&&"DecoderBuffer"===e.constructor.name&&"number"==typeof e.offset&&"number"==typeof e.length&&"function"==typeof e.save&&"function"==typeof e.restore&&"function"==typeof e.isEmpty&&"function"==typeof e.readUInt8&&"function"==typeof e.skip&&"function"==typeof e.raw},s.prototype.save=function(){return{offset:this.offset,reporter:i.prototype.save.call(this)}},s.prototype.restore=function(e){const t=new s(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,i.prototype.restore.call(this,e.reporter),t},s.prototype.isEmpty=function(){return this.offset===this.length},s.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},s.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");const r=new s(this.base);return r._reporterState=this._reporterState,r.offset=this.offset,r.length=this.offset+e,this.offset+=e,r},s.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},t.R=a,a.isEncoderBuffer=function(e){return e instanceof a||"object"==typeof e&&"EncoderBuffer"===e.constructor.name&&"number"==typeof e.length&&"function"==typeof e.join},a.prototype.join=function(e,t){return e||(e=o.alloc(this.length)),t||(t=0),0===this.length||(Array.isArray(this.value)?this.value.forEach((function(r){r.join(e,t),t+=r.length})):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):o.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length)),e}},5251:(e,t,r)=>{"use strict";const n=t;n.Reporter=r(3399).b,n.DecoderBuffer=r(6443).C,n.EncoderBuffer=r(6443).R,n.Node=r(9641)},9641:(e,t,r)=>{"use strict";const n=r(3399).b,i=r(6443).R,o=r(6443).C,s=r(6111),a=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(a);function c(e,t,r){const n={};this._baseState=n,n.name=r,n.enc=e,n.parent=t||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n.default=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}e.exports=c;const f=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];c.prototype.clone=function(){const e=this._baseState,t={};f.forEach((function(r){t[r]=e[r]}));const r=new this.constructor(t.parent);return r._baseState=t,r},c.prototype._wrap=function(){const e=this._baseState;u.forEach((function(t){this[t]=function(){const r=new this.constructor(this);return e.children.push(r),r[t].apply(r,arguments)}}),this)},c.prototype._init=function(e){const t=this._baseState;s(null===t.parent),e.call(this),t.children=t.children.filter((function(e){return e._baseState.parent===this}),this),s.equal(t.children.length,1,"Root node can have only one child")},c.prototype._useArgs=function(e){const t=this._baseState,r=e.filter((function(e){return e instanceof this.constructor}),this);e=e.filter((function(e){return!(e instanceof this.constructor)}),this),0!==r.length&&(s(null===t.children),t.children=r,r.forEach((function(e){e._baseState.parent=this}),this)),0!==e.length&&(s(null===t.args),t.args=e,t.reverseArgs=e.map((function(e){if("object"!=typeof e||e.constructor!==Object)return e;const t={};return Object.keys(e).forEach((function(r){r==(0|r)&&(r|=0);const n=e[r];t[n]=r})),t})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(e){c.prototype[e]=function(){const t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}})),a.forEach((function(e){c.prototype[e]=function(){const t=this._baseState,r=Array.prototype.slice.call(arguments);return s(null===t.tag),t.tag=e,this._useArgs(r),this}})),c.prototype.use=function(e){s(e);const t=this._baseState;return s(null===t.use),t.use=e,this},c.prototype.optional=function(){return this._baseState.optional=!0,this},c.prototype.def=function(e){const t=this._baseState;return s(null===t.default),t.default=e,t.optional=!0,this},c.prototype.explicit=function(e){const t=this._baseState;return s(null===t.explicit&&null===t.implicit),t.explicit=e,this},c.prototype.implicit=function(e){const t=this._baseState;return s(null===t.explicit&&null===t.implicit),t.implicit=e,this},c.prototype.obj=function(){const e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},c.prototype.key=function(e){const t=this._baseState;return s(null===t.key),t.key=e,this},c.prototype.any=function(){return this._baseState.any=!0,this},c.prototype.choice=function(e){const t=this._baseState;return s(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map((function(t){return e[t]}))),this},c.prototype.contains=function(e){const t=this._baseState;return s(null===t.use),t.contains=e,this},c.prototype._decode=function(e,t){const r=this._baseState;if(null===r.parent)return e.wrapResult(r.children[0]._decode(e,t));let n,i=r.default,s=!0,a=null;if(null!==r.key&&(a=e.enterKey(r.key)),r.optional){let n=null;if(null!==r.explicit?n=r.explicit:null!==r.implicit?n=r.implicit:null!==r.tag&&(n=r.tag),null!==n||r.any){if(s=this._peekTag(e,n,r.any),e.isError(s))return s}else{const n=e.save();try{null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t),s=!0}catch(e){s=!1}e.restore(n)}}if(r.obj&&s&&(n=e.enterObject()),s){if(null!==r.explicit){const t=this._decodeTag(e,r.explicit);if(e.isError(t))return t;e=t}const n=e.offset;if(null===r.use&&null===r.choice){let t;r.any&&(t=e.save());const n=this._decodeTag(e,null!==r.implicit?r.implicit:r.tag,r.any);if(e.isError(n))return n;r.any?i=e.raw(t):e=n}if(t&&t.track&&null!==r.tag&&t.track(e.path(),n,e.length,"tagged"),t&&t.track&&null!==r.tag&&t.track(e.path(),e.offset,e.length,"content"),r.any||(i=null===r.choice?this._decodeGeneric(r.tag,e,t):this._decodeChoice(e,t)),e.isError(i))return i;if(r.any||null!==r.choice||null===r.children||r.children.forEach((function(r){r._decode(e,t)})),r.contains&&("octstr"===r.tag||"bitstr"===r.tag)){const n=new o(i);i=this._getUse(r.contains,e._reporterState.obj)._decode(n,t)}}return r.obj&&s&&(i=e.leaveObject(n)),null===r.key||null===i&&!0!==s?null!==a&&e.exitKey(a):e.leaveKey(a,r.key,i),i},c.prototype._decodeGeneric=function(e,t,r){const n=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,n.args[0],r):/str$/.test(e)?this._decodeStr(t,e,r):"objid"===e&&n.args?this._decodeObjid(t,n.args[0],n.args[1],r):"objid"===e?this._decodeObjid(t,null,null,r):"gentime"===e||"utctime"===e?this._decodeTime(t,e,r):"null_"===e?this._decodeNull(t,r):"bool"===e?this._decodeBool(t,r):"objDesc"===e?this._decodeStr(t,e,r):"int"===e||"enum"===e?this._decodeInt(t,n.args&&n.args[0],r):null!==n.use?this._getUse(n.use,t._reporterState.obj)._decode(t,r):t.error("unknown tag: "+e)},c.prototype._getUse=function(e,t){const r=this._baseState;return r.useDecoder=this._use(e,t),s(null===r.useDecoder._baseState.parent),r.useDecoder=r.useDecoder._baseState.children[0],r.implicit!==r.useDecoder._baseState.implicit&&(r.useDecoder=r.useDecoder.clone(),r.useDecoder._baseState.implicit=r.implicit),r.useDecoder},c.prototype._decodeChoice=function(e,t){const r=this._baseState;let n=null,i=!1;return Object.keys(r.choice).some((function(o){const s=e.save(),a=r.choice[o];try{const r=a._decode(e,t);if(e.isError(r))return!1;n={type:o,value:r},i=!0}catch(t){return e.restore(s),!1}return!0}),this),i?n:e.error("Choice not matched")},c.prototype._createEncoderBuffer=function(e){return new i(e,this.reporter)},c.prototype._encode=function(e,t,r){const n=this._baseState;if(null!==n.default&&n.default===e)return;const i=this._encodeValue(e,t,r);return void 0===i||this._skipDefault(i,t,r)?void 0:i},c.prototype._encodeValue=function(e,t,r){const i=this._baseState;if(null===i.parent)return i.children[0]._encode(e,t||new n);let o=null;if(this.reporter=t,i.optional&&void 0===e){if(null===i.default)return;e=i.default}let s=null,a=!1;if(i.any)o=this._createEncoderBuffer(e);else if(i.choice)o=this._encodeChoice(e,t);else if(i.contains)s=this._getUse(i.contains,r)._encode(e,t),a=!0;else if(i.children)s=i.children.map((function(r){if("null_"===r._baseState.tag)return r._encode(null,t,e);if(null===r._baseState.key)return t.error("Child should have a key");const n=t.enterKey(r._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");const i=r._encode(e[r._baseState.key],t,e);return t.leaveKey(n),i}),this).filter((function(e){return e})),s=this._createEncoderBuffer(s);else if("seqof"===i.tag||"setof"===i.tag){if(!i.args||1!==i.args.length)return t.error("Too many args for : "+i.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");const r=this.clone();r._baseState.implicit=null,s=this._createEncoderBuffer(e.map((function(r){const n=this._baseState;return this._getUse(n.args[0],e)._encode(r,t)}),r))}else null!==i.use?o=this._getUse(i.use,r)._encode(e,t):(s=this._encodePrimitive(i.tag,e),a=!0);if(!i.any&&null===i.choice){const e=null!==i.implicit?i.implicit:i.tag,r=null===i.implicit?"universal":"context";null===e?null===i.use&&t.error("Tag could be omitted only for .use()"):null===i.use&&(o=this._encodeComposite(e,a,r,s))}return null!==i.explicit&&(o=this._encodeComposite(i.explicit,!1,"context",o)),o},c.prototype._encodeChoice=function(e,t){const r=this._baseState,n=r.choice[e.type];return n||s(!1,e.type+" not found in "+JSON.stringify(Object.keys(r.choice))),n._encode(e.value,t)},c.prototype._encodePrimitive=function(e,t){const r=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&r.args)return this._encodeObjid(t,r.reverseArgs[0],r.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,r.args&&r.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},c.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},c.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(e)}},3399:(e,t,r)=>{"use strict";const n=r(2937);function i(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function o(e,t){this.path=e,this.rethrow(t)}t.b=i,i.prototype.isError=function(e){return e instanceof o},i.prototype.save=function(){const e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},i.prototype.restore=function(e){const t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},i.prototype.enterKey=function(e){return this._reporterState.path.push(e)},i.prototype.exitKey=function(e){const t=this._reporterState;t.path=t.path.slice(0,e-1)},i.prototype.leaveKey=function(e,t,r){const n=this._reporterState;this.exitKey(e),null!==n.obj&&(n.obj[t]=r)},i.prototype.path=function(){return this._reporterState.path.join("/")},i.prototype.enterObject=function(){const e=this._reporterState,t=e.obj;return e.obj={},t},i.prototype.leaveObject=function(e){const t=this._reporterState,r=t.obj;return t.obj=e,r},i.prototype.error=function(e){let t;const r=this._reporterState,n=e instanceof o;if(t=n?e:new o(r.path.map((function(e){return"["+JSON.stringify(e)+"]"})).join(""),e.message||e,e.stack),!r.options.partial)throw t;return n||r.errors.push(t),t},i.prototype.wrapResult=function(e){const t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},n(o,Error),o.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,o),!this.stack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}return this}},1081:(e,t)=>{"use strict";function r(e){const t={};return Object.keys(e).forEach((function(r){(0|r)==r&&(r|=0);const n=e[r];t[n]=r})),t}t.tagClass={0:"universal",1:"application",2:"context",3:"private"},t.tagClassByName=r(t.tagClass),t.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},t.tagByName=r(t.tag)},2599:(e,t,r)=>{"use strict";const n=t;n._reverse=function(e){const t={};return Object.keys(e).forEach((function(r){(0|r)==r&&(r|=0);const n=e[r];t[n]=r})),t},n.der=r(1081)},4688:(e,t,r)=>{"use strict";const n=r(2937),i=r(1172),o=r(6443).C,s=r(9641),a=r(1081);function u(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new c,this.tree._init(e.body)}function c(e){s.call(this,"der",e)}function f(e,t){let r=e.readUInt8(t);if(e.isError(r))return r;const n=a.tagClass[r>>6],i=!(32&r);if(31&~r)r&=31;else{let n=r;for(r=0;!(128&~n);){if(n=e.readUInt8(t),e.isError(n))return n;r<<=7,r|=127&n}}return{cls:n,primitive:i,tag:r,tagStr:a.tag[r]}}function l(e,t,r){let n=e.readUInt8(r);if(e.isError(n))return n;if(!t&&128===n)return null;if(!(128&n))return n;const i=127&n;if(i>4)return e.error("length octect is too long");n=0;for(let t=0;t<i;t++){n<<=8;const t=e.readUInt8(r);if(e.isError(t))return t;n|=t}return n}e.exports=u,u.prototype.decode=function(e,t){return o.isDecoderBuffer(e)||(e=new o(e,t)),this.tree._decode(e,t)},n(c,s),c.prototype._peekTag=function(e,t,r){if(e.isEmpty())return!1;const n=e.save(),i=f(e,'Failed to peek tag: "'+t+'"');return e.isError(i)?i:(e.restore(n),i.tag===t||i.tagStr===t||i.tagStr+"of"===t||r)},c.prototype._decodeTag=function(e,t,r){const n=f(e,'Failed to decode tag of "'+t+'"');if(e.isError(n))return n;let i=l(e,n.primitive,'Failed to get length of "'+t+'"');if(e.isError(i))return i;if(!r&&n.tag!==t&&n.tagStr!==t&&n.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(n.primitive||null!==i)return e.skip(i,'Failed to match body of: "'+t+'"');const o=e.save(),s=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(s)?s:(i=e.offset-o.offset,e.restore(o),e.skip(i,'Failed to match body of: "'+t+'"'))},c.prototype._skipUntilEnd=function(e,t){for(;;){const r=f(e,t);if(e.isError(r))return r;const n=l(e,r.primitive,t);if(e.isError(n))return n;let i;if(i=r.primitive||null!==n?e.skip(n):this._skipUntilEnd(e,t),e.isError(i))return i;if("end"===r.tagStr)break}},c.prototype._decodeList=function(e,t,r,n){const i=[];for(;!e.isEmpty();){const t=this._peekTag(e,"end");if(e.isError(t))return t;const o=r.decode(e,"der",n);if(e.isError(o)&&t)break;i.push(o)}return i},c.prototype._decodeStr=function(e,t){if("bitstr"===t){const t=e.readUInt8();return e.isError(t)?t:{unused:t,data:e.raw()}}if("bmpstr"===t){const t=e.raw();if(t.length%2==1)return e.error("Decoding of string type: bmpstr length mismatch");let r="";for(let e=0;e<t.length/2;e++)r+=String.fromCharCode(t.readUInt16BE(2*e));return r}if("numstr"===t){const t=e.raw().toString("ascii");return this._isNumstr(t)?t:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){const t=e.raw().toString("ascii");return this._isPrintstr(t)?t:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},c.prototype._decodeObjid=function(e,t,r){let n;const i=[];let o=0,s=0;for(;!e.isEmpty();)s=e.readUInt8(),o<<=7,o|=127&s,128&s||(i.push(o),o=0);128&s&&i.push(o);const a=i[0]/40|0,u=i[0]%40;if(n=r?i:[a,u].concat(i.slice(1)),t){let e=t[n.join(" ")];void 0===e&&(e=t[n.join(".")]),void 0!==e&&(n=e)}return n},c.prototype._decodeTime=function(e,t){const r=e.raw().toString();let n,i,o,s,a,u;if("gentime"===t)n=0|r.slice(0,4),i=0|r.slice(4,6),o=0|r.slice(6,8),s=0|r.slice(8,10),a=0|r.slice(10,12),u=0|r.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");n=0|r.slice(0,2),i=0|r.slice(2,4),o=0|r.slice(4,6),s=0|r.slice(6,8),a=0|r.slice(8,10),u=0|r.slice(10,12),n=n<70?2e3+n:1900+n}return Date.UTC(n,i-1,o,s,a,u,0)},c.prototype._decodeNull=function(){return null},c.prototype._decodeBool=function(e){const t=e.readUInt8();return e.isError(t)?t:0!==t},c.prototype._decodeInt=function(e,t){const r=e.raw();let n=new i(r);return t&&(n=t[n.toString(10)]||n),n},c.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getDecoder("der").tree}},8620:(e,t,r)=>{"use strict";const n=t;n.der=r(4688),n.pem=r(594)},594:(e,t,r)=>{"use strict";const n=r(2937),i=r(5446).Buffer,o=r(4688);function s(e){o.call(this,e),this.enc="pem"}n(s,o),e.exports=s,s.prototype.decode=function(e,t){const r=e.toString().split(/[\r\n]+/g),n=t.label.toUpperCase(),s=/^-----(BEGIN|END) ([^-]+)-----$/;let a=-1,u=-1;for(let e=0;e<r.length;e++){const t=r[e].match(s);if(null!==t&&t[2]===n){if(-1!==a){if("END"!==t[1])break;u=e;break}if("BEGIN"!==t[1])break;a=e}}if(-1===a||-1===u)throw new Error("PEM section not found for: "+n);const c=r.slice(a+1,u).join("");c.replace(/[^a-z0-9+/=]+/gi,"");const f=i.from(c,"base64");return o.prototype.decode.call(this,f,t)}},4501:(e,t,r)=>{"use strict";const n=r(2937),i=r(5446).Buffer,o=r(9641),s=r(1081);function a(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new u,this.tree._init(e.body)}function u(e){o.call(this,"der",e)}function c(e){return e<10?"0"+e:e}e.exports=a,a.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},n(u,o),u.prototype._encodeComposite=function(e,t,r,n){const o=function(e,t,r,n){let i;if("seqof"===e?e="seq":"setof"===e&&(e="set"),s.tagByName.hasOwnProperty(e))i=s.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return n.error("Unknown tag: "+e);i=e}return i>=31?n.error("Multi-octet tag encoding unsupported"):(t||(i|=32),i|=s.tagClassByName[r||"universal"]<<6,i)}(e,t,r,this.reporter);if(n.length<128){const e=i.alloc(2);return e[0]=o,e[1]=n.length,this._createEncoderBuffer([e,n])}let a=1;for(let e=n.length;e>=256;e>>=8)a++;const u=i.alloc(2+a);u[0]=o,u[1]=128|a;for(let e=1+a,t=n.length;t>0;e--,t>>=8)u[e]=255&t;return this._createEncoderBuffer([u,n])},u.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){const t=i.alloc(2*e.length);for(let r=0;r<e.length;r++)t.writeUInt16BE(e.charCodeAt(r),2*r);return this._createEncoderBuffer(t)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)||"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},u.prototype._encodeObjid=function(e,t,r){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s.]+/g);for(let t=0;t<e.length;t++)e[t]|=0}else if(Array.isArray(e)){e=e.slice();for(let t=0;t<e.length;t++)e[t]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!r){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}let n=0;for(let t=0;t<e.length;t++){let r=e[t];for(n++;r>=128;r>>=7)n++}const o=i.alloc(n);let s=o.length-1;for(let t=e.length-1;t>=0;t--){let r=e[t];for(o[s--]=127&r;(r>>=7)>0;)o[s--]=128|127&r}return this._createEncoderBuffer(o)},u.prototype._encodeTime=function(e,t){let r;const n=new Date(e);return"gentime"===t?r=[c(n.getUTCFullYear()),c(n.getUTCMonth()+1),c(n.getUTCDate()),c(n.getUTCHours()),c(n.getUTCMinutes()),c(n.getUTCSeconds()),"Z"].join(""):"utctime"===t?r=[c(n.getUTCFullYear()%100),c(n.getUTCMonth()+1),c(n.getUTCDate()),c(n.getUTCHours()),c(n.getUTCMinutes()),c(n.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(r,"octstr")},u.prototype._encodeNull=function(){return this._createEncoderBuffer("")},u.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!=typeof e&&!i.isBuffer(e)){const t=e.toArray();!e.sign&&128&t[0]&&t.unshift(0),e=i.from(t)}if(i.isBuffer(e)){let t=e.length;0===e.length&&t++;const r=i.alloc(t);return e.copy(r),0===e.length&&(r[0]=0),this._createEncoderBuffer(r)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);let r=1;for(let t=e;t>=256;t>>=8)r++;const n=new Array(r);for(let t=n.length-1;t>=0;t--)n[t]=255&e,e>>=8;return 128&n[0]&&n.unshift(0),this._createEncoderBuffer(i.from(n))},u.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},u.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},u.prototype._skipDefault=function(e,t,r){const n=this._baseState;let i;if(null===n.default)return!1;const o=e.join();if(void 0===n.defaultBuffer&&(n.defaultBuffer=this._encodeValue(n.default,t,r).join()),o.length!==n.defaultBuffer.length)return!1;for(i=0;i<o.length;i++)if(o[i]!==n.defaultBuffer[i])return!1;return!0}},8588:(e,t,r)=>{"use strict";const n=t;n.der=r(4501),n.pem=r(5044)},5044:(e,t,r)=>{"use strict";const n=r(2937),i=r(4501);function o(e){i.call(this,e),this.enc="pem"}n(o,i),e.exports=o,o.prototype.encode=function(e,t){const r=i.prototype.encode.call(this,e).toString("base64"),n=["-----BEGIN "+t.label+"-----"];for(let e=0;e<r.length;e+=64)n.push(r.slice(e,e+64));return n.push("-----END "+t.label+"-----"),n.join("\n")}},5415:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,o=a(e),s=o[0],u=o[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,s,u)),f=0,l=u>0?s-4:s;for(r=0;r<l;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[f++]=t>>16&255,c[f++]=t>>8&255,c[f++]=255&t;return 2===u&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[f++]=255&t),1===u&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[f++]=t>>8&255,c[f++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=16383,a=0,c=n-i;a<c;a+=s)o.push(u(e,a,a+s>c?c:a+s));return 1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),o.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=o[s],n[o.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,n){for(var i,o,s=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},1172:function(e,t,r){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function o(e,t,r){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var s;"object"==typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:r(1314).Buffer}catch(e){}function a(e,t){var r=e.charCodeAt(t);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function u(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function c(e,t,r,n){for(var i=0,o=Math.min(e.length,r),s=t;s<o;s++){var a=e.charCodeAt(s)-48;i*=n,i+=a>=49?a-49+10:a>=17?a-17+10:a}return i}o.isBN=function(e){return e instanceof o||null!==e&&"object"==typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},o.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},o.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,s,a=0;if("be"===r)for(i=e.length-1,o=0;i>=0;i-=3)s=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===r)for(i=0,o=0;i<e.length;i+=3)s=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},o.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,o=0,s=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=u(e,t,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=u(e,t,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;this.strip()},o.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var o=e.length-r,s=o%n,a=Math.min(o,o-s)+r,u=0,f=r;f<a;f+=n)u=c(e,f,f+n,t),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==s){var l=1;for(u=c(e,f,e.length,t),f=0;f<s;f++)l*=t;this.imuln(l),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this.strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},o.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function d(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],o=0|t.words[0],s=i*o,a=67108863&s,u=s/67108864|0;r.words[0]=a;for(var c=1;c<n;c++){for(var f=u>>>26,l=67108863&u,h=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=h;d++){var p=c-d|0;f+=(s=(i=0|e.words[p])*(o=0|t.words[d])+l)/67108864|0,l=67108863&s}r.words[c]=0|l,u=0|f}return 0!==u?r.words[c]=0|u:r.length--,r.strip()}o.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,o=0,s=0;s<this.length;s++){var a=this.words[s],u=(16777215&(a<<i|o)).toString(16);r=0!=(o=a>>>24-i&16777215)||s!==this.length-1?f[6-u.length]+u+r:u+r,(i+=2)>=26&&(i-=26,s--)}for(0!==o&&(r=o.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=l[e],d=h[e];r="";var p=this.clone();for(p.negative=0;!p.isZero();){var y=p.modn(d).toString(e);r=(p=p.idivn(d)).isZero()?y+r:f[c-y.length]+y+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16)},o.prototype.toBuffer=function(e,t){return n(void 0!==s),this.toArrayLike(s,e,t)},o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},o.prototype.toArrayLike=function(e,t,r){var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,u="le"===t,c=new e(o),f=this.clone();if(u){for(a=0;!f.isZero();a++)s=f.andln(255),f.iushrn(8),c[a]=s;for(;a<o;a++)c[a]=0}else{for(a=0;a<o-i;a++)c[a]=0;for(a=0;!f.isZero();a++)s=f.andln(255),f.iushrn(8),c[o-a-1]=s}return c},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 8191&t||(r+=13,t>>>=13),127&t||(r+=7,t>>>=7),15&t||(r+=4,t>>>=4),3&t||(r+=2,t>>>=2),1&t||r++,r},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},o.prototype.ior=function(e){return n(!(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this.strip()},o.prototype.iand=function(e){return n(!(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},o.prototype.ixor=function(e){return n(!(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this.strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this.strip()},o.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,o=0;o<n.length;o++)t=(0|r.words[o])+(0|n.words[o])+i,this.words[o]=67108863&t,i=t>>>26;for(;0!==i&&o<r.length;o++)t=(0|r.words[o])+i,this.words[o]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|r.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<r.length;s++)o=(t=(0|r.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<r.length&&r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this.length=Math.max(this.length,s),r!==this&&(this.negative=1),this.strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,r){var n,i,o,s=e.words,a=t.words,u=r.words,c=0,f=0|s[0],l=8191&f,h=f>>>13,d=0|s[1],p=8191&d,y=d>>>13,b=0|s[2],v=8191&b,g=b>>>13,m=0|s[3],w=8191&m,S=m>>>13,A=0|s[4],_=8191&A,M=A>>>13,k=0|s[5],x=8191&k,E=k>>>13,B=0|s[6],O=8191&B,j=B>>>13,I=0|s[7],P=8191&I,C=I>>>13,N=0|s[8],U=8191&N,T=N>>>13,R=0|s[9],D=8191&R,K=R>>>13,L=0|a[0],z=8191&L,H=L>>>13,q=0|a[1],F=8191&q,V=q>>>13,$=0|a[2],J=8191&$,W=$>>>13,G=0|a[3],Z=8191&G,Y=G>>>13,X=0|a[4],Q=8191&X,ee=X>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],oe=8191&ie,se=ie>>>13,ae=0|a[7],ue=8191&ae,ce=ae>>>13,fe=0|a[8],le=8191&fe,he=fe>>>13,de=0|a[9],pe=8191&de,ye=de>>>13;r.negative=e.negative^t.negative,r.length=19;var be=(c+(n=Math.imul(l,z))|0)+((8191&(i=(i=Math.imul(l,H))+Math.imul(h,z)|0))<<13)|0;c=((o=Math.imul(h,H))+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(p,z),i=(i=Math.imul(p,H))+Math.imul(y,z)|0,o=Math.imul(y,H);var ve=(c+(n=n+Math.imul(l,F)|0)|0)+((8191&(i=(i=i+Math.imul(l,V)|0)+Math.imul(h,F)|0))<<13)|0;c=((o=o+Math.imul(h,V)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(v,z),i=(i=Math.imul(v,H))+Math.imul(g,z)|0,o=Math.imul(g,H),n=n+Math.imul(p,F)|0,i=(i=i+Math.imul(p,V)|0)+Math.imul(y,F)|0,o=o+Math.imul(y,V)|0;var ge=(c+(n=n+Math.imul(l,J)|0)|0)+((8191&(i=(i=i+Math.imul(l,W)|0)+Math.imul(h,J)|0))<<13)|0;c=((o=o+Math.imul(h,W)|0)+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(w,z),i=(i=Math.imul(w,H))+Math.imul(S,z)|0,o=Math.imul(S,H),n=n+Math.imul(v,F)|0,i=(i=i+Math.imul(v,V)|0)+Math.imul(g,F)|0,o=o+Math.imul(g,V)|0,n=n+Math.imul(p,J)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(y,J)|0,o=o+Math.imul(y,W)|0;var me=(c+(n=n+Math.imul(l,Z)|0)|0)+((8191&(i=(i=i+Math.imul(l,Y)|0)+Math.imul(h,Z)|0))<<13)|0;c=((o=o+Math.imul(h,Y)|0)+(i>>>13)|0)+(me>>>26)|0,me&=67108863,n=Math.imul(_,z),i=(i=Math.imul(_,H))+Math.imul(M,z)|0,o=Math.imul(M,H),n=n+Math.imul(w,F)|0,i=(i=i+Math.imul(w,V)|0)+Math.imul(S,F)|0,o=o+Math.imul(S,V)|0,n=n+Math.imul(v,J)|0,i=(i=i+Math.imul(v,W)|0)+Math.imul(g,J)|0,o=o+Math.imul(g,W)|0,n=n+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,Y)|0)+Math.imul(y,Z)|0,o=o+Math.imul(y,Y)|0;var we=(c+(n=n+Math.imul(l,Q)|0)|0)+((8191&(i=(i=i+Math.imul(l,ee)|0)+Math.imul(h,Q)|0))<<13)|0;c=((o=o+Math.imul(h,ee)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(x,z),i=(i=Math.imul(x,H))+Math.imul(E,z)|0,o=Math.imul(E,H),n=n+Math.imul(_,F)|0,i=(i=i+Math.imul(_,V)|0)+Math.imul(M,F)|0,o=o+Math.imul(M,V)|0,n=n+Math.imul(w,J)|0,i=(i=i+Math.imul(w,W)|0)+Math.imul(S,J)|0,o=o+Math.imul(S,W)|0,n=n+Math.imul(v,Z)|0,i=(i=i+Math.imul(v,Y)|0)+Math.imul(g,Z)|0,o=o+Math.imul(g,Y)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(y,Q)|0,o=o+Math.imul(y,ee)|0;var Se=(c+(n=n+Math.imul(l,re)|0)|0)+((8191&(i=(i=i+Math.imul(l,ne)|0)+Math.imul(h,re)|0))<<13)|0;c=((o=o+Math.imul(h,ne)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(O,z),i=(i=Math.imul(O,H))+Math.imul(j,z)|0,o=Math.imul(j,H),n=n+Math.imul(x,F)|0,i=(i=i+Math.imul(x,V)|0)+Math.imul(E,F)|0,o=o+Math.imul(E,V)|0,n=n+Math.imul(_,J)|0,i=(i=i+Math.imul(_,W)|0)+Math.imul(M,J)|0,o=o+Math.imul(M,W)|0,n=n+Math.imul(w,Z)|0,i=(i=i+Math.imul(w,Y)|0)+Math.imul(S,Z)|0,o=o+Math.imul(S,Y)|0,n=n+Math.imul(v,Q)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(g,Q)|0,o=o+Math.imul(g,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(y,re)|0,o=o+Math.imul(y,ne)|0;var Ae=(c+(n=n+Math.imul(l,oe)|0)|0)+((8191&(i=(i=i+Math.imul(l,se)|0)+Math.imul(h,oe)|0))<<13)|0;c=((o=o+Math.imul(h,se)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(P,z),i=(i=Math.imul(P,H))+Math.imul(C,z)|0,o=Math.imul(C,H),n=n+Math.imul(O,F)|0,i=(i=i+Math.imul(O,V)|0)+Math.imul(j,F)|0,o=o+Math.imul(j,V)|0,n=n+Math.imul(x,J)|0,i=(i=i+Math.imul(x,W)|0)+Math.imul(E,J)|0,o=o+Math.imul(E,W)|0,n=n+Math.imul(_,Z)|0,i=(i=i+Math.imul(_,Y)|0)+Math.imul(M,Z)|0,o=o+Math.imul(M,Y)|0,n=n+Math.imul(w,Q)|0,i=(i=i+Math.imul(w,ee)|0)+Math.imul(S,Q)|0,o=o+Math.imul(S,ee)|0,n=n+Math.imul(v,re)|0,i=(i=i+Math.imul(v,ne)|0)+Math.imul(g,re)|0,o=o+Math.imul(g,ne)|0,n=n+Math.imul(p,oe)|0,i=(i=i+Math.imul(p,se)|0)+Math.imul(y,oe)|0,o=o+Math.imul(y,se)|0;var _e=(c+(n=n+Math.imul(l,ue)|0)|0)+((8191&(i=(i=i+Math.imul(l,ce)|0)+Math.imul(h,ue)|0))<<13)|0;c=((o=o+Math.imul(h,ce)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(U,z),i=(i=Math.imul(U,H))+Math.imul(T,z)|0,o=Math.imul(T,H),n=n+Math.imul(P,F)|0,i=(i=i+Math.imul(P,V)|0)+Math.imul(C,F)|0,o=o+Math.imul(C,V)|0,n=n+Math.imul(O,J)|0,i=(i=i+Math.imul(O,W)|0)+Math.imul(j,J)|0,o=o+Math.imul(j,W)|0,n=n+Math.imul(x,Z)|0,i=(i=i+Math.imul(x,Y)|0)+Math.imul(E,Z)|0,o=o+Math.imul(E,Y)|0,n=n+Math.imul(_,Q)|0,i=(i=i+Math.imul(_,ee)|0)+Math.imul(M,Q)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(w,re)|0,i=(i=i+Math.imul(w,ne)|0)+Math.imul(S,re)|0,o=o+Math.imul(S,ne)|0,n=n+Math.imul(v,oe)|0,i=(i=i+Math.imul(v,se)|0)+Math.imul(g,oe)|0,o=o+Math.imul(g,se)|0,n=n+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(y,ue)|0,o=o+Math.imul(y,ce)|0;var Me=(c+(n=n+Math.imul(l,le)|0)|0)+((8191&(i=(i=i+Math.imul(l,he)|0)+Math.imul(h,le)|0))<<13)|0;c=((o=o+Math.imul(h,he)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(D,z),i=(i=Math.imul(D,H))+Math.imul(K,z)|0,o=Math.imul(K,H),n=n+Math.imul(U,F)|0,i=(i=i+Math.imul(U,V)|0)+Math.imul(T,F)|0,o=o+Math.imul(T,V)|0,n=n+Math.imul(P,J)|0,i=(i=i+Math.imul(P,W)|0)+Math.imul(C,J)|0,o=o+Math.imul(C,W)|0,n=n+Math.imul(O,Z)|0,i=(i=i+Math.imul(O,Y)|0)+Math.imul(j,Z)|0,o=o+Math.imul(j,Y)|0,n=n+Math.imul(x,Q)|0,i=(i=i+Math.imul(x,ee)|0)+Math.imul(E,Q)|0,o=o+Math.imul(E,ee)|0,n=n+Math.imul(_,re)|0,i=(i=i+Math.imul(_,ne)|0)+Math.imul(M,re)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(w,oe)|0,i=(i=i+Math.imul(w,se)|0)+Math.imul(S,oe)|0,o=o+Math.imul(S,se)|0,n=n+Math.imul(v,ue)|0,i=(i=i+Math.imul(v,ce)|0)+Math.imul(g,ue)|0,o=o+Math.imul(g,ce)|0,n=n+Math.imul(p,le)|0,i=(i=i+Math.imul(p,he)|0)+Math.imul(y,le)|0,o=o+Math.imul(y,he)|0;var ke=(c+(n=n+Math.imul(l,pe)|0)|0)+((8191&(i=(i=i+Math.imul(l,ye)|0)+Math.imul(h,pe)|0))<<13)|0;c=((o=o+Math.imul(h,ye)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(D,F),i=(i=Math.imul(D,V))+Math.imul(K,F)|0,o=Math.imul(K,V),n=n+Math.imul(U,J)|0,i=(i=i+Math.imul(U,W)|0)+Math.imul(T,J)|0,o=o+Math.imul(T,W)|0,n=n+Math.imul(P,Z)|0,i=(i=i+Math.imul(P,Y)|0)+Math.imul(C,Z)|0,o=o+Math.imul(C,Y)|0,n=n+Math.imul(O,Q)|0,i=(i=i+Math.imul(O,ee)|0)+Math.imul(j,Q)|0,o=o+Math.imul(j,ee)|0,n=n+Math.imul(x,re)|0,i=(i=i+Math.imul(x,ne)|0)+Math.imul(E,re)|0,o=o+Math.imul(E,ne)|0,n=n+Math.imul(_,oe)|0,i=(i=i+Math.imul(_,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(w,ue)|0,i=(i=i+Math.imul(w,ce)|0)+Math.imul(S,ue)|0,o=o+Math.imul(S,ce)|0,n=n+Math.imul(v,le)|0,i=(i=i+Math.imul(v,he)|0)+Math.imul(g,le)|0,o=o+Math.imul(g,he)|0;var xe=(c+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,ye)|0)+Math.imul(y,pe)|0))<<13)|0;c=((o=o+Math.imul(y,ye)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(D,J),i=(i=Math.imul(D,W))+Math.imul(K,J)|0,o=Math.imul(K,W),n=n+Math.imul(U,Z)|0,i=(i=i+Math.imul(U,Y)|0)+Math.imul(T,Z)|0,o=o+Math.imul(T,Y)|0,n=n+Math.imul(P,Q)|0,i=(i=i+Math.imul(P,ee)|0)+Math.imul(C,Q)|0,o=o+Math.imul(C,ee)|0,n=n+Math.imul(O,re)|0,i=(i=i+Math.imul(O,ne)|0)+Math.imul(j,re)|0,o=o+Math.imul(j,ne)|0,n=n+Math.imul(x,oe)|0,i=(i=i+Math.imul(x,se)|0)+Math.imul(E,oe)|0,o=o+Math.imul(E,se)|0,n=n+Math.imul(_,ue)|0,i=(i=i+Math.imul(_,ce)|0)+Math.imul(M,ue)|0,o=o+Math.imul(M,ce)|0,n=n+Math.imul(w,le)|0,i=(i=i+Math.imul(w,he)|0)+Math.imul(S,le)|0,o=o+Math.imul(S,he)|0;var Ee=(c+(n=n+Math.imul(v,pe)|0)|0)+((8191&(i=(i=i+Math.imul(v,ye)|0)+Math.imul(g,pe)|0))<<13)|0;c=((o=o+Math.imul(g,ye)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(D,Z),i=(i=Math.imul(D,Y))+Math.imul(K,Z)|0,o=Math.imul(K,Y),n=n+Math.imul(U,Q)|0,i=(i=i+Math.imul(U,ee)|0)+Math.imul(T,Q)|0,o=o+Math.imul(T,ee)|0,n=n+Math.imul(P,re)|0,i=(i=i+Math.imul(P,ne)|0)+Math.imul(C,re)|0,o=o+Math.imul(C,ne)|0,n=n+Math.imul(O,oe)|0,i=(i=i+Math.imul(O,se)|0)+Math.imul(j,oe)|0,o=o+Math.imul(j,se)|0,n=n+Math.imul(x,ue)|0,i=(i=i+Math.imul(x,ce)|0)+Math.imul(E,ue)|0,o=o+Math.imul(E,ce)|0,n=n+Math.imul(_,le)|0,i=(i=i+Math.imul(_,he)|0)+Math.imul(M,le)|0,o=o+Math.imul(M,he)|0;var Be=(c+(n=n+Math.imul(w,pe)|0)|0)+((8191&(i=(i=i+Math.imul(w,ye)|0)+Math.imul(S,pe)|0))<<13)|0;c=((o=o+Math.imul(S,ye)|0)+(i>>>13)|0)+(Be>>>26)|0,Be&=67108863,n=Math.imul(D,Q),i=(i=Math.imul(D,ee))+Math.imul(K,Q)|0,o=Math.imul(K,ee),n=n+Math.imul(U,re)|0,i=(i=i+Math.imul(U,ne)|0)+Math.imul(T,re)|0,o=o+Math.imul(T,ne)|0,n=n+Math.imul(P,oe)|0,i=(i=i+Math.imul(P,se)|0)+Math.imul(C,oe)|0,o=o+Math.imul(C,se)|0,n=n+Math.imul(O,ue)|0,i=(i=i+Math.imul(O,ce)|0)+Math.imul(j,ue)|0,o=o+Math.imul(j,ce)|0,n=n+Math.imul(x,le)|0,i=(i=i+Math.imul(x,he)|0)+Math.imul(E,le)|0,o=o+Math.imul(E,he)|0;var Oe=(c+(n=n+Math.imul(_,pe)|0)|0)+((8191&(i=(i=i+Math.imul(_,ye)|0)+Math.imul(M,pe)|0))<<13)|0;c=((o=o+Math.imul(M,ye)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(D,re),i=(i=Math.imul(D,ne))+Math.imul(K,re)|0,o=Math.imul(K,ne),n=n+Math.imul(U,oe)|0,i=(i=i+Math.imul(U,se)|0)+Math.imul(T,oe)|0,o=o+Math.imul(T,se)|0,n=n+Math.imul(P,ue)|0,i=(i=i+Math.imul(P,ce)|0)+Math.imul(C,ue)|0,o=o+Math.imul(C,ce)|0,n=n+Math.imul(O,le)|0,i=(i=i+Math.imul(O,he)|0)+Math.imul(j,le)|0,o=o+Math.imul(j,he)|0;var je=(c+(n=n+Math.imul(x,pe)|0)|0)+((8191&(i=(i=i+Math.imul(x,ye)|0)+Math.imul(E,pe)|0))<<13)|0;c=((o=o+Math.imul(E,ye)|0)+(i>>>13)|0)+(je>>>26)|0,je&=67108863,n=Math.imul(D,oe),i=(i=Math.imul(D,se))+Math.imul(K,oe)|0,o=Math.imul(K,se),n=n+Math.imul(U,ue)|0,i=(i=i+Math.imul(U,ce)|0)+Math.imul(T,ue)|0,o=o+Math.imul(T,ce)|0,n=n+Math.imul(P,le)|0,i=(i=i+Math.imul(P,he)|0)+Math.imul(C,le)|0,o=o+Math.imul(C,he)|0;var Ie=(c+(n=n+Math.imul(O,pe)|0)|0)+((8191&(i=(i=i+Math.imul(O,ye)|0)+Math.imul(j,pe)|0))<<13)|0;c=((o=o+Math.imul(j,ye)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(D,ue),i=(i=Math.imul(D,ce))+Math.imul(K,ue)|0,o=Math.imul(K,ce),n=n+Math.imul(U,le)|0,i=(i=i+Math.imul(U,he)|0)+Math.imul(T,le)|0,o=o+Math.imul(T,he)|0;var Pe=(c+(n=n+Math.imul(P,pe)|0)|0)+((8191&(i=(i=i+Math.imul(P,ye)|0)+Math.imul(C,pe)|0))<<13)|0;c=((o=o+Math.imul(C,ye)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(D,le),i=(i=Math.imul(D,he))+Math.imul(K,le)|0,o=Math.imul(K,he);var Ce=(c+(n=n+Math.imul(U,pe)|0)|0)+((8191&(i=(i=i+Math.imul(U,ye)|0)+Math.imul(T,pe)|0))<<13)|0;c=((o=o+Math.imul(T,ye)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863;var Ne=(c+(n=Math.imul(D,pe))|0)+((8191&(i=(i=Math.imul(D,ye))+Math.imul(K,pe)|0))<<13)|0;return c=((o=Math.imul(K,ye))+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,u[0]=be,u[1]=ve,u[2]=ge,u[3]=me,u[4]=we,u[5]=Se,u[6]=Ae,u[7]=_e,u[8]=Me,u[9]=ke,u[10]=xe,u[11]=Ee,u[12]=Be,u[13]=Oe,u[14]=je,u[15]=Ie,u[16]=Pe,u[17]=Ce,u[18]=Ne,0!==c&&(u[19]=c,r.length++),r};function y(e,t,r){return(new b).mulp(e,t,r)}function b(e,t){this.x=e,this.y=t}Math.imul||(p=d),o.prototype.mulTo=function(e,t){var r,n=this.length+e.length;return r=10===this.length&&10===e.length?p(this,e,t):n<63?d(this,e,t):n<1024?function(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,o=0;o<r.length-1;o++){var s=i;i=0;for(var a=67108863&n,u=Math.min(o,t.length-1),c=Math.max(0,o-e.length+1);c<=u;c++){var f=o-c,l=(0|e.words[f])*(0|t.words[c]),h=67108863&l;a=67108863&(h=h+a|0),i+=(s=(s=s+(l/67108864|0)|0)+(h>>>26)|0)>>>26,s&=67108863}r.words[o]=a,n=s,s=i}return 0!==n?r.words[o]=n:r.length--,r.strip()}(this,e,t):y(this,e,t),r},b.prototype.makeRBT=function(e){for(var t=new Array(e),r=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},b.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},b.prototype.permute=function(e,t,r,n,i,o){for(var s=0;s<o;s++)n[s]=t[e[s]],i[s]=r[e[s]]},b.prototype.transform=function(e,t,r,n,i,o){this.permute(o,e,t,r,n,i);for(var s=1;s<i;s<<=1)for(var a=s<<1,u=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),f=0;f<i;f+=a)for(var l=u,h=c,d=0;d<s;d++){var p=r[f+d],y=n[f+d],b=r[f+d+s],v=n[f+d+s],g=l*b-h*v;v=l*v+h*b,b=g,r[f+d]=p+b,n[f+d]=y+v,r[f+d+s]=p-b,n[f+d+s]=y-v,d!==a&&(g=u*l-c*h,h=u*h+c*l,l=g)}},b.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},b.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},b.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},b.prototype.convert13b=function(e,t,r,i){for(var o=0,s=0;s<t;s++)o+=0|e[s],r[2*s]=8191&o,o>>>=13,r[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<i;++s)r[s]=0;n(0===o),n(!(-8192&o))},b.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},b.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),u=new Array(n),c=new Array(n),f=new Array(n),l=new Array(n),h=r.words;h.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,c,n),this.transform(s,o,a,u,n,i),this.transform(c,o,f,l,n,i);for(var d=0;d<n;d++){var p=a[d]*f[d]-u[d]*l[d];u[d]=a[d]*l[d]+u[d]*f[d],a[d]=p}return this.conjugate(a,u,n),this.transform(a,u,h,o,n,i),this.conjugate(h,o,n),this.normalize13b(h,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r.strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),y(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){n("number"==typeof e),n(e<67108864);for(var t=0,r=0;r<this.length;r++){var i=(0|this.words[r])*e,o=(67108863&i)+(67108863&t);t>>=26,t+=i/67108864|0,t+=o>>>26,this.words[r]=67108863&o}return 0!==t&&(this.words[r]=t,this.length++),this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=(e.words[n]&1<<i)>>>i}return t}(e);if(0===t.length)return new o(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},o.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,u=(0|this.words[t])-a<<r;this.words[t]=u|s,s=a>>>26-r}s&&(this.words[t]=s,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this.strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,u=r;if(i-=s,i=Math.max(0,i),u){for(var c=0;c<s;c++)u.words[c]=this.words[c];u.length=s}if(0===s);else if(this.length>s)for(this.length-=s,c=0;c<this.length;c++)this.words[c]=this.words[c+s];else this.words[0]=0,this.length=1;var f=0;for(c=this.length-1;c>=0&&(0!==f||c>=i);c--){var l=0|this.words[c];this.words[c]=f<<26-o|l>>>o,f=l&a}return u&&0!==f&&(u.words[u.length++]=f),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},o.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r||!(this.words[r]&i))},o.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this.strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,r){var i,o,s=e.length+r;this._expand(s);var a=0;for(i=0;i<e.length;i++){o=(0|this.words[i+r])+a;var u=(0|e.words[i])*t;a=((o-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)a=(o=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(o=-(0|this.words[i])+a)>>26,this.words[i]=67108863&o;return this.negative=1,this.strip()},o.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,s=0|i.words[i.length-1];0!=(r=26-this._countBits(s))&&(i=i.ushln(r),n.iushln(r),s=0|i.words[i.length-1]);var a,u=n.length-i.length;if("mod"!==t){(a=new o(null)).length=u+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var f=n.clone()._ishlnsubmul(i,1,u);0===f.negative&&(n=f,a&&(a.words[u]=1));for(var l=u-1;l>=0;l--){var h=67108864*(0|n.words[i.length+l])+(0|n.words[i.length+l-1]);for(h=Math.min(h/s|0,67108863),n._ishlnsubmul(i,h,l);0!==n.negative;)h--,n.negative=0,n._ishlnsubmul(i,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=h)}return a&&a.strip(),n.strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.iadd(e)),{div:i,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):this.negative&e.negative?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modn(e.words[0]))}:this._wordDiv(e,t);var i,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),o=r.cmp(n);return o<0||1===i&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,r=0,i=this.length-1;i>=0;i--)r=(t*r+(0|this.words[i]))%e;return r},o.prototype.idivn=function(e){n(e<=67108863);for(var t=0,r=this.length-1;r>=0;r--){var i=(0|this.words[r])+67108864*t;this.words[r]=i/e|0,t=i%e}return this.strip()},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new o(1),s=new o(0),a=new o(0),u=new o(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var f=r.clone(),l=t.clone();!t.isZero();){for(var h=0,d=1;!(t.words[0]&d)&&h<26;++h,d<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(i.isOdd()||s.isOdd())&&(i.iadd(f),s.isub(l)),i.iushrn(1),s.iushrn(1);for(var p=0,y=1;!(r.words[0]&y)&&p<26;++p,y<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||u.isOdd())&&(a.iadd(f),u.isub(l)),a.iushrn(1),u.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),s.isub(u)):(r.isub(t),a.isub(i),u.isub(s))}return{a,b:u,gcd:r.iushln(c)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,s=new o(1),a=new o(0),u=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,f=1;!(t.words[0]&f)&&c<26;++c,f<<=1);if(c>0)for(t.iushrn(c);c-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);for(var l=0,h=1;!(r.words[0]&h)&&l<26;++l,h<<=1);if(l>0)for(r.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),s.isub(a)):(r.isub(t),a.isub(s))}return(i=0===t.cmpn(1)?s:a).cmpn(0)<0&&i.iadd(e),i},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var o=t;t=r,r=o}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return!(1&this.words[0])},o.prototype.isOdd=function(){return!(1&~this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,s=r;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new _(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var v={k256:null,p224:null,p192:null,p25519:null};function g(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function m(){g.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function w(){g.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function S(){g.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function A(){g.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function _(e){if("string"==typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function M(e){_.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}g.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},g.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},g.prototype.split=function(e,t){e.iushrn(this.n,0,t)},g.prototype.imulK=function(e){return e.imul(this.k)},i(m,g),m.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&r,i=10;i<e.length;i++){var s=0|e.words[i];e.words[i-10]=(s&r)<<4|o>>>22,o=s}o>>>=22,e.words[i-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},m.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(w,g),i(S,g),i(A,g),A.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(v[e])return v[e];var t;if("k256"===e)t=new m;else if("p224"===e)t=new w;else if("p192"===e)t=new S;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new A}return v[e]=t,t},_.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},_.prototype._verify2=function(e,t){n(!(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},_.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},_.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},_.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},_.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},_.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},_.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},_.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},_.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},_.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},_.prototype.isqr=function(e){return this.imul(e,e.clone())},_.prototype.sqr=function(e){return this.mul(e,e)},_.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new o(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),s=0;!i.isZero()&&0===i.andln(1);)s++,i.iushrn(1);n(!i.isZero());var a=new o(1).toRed(this),u=a.redNeg(),c=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new o(2*f*f).toRed(this);0!==this.pow(f,c).cmp(u);)f.redIAdd(u);for(var l=this.pow(f,i),h=this.pow(e,i.addn(1).iushrn(1)),d=this.pow(e,i),p=s;0!==d.cmp(a);){for(var y=d,b=0;0!==y.cmp(a);b++)y=y.redSqr();n(b<p);var v=this.pow(l,new o(1).iushln(p-b-1));h=h.redMul(v),l=v.redSqr(),d=d.redMul(l),p=b}return h},_.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},_.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new o(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],s=0,a=0,u=t.bitLength()%26;for(0===u&&(u=26),n=t.length-1;n>=0;n--){for(var c=t.words[n],f=u-1;f>=0;f--){var l=c>>f&1;i!==r[0]&&(i=this.sqr(i)),0!==l||0!==s?(s<<=1,s|=l,(4==++a||0===n&&0===f)&&(i=this.mul(i,r[s]),a=0,s=0)):a=0}u=26}return i},_.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},_.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new M(e)},i(M,_),M.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},M.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},M.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},M.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},M.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=r.nmd(e),this)},9098:function(e,t,r){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function o(e,t,r){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var s;"object"==typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:r(9391).Buffer}catch(e){}function a(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+e)}function u(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function c(e,t,r,i){for(var o=0,s=0,a=Math.min(e.length,r),u=t;u<a;u++){var c=e.charCodeAt(u)-48;o*=i,s=c>=49?c-49+10:c>=17?c-17+10:c,n(c>=0&&s<i,"Invalid character"),o+=s}return o}function f(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(o.isBN=function(e){return e instanceof o||null!==e&&"object"==typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},o.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},o.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,s,a=0;if("be"===r)for(i=e.length-1,o=0;i>=0;i-=3)s=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===r)for(i=0,o=0;i<e.length;i+=3)s=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this._strip()},o.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,o=0,s=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=u(e,t,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=u(e,t,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;this._strip()},o.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var o=e.length-r,s=o%n,a=Math.min(o,o-s)+r,u=0,f=r;f<a;f+=n)u=c(e,f,f+n,t),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==s){var l=1;for(u=c(e,f,e.length,t),f=0;f<s;f++)l*=t;this.imuln(l),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this._strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype._move=function(e){f(e,this)},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{o.prototype[Symbol.for("nodejs.util.inspect.custom")]=l}catch(e){o.prototype.inspect=l}else o.prototype.inspect=l;function l(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function y(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],o=0|t.words[0],s=i*o,a=67108863&s,u=s/67108864|0;r.words[0]=a;for(var c=1;c<n;c++){for(var f=u>>>26,l=67108863&u,h=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=h;d++){var p=c-d|0;f+=(s=(i=0|e.words[p])*(o=0|t.words[d])+l)/67108864|0,l=67108863&s}r.words[c]=0|l,u=0|f}return 0!==u?r.words[c]=0|u:r.length--,r._strip()}o.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,o=0,s=0;s<this.length;s++){var a=this.words[s],u=(16777215&(a<<i|o)).toString(16);o=a>>>24-i&16777215,(i+=2)>=26&&(i-=26,s--),r=0!==o||s!==this.length-1?h[6-u.length]+u+r:u+r}for(0!==o&&(r=o.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=d[e],f=p[e];r="";var l=this.clone();for(l.negative=0;!l.isZero();){var y=l.modrn(f).toString(e);r=(l=l.idivn(f)).isZero()?y+r:h[c-y.length]+y+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16,2)},s&&(o.prototype.toBuffer=function(e,t){return this.toArrayLike(s,e,t)}),o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},o.prototype.toArrayLike=function(e,t,r){this._strip();var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0");var s=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,o);return this["_toArrayLike"+("le"===t?"LE":"BE")](s,i),s},o.prototype._toArrayLikeLE=function(e,t){for(var r=0,n=0,i=0,o=0;i<this.length;i++){var s=this.words[i]<<o|n;e[r++]=255&s,r<e.length&&(e[r++]=s>>8&255),r<e.length&&(e[r++]=s>>16&255),6===o?(r<e.length&&(e[r++]=s>>24&255),n=0,o=0):(n=s>>>24,o+=2)}if(r<e.length)for(e[r++]=n;r<e.length;)e[r++]=0},o.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,n=0,i=0,o=0;i<this.length;i++){var s=this.words[i]<<o|n;e[r--]=255&s,r>=0&&(e[r--]=s>>8&255),r>=0&&(e[r--]=s>>16&255),6===o?(r>=0&&(e[r--]=s>>24&255),n=0,o=0):(n=s>>>24,o+=2)}if(r>=0)for(e[r--]=n;r>=0;)e[r--]=0},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 8191&t||(r+=13,t>>>=13),127&t||(r+=7,t>>>=7),15&t||(r+=4,t>>>=4),3&t||(r+=2,t>>>=2),1&t||r++,r},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},o.prototype.ior=function(e){return n(!(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},o.prototype.iand=function(e){return n(!(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},o.prototype.ixor=function(e){return n(!(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},o.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,o=0;o<n.length;o++)t=(0|r.words[o])+(0|n.words[o])+i,this.words[o]=67108863&t,i=t>>>26;for(;0!==i&&o<r.length;o++)t=(0|r.words[o])+i,this.words[o]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|r.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<r.length;s++)o=(t=(0|r.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<r.length&&r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this.length=Math.max(this.length,s),r!==this&&(this.negative=1),this._strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var b=function(e,t,r){var n,i,o,s=e.words,a=t.words,u=r.words,c=0,f=0|s[0],l=8191&f,h=f>>>13,d=0|s[1],p=8191&d,y=d>>>13,b=0|s[2],v=8191&b,g=b>>>13,m=0|s[3],w=8191&m,S=m>>>13,A=0|s[4],_=8191&A,M=A>>>13,k=0|s[5],x=8191&k,E=k>>>13,B=0|s[6],O=8191&B,j=B>>>13,I=0|s[7],P=8191&I,C=I>>>13,N=0|s[8],U=8191&N,T=N>>>13,R=0|s[9],D=8191&R,K=R>>>13,L=0|a[0],z=8191&L,H=L>>>13,q=0|a[1],F=8191&q,V=q>>>13,$=0|a[2],J=8191&$,W=$>>>13,G=0|a[3],Z=8191&G,Y=G>>>13,X=0|a[4],Q=8191&X,ee=X>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],oe=8191&ie,se=ie>>>13,ae=0|a[7],ue=8191&ae,ce=ae>>>13,fe=0|a[8],le=8191&fe,he=fe>>>13,de=0|a[9],pe=8191&de,ye=de>>>13;r.negative=e.negative^t.negative,r.length=19;var be=(c+(n=Math.imul(l,z))|0)+((8191&(i=(i=Math.imul(l,H))+Math.imul(h,z)|0))<<13)|0;c=((o=Math.imul(h,H))+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(p,z),i=(i=Math.imul(p,H))+Math.imul(y,z)|0,o=Math.imul(y,H);var ve=(c+(n=n+Math.imul(l,F)|0)|0)+((8191&(i=(i=i+Math.imul(l,V)|0)+Math.imul(h,F)|0))<<13)|0;c=((o=o+Math.imul(h,V)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(v,z),i=(i=Math.imul(v,H))+Math.imul(g,z)|0,o=Math.imul(g,H),n=n+Math.imul(p,F)|0,i=(i=i+Math.imul(p,V)|0)+Math.imul(y,F)|0,o=o+Math.imul(y,V)|0;var ge=(c+(n=n+Math.imul(l,J)|0)|0)+((8191&(i=(i=i+Math.imul(l,W)|0)+Math.imul(h,J)|0))<<13)|0;c=((o=o+Math.imul(h,W)|0)+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(w,z),i=(i=Math.imul(w,H))+Math.imul(S,z)|0,o=Math.imul(S,H),n=n+Math.imul(v,F)|0,i=(i=i+Math.imul(v,V)|0)+Math.imul(g,F)|0,o=o+Math.imul(g,V)|0,n=n+Math.imul(p,J)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(y,J)|0,o=o+Math.imul(y,W)|0;var me=(c+(n=n+Math.imul(l,Z)|0)|0)+((8191&(i=(i=i+Math.imul(l,Y)|0)+Math.imul(h,Z)|0))<<13)|0;c=((o=o+Math.imul(h,Y)|0)+(i>>>13)|0)+(me>>>26)|0,me&=67108863,n=Math.imul(_,z),i=(i=Math.imul(_,H))+Math.imul(M,z)|0,o=Math.imul(M,H),n=n+Math.imul(w,F)|0,i=(i=i+Math.imul(w,V)|0)+Math.imul(S,F)|0,o=o+Math.imul(S,V)|0,n=n+Math.imul(v,J)|0,i=(i=i+Math.imul(v,W)|0)+Math.imul(g,J)|0,o=o+Math.imul(g,W)|0,n=n+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,Y)|0)+Math.imul(y,Z)|0,o=o+Math.imul(y,Y)|0;var we=(c+(n=n+Math.imul(l,Q)|0)|0)+((8191&(i=(i=i+Math.imul(l,ee)|0)+Math.imul(h,Q)|0))<<13)|0;c=((o=o+Math.imul(h,ee)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(x,z),i=(i=Math.imul(x,H))+Math.imul(E,z)|0,o=Math.imul(E,H),n=n+Math.imul(_,F)|0,i=(i=i+Math.imul(_,V)|0)+Math.imul(M,F)|0,o=o+Math.imul(M,V)|0,n=n+Math.imul(w,J)|0,i=(i=i+Math.imul(w,W)|0)+Math.imul(S,J)|0,o=o+Math.imul(S,W)|0,n=n+Math.imul(v,Z)|0,i=(i=i+Math.imul(v,Y)|0)+Math.imul(g,Z)|0,o=o+Math.imul(g,Y)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(y,Q)|0,o=o+Math.imul(y,ee)|0;var Se=(c+(n=n+Math.imul(l,re)|0)|0)+((8191&(i=(i=i+Math.imul(l,ne)|0)+Math.imul(h,re)|0))<<13)|0;c=((o=o+Math.imul(h,ne)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(O,z),i=(i=Math.imul(O,H))+Math.imul(j,z)|0,o=Math.imul(j,H),n=n+Math.imul(x,F)|0,i=(i=i+Math.imul(x,V)|0)+Math.imul(E,F)|0,o=o+Math.imul(E,V)|0,n=n+Math.imul(_,J)|0,i=(i=i+Math.imul(_,W)|0)+Math.imul(M,J)|0,o=o+Math.imul(M,W)|0,n=n+Math.imul(w,Z)|0,i=(i=i+Math.imul(w,Y)|0)+Math.imul(S,Z)|0,o=o+Math.imul(S,Y)|0,n=n+Math.imul(v,Q)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(g,Q)|0,o=o+Math.imul(g,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(y,re)|0,o=o+Math.imul(y,ne)|0;var Ae=(c+(n=n+Math.imul(l,oe)|0)|0)+((8191&(i=(i=i+Math.imul(l,se)|0)+Math.imul(h,oe)|0))<<13)|0;c=((o=o+Math.imul(h,se)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(P,z),i=(i=Math.imul(P,H))+Math.imul(C,z)|0,o=Math.imul(C,H),n=n+Math.imul(O,F)|0,i=(i=i+Math.imul(O,V)|0)+Math.imul(j,F)|0,o=o+Math.imul(j,V)|0,n=n+Math.imul(x,J)|0,i=(i=i+Math.imul(x,W)|0)+Math.imul(E,J)|0,o=o+Math.imul(E,W)|0,n=n+Math.imul(_,Z)|0,i=(i=i+Math.imul(_,Y)|0)+Math.imul(M,Z)|0,o=o+Math.imul(M,Y)|0,n=n+Math.imul(w,Q)|0,i=(i=i+Math.imul(w,ee)|0)+Math.imul(S,Q)|0,o=o+Math.imul(S,ee)|0,n=n+Math.imul(v,re)|0,i=(i=i+Math.imul(v,ne)|0)+Math.imul(g,re)|0,o=o+Math.imul(g,ne)|0,n=n+Math.imul(p,oe)|0,i=(i=i+Math.imul(p,se)|0)+Math.imul(y,oe)|0,o=o+Math.imul(y,se)|0;var _e=(c+(n=n+Math.imul(l,ue)|0)|0)+((8191&(i=(i=i+Math.imul(l,ce)|0)+Math.imul(h,ue)|0))<<13)|0;c=((o=o+Math.imul(h,ce)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(U,z),i=(i=Math.imul(U,H))+Math.imul(T,z)|0,o=Math.imul(T,H),n=n+Math.imul(P,F)|0,i=(i=i+Math.imul(P,V)|0)+Math.imul(C,F)|0,o=o+Math.imul(C,V)|0,n=n+Math.imul(O,J)|0,i=(i=i+Math.imul(O,W)|0)+Math.imul(j,J)|0,o=o+Math.imul(j,W)|0,n=n+Math.imul(x,Z)|0,i=(i=i+Math.imul(x,Y)|0)+Math.imul(E,Z)|0,o=o+Math.imul(E,Y)|0,n=n+Math.imul(_,Q)|0,i=(i=i+Math.imul(_,ee)|0)+Math.imul(M,Q)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(w,re)|0,i=(i=i+Math.imul(w,ne)|0)+Math.imul(S,re)|0,o=o+Math.imul(S,ne)|0,n=n+Math.imul(v,oe)|0,i=(i=i+Math.imul(v,se)|0)+Math.imul(g,oe)|0,o=o+Math.imul(g,se)|0,n=n+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(y,ue)|0,o=o+Math.imul(y,ce)|0;var Me=(c+(n=n+Math.imul(l,le)|0)|0)+((8191&(i=(i=i+Math.imul(l,he)|0)+Math.imul(h,le)|0))<<13)|0;c=((o=o+Math.imul(h,he)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(D,z),i=(i=Math.imul(D,H))+Math.imul(K,z)|0,o=Math.imul(K,H),n=n+Math.imul(U,F)|0,i=(i=i+Math.imul(U,V)|0)+Math.imul(T,F)|0,o=o+Math.imul(T,V)|0,n=n+Math.imul(P,J)|0,i=(i=i+Math.imul(P,W)|0)+Math.imul(C,J)|0,o=o+Math.imul(C,W)|0,n=n+Math.imul(O,Z)|0,i=(i=i+Math.imul(O,Y)|0)+Math.imul(j,Z)|0,o=o+Math.imul(j,Y)|0,n=n+Math.imul(x,Q)|0,i=(i=i+Math.imul(x,ee)|0)+Math.imul(E,Q)|0,o=o+Math.imul(E,ee)|0,n=n+Math.imul(_,re)|0,i=(i=i+Math.imul(_,ne)|0)+Math.imul(M,re)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(w,oe)|0,i=(i=i+Math.imul(w,se)|0)+Math.imul(S,oe)|0,o=o+Math.imul(S,se)|0,n=n+Math.imul(v,ue)|0,i=(i=i+Math.imul(v,ce)|0)+Math.imul(g,ue)|0,o=o+Math.imul(g,ce)|0,n=n+Math.imul(p,le)|0,i=(i=i+Math.imul(p,he)|0)+Math.imul(y,le)|0,o=o+Math.imul(y,he)|0;var ke=(c+(n=n+Math.imul(l,pe)|0)|0)+((8191&(i=(i=i+Math.imul(l,ye)|0)+Math.imul(h,pe)|0))<<13)|0;c=((o=o+Math.imul(h,ye)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(D,F),i=(i=Math.imul(D,V))+Math.imul(K,F)|0,o=Math.imul(K,V),n=n+Math.imul(U,J)|0,i=(i=i+Math.imul(U,W)|0)+Math.imul(T,J)|0,o=o+Math.imul(T,W)|0,n=n+Math.imul(P,Z)|0,i=(i=i+Math.imul(P,Y)|0)+Math.imul(C,Z)|0,o=o+Math.imul(C,Y)|0,n=n+Math.imul(O,Q)|0,i=(i=i+Math.imul(O,ee)|0)+Math.imul(j,Q)|0,o=o+Math.imul(j,ee)|0,n=n+Math.imul(x,re)|0,i=(i=i+Math.imul(x,ne)|0)+Math.imul(E,re)|0,o=o+Math.imul(E,ne)|0,n=n+Math.imul(_,oe)|0,i=(i=i+Math.imul(_,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(w,ue)|0,i=(i=i+Math.imul(w,ce)|0)+Math.imul(S,ue)|0,o=o+Math.imul(S,ce)|0,n=n+Math.imul(v,le)|0,i=(i=i+Math.imul(v,he)|0)+Math.imul(g,le)|0,o=o+Math.imul(g,he)|0;var xe=(c+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,ye)|0)+Math.imul(y,pe)|0))<<13)|0;c=((o=o+Math.imul(y,ye)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(D,J),i=(i=Math.imul(D,W))+Math.imul(K,J)|0,o=Math.imul(K,W),n=n+Math.imul(U,Z)|0,i=(i=i+Math.imul(U,Y)|0)+Math.imul(T,Z)|0,o=o+Math.imul(T,Y)|0,n=n+Math.imul(P,Q)|0,i=(i=i+Math.imul(P,ee)|0)+Math.imul(C,Q)|0,o=o+Math.imul(C,ee)|0,n=n+Math.imul(O,re)|0,i=(i=i+Math.imul(O,ne)|0)+Math.imul(j,re)|0,o=o+Math.imul(j,ne)|0,n=n+Math.imul(x,oe)|0,i=(i=i+Math.imul(x,se)|0)+Math.imul(E,oe)|0,o=o+Math.imul(E,se)|0,n=n+Math.imul(_,ue)|0,i=(i=i+Math.imul(_,ce)|0)+Math.imul(M,ue)|0,o=o+Math.imul(M,ce)|0,n=n+Math.imul(w,le)|0,i=(i=i+Math.imul(w,he)|0)+Math.imul(S,le)|0,o=o+Math.imul(S,he)|0;var Ee=(c+(n=n+Math.imul(v,pe)|0)|0)+((8191&(i=(i=i+Math.imul(v,ye)|0)+Math.imul(g,pe)|0))<<13)|0;c=((o=o+Math.imul(g,ye)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(D,Z),i=(i=Math.imul(D,Y))+Math.imul(K,Z)|0,o=Math.imul(K,Y),n=n+Math.imul(U,Q)|0,i=(i=i+Math.imul(U,ee)|0)+Math.imul(T,Q)|0,o=o+Math.imul(T,ee)|0,n=n+Math.imul(P,re)|0,i=(i=i+Math.imul(P,ne)|0)+Math.imul(C,re)|0,o=o+Math.imul(C,ne)|0,n=n+Math.imul(O,oe)|0,i=(i=i+Math.imul(O,se)|0)+Math.imul(j,oe)|0,o=o+Math.imul(j,se)|0,n=n+Math.imul(x,ue)|0,i=(i=i+Math.imul(x,ce)|0)+Math.imul(E,ue)|0,o=o+Math.imul(E,ce)|0,n=n+Math.imul(_,le)|0,i=(i=i+Math.imul(_,he)|0)+Math.imul(M,le)|0,o=o+Math.imul(M,he)|0;var Be=(c+(n=n+Math.imul(w,pe)|0)|0)+((8191&(i=(i=i+Math.imul(w,ye)|0)+Math.imul(S,pe)|0))<<13)|0;c=((o=o+Math.imul(S,ye)|0)+(i>>>13)|0)+(Be>>>26)|0,Be&=67108863,n=Math.imul(D,Q),i=(i=Math.imul(D,ee))+Math.imul(K,Q)|0,o=Math.imul(K,ee),n=n+Math.imul(U,re)|0,i=(i=i+Math.imul(U,ne)|0)+Math.imul(T,re)|0,o=o+Math.imul(T,ne)|0,n=n+Math.imul(P,oe)|0,i=(i=i+Math.imul(P,se)|0)+Math.imul(C,oe)|0,o=o+Math.imul(C,se)|0,n=n+Math.imul(O,ue)|0,i=(i=i+Math.imul(O,ce)|0)+Math.imul(j,ue)|0,o=o+Math.imul(j,ce)|0,n=n+Math.imul(x,le)|0,i=(i=i+Math.imul(x,he)|0)+Math.imul(E,le)|0,o=o+Math.imul(E,he)|0;var Oe=(c+(n=n+Math.imul(_,pe)|0)|0)+((8191&(i=(i=i+Math.imul(_,ye)|0)+Math.imul(M,pe)|0))<<13)|0;c=((o=o+Math.imul(M,ye)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(D,re),i=(i=Math.imul(D,ne))+Math.imul(K,re)|0,o=Math.imul(K,ne),n=n+Math.imul(U,oe)|0,i=(i=i+Math.imul(U,se)|0)+Math.imul(T,oe)|0,o=o+Math.imul(T,se)|0,n=n+Math.imul(P,ue)|0,i=(i=i+Math.imul(P,ce)|0)+Math.imul(C,ue)|0,o=o+Math.imul(C,ce)|0,n=n+Math.imul(O,le)|0,i=(i=i+Math.imul(O,he)|0)+Math.imul(j,le)|0,o=o+Math.imul(j,he)|0;var je=(c+(n=n+Math.imul(x,pe)|0)|0)+((8191&(i=(i=i+Math.imul(x,ye)|0)+Math.imul(E,pe)|0))<<13)|0;c=((o=o+Math.imul(E,ye)|0)+(i>>>13)|0)+(je>>>26)|0,je&=67108863,n=Math.imul(D,oe),i=(i=Math.imul(D,se))+Math.imul(K,oe)|0,o=Math.imul(K,se),n=n+Math.imul(U,ue)|0,i=(i=i+Math.imul(U,ce)|0)+Math.imul(T,ue)|0,o=o+Math.imul(T,ce)|0,n=n+Math.imul(P,le)|0,i=(i=i+Math.imul(P,he)|0)+Math.imul(C,le)|0,o=o+Math.imul(C,he)|0;var Ie=(c+(n=n+Math.imul(O,pe)|0)|0)+((8191&(i=(i=i+Math.imul(O,ye)|0)+Math.imul(j,pe)|0))<<13)|0;c=((o=o+Math.imul(j,ye)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(D,ue),i=(i=Math.imul(D,ce))+Math.imul(K,ue)|0,o=Math.imul(K,ce),n=n+Math.imul(U,le)|0,i=(i=i+Math.imul(U,he)|0)+Math.imul(T,le)|0,o=o+Math.imul(T,he)|0;var Pe=(c+(n=n+Math.imul(P,pe)|0)|0)+((8191&(i=(i=i+Math.imul(P,ye)|0)+Math.imul(C,pe)|0))<<13)|0;c=((o=o+Math.imul(C,ye)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(D,le),i=(i=Math.imul(D,he))+Math.imul(K,le)|0,o=Math.imul(K,he);var Ce=(c+(n=n+Math.imul(U,pe)|0)|0)+((8191&(i=(i=i+Math.imul(U,ye)|0)+Math.imul(T,pe)|0))<<13)|0;c=((o=o+Math.imul(T,ye)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863;var Ne=(c+(n=Math.imul(D,pe))|0)+((8191&(i=(i=Math.imul(D,ye))+Math.imul(K,pe)|0))<<13)|0;return c=((o=Math.imul(K,ye))+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,u[0]=be,u[1]=ve,u[2]=ge,u[3]=me,u[4]=we,u[5]=Se,u[6]=Ae,u[7]=_e,u[8]=Me,u[9]=ke,u[10]=xe,u[11]=Ee,u[12]=Be,u[13]=Oe,u[14]=je,u[15]=Ie,u[16]=Pe,u[17]=Ce,u[18]=Ne,0!==c&&(u[19]=c,r.length++),r};function v(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,o=0;o<r.length-1;o++){var s=i;i=0;for(var a=67108863&n,u=Math.min(o,t.length-1),c=Math.max(0,o-e.length+1);c<=u;c++){var f=o-c,l=(0|e.words[f])*(0|t.words[c]),h=67108863&l;a=67108863&(h=h+a|0),i+=(s=(s=s+(l/67108864|0)|0)+(h>>>26)|0)>>>26,s&=67108863}r.words[o]=a,n=s,s=i}return 0!==n?r.words[o]=n:r.length--,r._strip()}function g(e,t,r){return v(e,t,r)}function m(e,t){this.x=e,this.y=t}Math.imul||(b=y),o.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?b(this,e,t):r<63?y(this,e,t):r<1024?v(this,e,t):g(this,e,t)},m.prototype.makeRBT=function(e){for(var t=new Array(e),r=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},m.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},m.prototype.permute=function(e,t,r,n,i,o){for(var s=0;s<o;s++)n[s]=t[e[s]],i[s]=r[e[s]]},m.prototype.transform=function(e,t,r,n,i,o){this.permute(o,e,t,r,n,i);for(var s=1;s<i;s<<=1)for(var a=s<<1,u=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),f=0;f<i;f+=a)for(var l=u,h=c,d=0;d<s;d++){var p=r[f+d],y=n[f+d],b=r[f+d+s],v=n[f+d+s],g=l*b-h*v;v=l*v+h*b,b=g,r[f+d]=p+b,n[f+d]=y+v,r[f+d+s]=p-b,n[f+d+s]=y-v,d!==a&&(g=u*l-c*h,h=u*h+c*l,l=g)}},m.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},m.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},m.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},m.prototype.convert13b=function(e,t,r,i){for(var o=0,s=0;s<t;s++)o+=0|e[s],r[2*s]=8191&o,o>>>=13,r[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<i;++s)r[s]=0;n(0===o),n(!(-8192&o))},m.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},m.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),u=new Array(n),c=new Array(n),f=new Array(n),l=new Array(n),h=r.words;h.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,c,n),this.transform(s,o,a,u,n,i),this.transform(c,o,f,l,n,i);for(var d=0;d<n;d++){var p=a[d]*f[d]-u[d]*l[d];u[d]=a[d]*l[d]+u[d]*f[d],a[d]=p}return this.conjugate(a,u,n),this.transform(a,u,h,o,n,i),this.conjugate(h,o,n),this.normalize13b(h,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),g(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"==typeof e),n(e<67108864);for(var r=0,i=0;i<this.length;i++){var o=(0|this.words[i])*e,s=(67108863&o)+(67108863&r);r>>=26,r+=o/67108864|0,r+=s>>>26,this.words[i]=67108863&s}return 0!==r&&(this.words[i]=r,this.length++),t?this.ineg():this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=e.words[n]>>>i&1}return t}(e);if(0===t.length)return new o(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},o.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,u=(0|this.words[t])-a<<r;this.words[t]=u|s,s=a>>>26-r}s&&(this.words[t]=s,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,u=r;if(i-=s,i=Math.max(0,i),u){for(var c=0;c<s;c++)u.words[c]=this.words[c];u.length=s}if(0===s);else if(this.length>s)for(this.length-=s,c=0;c<this.length;c++)this.words[c]=this.words[c+s];else this.words[0]=0,this.length=1;var f=0;for(c=this.length-1;c>=0&&(0!==f||c>=i);c--){var l=0|this.words[c];this.words[c]=f<<26-o|l>>>o,f=l&a}return u&&0!==f&&(u.words[u.length++]=f),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},o.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r||!(this.words[r]&i))},o.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,r){var i,o,s=e.length+r;this._expand(s);var a=0;for(i=0;i<e.length;i++){o=(0|this.words[i+r])+a;var u=(0|e.words[i])*t;a=((o-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)a=(o=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&o;if(0===a)return this._strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(o=-(0|this.words[i])+a)>>26,this.words[i]=67108863&o;return this.negative=1,this._strip()},o.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,s=0|i.words[i.length-1];0!=(r=26-this._countBits(s))&&(i=i.ushln(r),n.iushln(r),s=0|i.words[i.length-1]);var a,u=n.length-i.length;if("mod"!==t){(a=new o(null)).length=u+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var f=n.clone()._ishlnsubmul(i,1,u);0===f.negative&&(n=f,a&&(a.words[u]=1));for(var l=u-1;l>=0;l--){var h=67108864*(0|n.words[i.length+l])+(0|n.words[i.length+l-1]);for(h=Math.min(h/s|0,67108863),n._ishlnsubmul(i,h,l);0!==n.negative;)h--,n.negative=0,n._ishlnsubmul(i,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=h)}return a&&a._strip(),n._strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.iadd(e)),{div:i,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):this.negative&e.negative?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),r&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modrn(e.words[0]))}:this._wordDiv(e,t);var i,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),o=r.cmp(n);return o<0||1===i&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=(1<<26)%e,i=0,o=this.length-1;o>=0;o--)i=(r*i+(0|this.words[o]))%e;return t?-i:i},o.prototype.modn=function(e){return this.modrn(e)},o.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var o=(0|this.words[i])+67108864*r;this.words[i]=o/e|0,r=o%e}return this._strip(),t?this.ineg():this},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new o(1),s=new o(0),a=new o(0),u=new o(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var f=r.clone(),l=t.clone();!t.isZero();){for(var h=0,d=1;!(t.words[0]&d)&&h<26;++h,d<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(i.isOdd()||s.isOdd())&&(i.iadd(f),s.isub(l)),i.iushrn(1),s.iushrn(1);for(var p=0,y=1;!(r.words[0]&y)&&p<26;++p,y<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||u.isOdd())&&(a.iadd(f),u.isub(l)),a.iushrn(1),u.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),s.isub(u)):(r.isub(t),a.isub(i),u.isub(s))}return{a,b:u,gcd:r.iushln(c)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,s=new o(1),a=new o(0),u=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,f=1;!(t.words[0]&f)&&c<26;++c,f<<=1);if(c>0)for(t.iushrn(c);c-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);for(var l=0,h=1;!(r.words[0]&h)&&l<26;++l,h<<=1);if(l>0)for(r.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),s.isub(a)):(r.isub(t),a.isub(s))}return(i=0===t.cmpn(1)?s:a).cmpn(0)<0&&i.iadd(e),i},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var o=t;t=r,r=o}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return!(1&this.words[0])},o.prototype.isOdd=function(){return!(1&~this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,s=r;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new x(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var w={k256:null,p224:null,p192:null,p25519:null};function S(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function A(){S.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function _(){S.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function M(){S.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function k(){S.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function x(e){if("string"==typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function E(e){x.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}S.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},S.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},S.prototype.split=function(e,t){e.iushrn(this.n,0,t)},S.prototype.imulK=function(e){return e.imul(this.k)},i(A,S),A.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&r,i=10;i<e.length;i++){var s=0|e.words[i];e.words[i-10]=(s&r)<<4|o>>>22,o=s}o>>>=22,e.words[i-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},A.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(_,S),i(M,S),i(k,S),k.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(w[e])return w[e];var t;if("k256"===e)t=new A;else if("p224"===e)t=new _;else if("p192"===e)t=new M;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new k}return w[e]=t,t},x.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},x.prototype._verify2=function(e,t){n(!(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},x.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(f(e,e.umod(this.m)._forceRed(this)),e)},x.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},x.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},x.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},x.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},x.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},x.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},x.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},x.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},x.prototype.isqr=function(e){return this.imul(e,e.clone())},x.prototype.sqr=function(e){return this.mul(e,e)},x.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new o(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),s=0;!i.isZero()&&0===i.andln(1);)s++,i.iushrn(1);n(!i.isZero());var a=new o(1).toRed(this),u=a.redNeg(),c=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new o(2*f*f).toRed(this);0!==this.pow(f,c).cmp(u);)f.redIAdd(u);for(var l=this.pow(f,i),h=this.pow(e,i.addn(1).iushrn(1)),d=this.pow(e,i),p=s;0!==d.cmp(a);){for(var y=d,b=0;0!==y.cmp(a);b++)y=y.redSqr();n(b<p);var v=this.pow(l,new o(1).iushln(p-b-1));h=h.redMul(v),l=v.redSqr(),d=d.redMul(l),p=b}return h},x.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},x.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new o(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],s=0,a=0,u=t.bitLength()%26;for(0===u&&(u=26),n=t.length-1;n>=0;n--){for(var c=t.words[n],f=u-1;f>=0;f--){var l=c>>f&1;i!==r[0]&&(i=this.sqr(i)),0!==l||0!==s?(s<<=1,s|=l,(4==++a||0===n&&0===f)&&(i=this.mul(i,r[s]),a=0,s=0)):a=0}u=26}return i},x.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},x.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new E(e)},i(E,x),E.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},E.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},E.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},E.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},E.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=r.nmd(e),this)},9456:(e,t,r)=>{var n;function i(e){this.rand=e}if(e.exports=function(e){return n||(n=new i(null)),n.generate(e)},e.exports.Rand=i,i.prototype.generate=function(e){return this._rand(e)},i.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),r=0;r<t.length;r++)t[r]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(i.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var o=r(6100);if("function"!=typeof o.randomBytes)throw new Error("Not supported");i.prototype._rand=function(e){return o.randomBytes(e)}}catch(e){}},5872:(e,t,r)=>{"use strict";const n=r(5415),i=r(551),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=function(e){return+e!=e&&(e=0),u.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,u.prototype),t}function u(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return l(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|y(e,t);let n=a(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){const t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return d(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return u.from(n,t,r);const i=function(e){if(u.isBuffer(e)){const t=0|p(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||Z(e.length)?a(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function f(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function l(e){return f(e),a(e<0?0:0|p(e))}function h(e){const t=e.length<0?0:0|p(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,u.prototype),n}function p(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function y(e,t){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return J(e).length;default:if(i)return n?-1:$(e).length;t=(""+t).toLowerCase(),i=!0}}function b(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return j(this,t,r);case"utf8":case"utf-8":return x(this,t,r);case"ascii":return B(this,t,r);case"latin1":case"binary":return O(this,t,r);case"base64":return k(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function g(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,r,n,i){let o,s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let n=-1;for(o=r;o<a;o++)if(c(e,o)===c(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===u)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){let r=!0;for(let n=0;n<u;n++)if(c(e,o+n)!==c(t,n)){r=!1;break}if(r)return o}return-1}function w(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=t.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(t.substr(2*s,2),16);if(Z(n))return s;e[r+s]=n}return s}function S(e,t,r,n){return W($(t,e.length-r),e,r,n)}function A(e,t,r,n){return W(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return W(J(t),e,r,n)}function M(e,t,r,n){return W(function(e,t){let r,n,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function k(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function x(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=r){let r,n,a,u;switch(s){case 1:t<128&&(o=t);break;case 2:r=e[i+1],128==(192&r)&&(u=(31&t)<<6|63&r,u>127&&(o=u));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(u=(15&t)<<12|(63&r)<<6|63&n,u>2047&&(u<55296||u>57343)&&(o=u));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(u=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,u>65535&&u<1114112&&(o=u))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return function(e){const t=e.length;if(t<=E)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=E));return r}(n)}t.kMaxLength=s,u.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,t,r){return function(e,t,r){return f(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},u.allocUnsafe=function(e){return l(e)},u.allocUnsafeSlow=function(e){return l(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,t){if(G(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=u.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(G(t,Uint8Array))i+t.length>n.length?(u.isBuffer(t)||(t=u.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!u.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},u.byteLength=y,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)v(this,t,t+1);return this},u.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},u.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},u.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?x(this,0,e):b.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},o&&(u.prototype[o]=u.prototype.inspect),u.prototype.compare=function(e,t,r,n,i){if(G(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);const a=Math.min(o,s),c=this.slice(n,i),f=e.slice(t,r);for(let e=0;e<a;++e)if(c[e]!==f[e]){o=c[e],s=f[e];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return S(this,e,t,r);case"ascii":case"latin1":case"binary":return A(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const E=4096;function B(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function O(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function j(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=Y[e[n]];return i}function I(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function P(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function C(e,t,r,n,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function N(e,t,r,n,i){H(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function U(e,t,r,n,i){H(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function T(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function R(e,t,r,n,o){return t=+t,r>>>=0,o||T(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function D(e,t,r,n,o){return t=+t,r>>>=0,o||T(e,0,r,8),i.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,u.prototype),n},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readBigUInt64LE=X((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),u.prototype.readBigUInt64BE=X((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),u.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=t,i=1,o=this[e+--n];for(;n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readBigInt64LE=X((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),u.prototype.readBigInt64BE=X((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),u.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||C(this,e,t,r,Math.pow(2,8*r)-1,0);let i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||C(this,e,t,r,Math.pow(2,8*r)-1,0);let i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,1,255,0),this[t]=255&e,t+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigUInt64LE=X((function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=X((function(e,t=0){return U(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);C(this,e,t,r,n-1,-n)}let i=0,o=1,s=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);C(this,e,t,r,n-1,-n)}let i=r-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigInt64LE=X((function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=X((function(e,t=0){return U(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(e,t,r){return R(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return R(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return D(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return D(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const o=u.isBuffer(e)?e:u.from(e,n),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%s]}return this};const K={};function L(e,t,r){K[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function z(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function H(e,t,r,n,i,o){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new K.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){q(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||F(t,e.length-(r+1))}(n,i,o)}function q(e,t){if("number"!=typeof e)throw new K.ERR_INVALID_ARG_TYPE(t,"number",e)}function F(e,t,r){if(Math.floor(e)!==e)throw q(e,r),new K.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new K.ERR_BUFFER_OUT_OF_BOUNDS;throw new K.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}L("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),L("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),L("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=z(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=z(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const V=/[^+/0-9A-Za-z-_]/g;function $(e,t){let r;t=t||1/0;const n=e.length;let i=null;const o=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function J(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Z(e){return e!=e}const Y=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function X(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}},6636:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=t},1048:e=>{var t,r;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var r=[],n=0;n<e.length;n+=3)for(var i=e[n]<<16|e[n+1]<<8|e[n+2],o=0;o<4;o++)8*n+6*o<=8*e.length?r.push(t.charAt(i>>>6*(3-o)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],n=0,i=0;n<e.length;i=++n%4)0!=i&&r.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*i+8)-1)<<2*i|t.indexOf(e.charAt(n))>>>6-2*i);return r}},e.exports=r},4833:(e,t,r)=>{"use strict";t.utils=r(6400),t.Cipher=r(7936),t.DES=r(4628),t.CBC=r(7337),t.EDE=r(8245)},7337:(e,t,r)=>{"use strict";var n=r(6111),i=r(2937),o={};function s(e){n.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}t.instantiate=function(e){function t(t){e.call(this,t),this._cbcInit()}i(t,e);for(var r=Object.keys(o),n=0;n<r.length;n++){var s=r[n];t.prototype[s]=o[s]}return t.create=function(e){return new t(e)},t},o._cbcInit=function(){var e=new s(this.options.iv);this._cbcState=e},o._update=function(e,t,r,n){var i=this._cbcState,o=this.constructor.super_.prototype,s=i.iv;if("encrypt"===this.type){for(var a=0;a<this.blockSize;a++)s[a]^=e[t+a];for(o._update.call(this,s,0,r,n),a=0;a<this.blockSize;a++)s[a]=r[n+a]}else{for(o._update.call(this,e,t,r,n),a=0;a<this.blockSize;a++)r[n+a]^=s[a];for(a=0;a<this.blockSize;a++)s[a]=e[t+a]}}},7936:(e,t,r)=>{"use strict";var n=r(6111);function i(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=!1!==e.padding}e.exports=i,i.prototype._init=function(){},i.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},i.prototype._buffer=function(e,t){for(var r=Math.min(this.buffer.length-this.bufferOff,e.length-t),n=0;n<r;n++)this.buffer[this.bufferOff+n]=e[t+n];return this.bufferOff+=r,r},i.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},i.prototype._updateEncrypt=function(e){var t=0,r=0,n=(this.bufferOff+e.length)/this.blockSize|0,i=new Array(n*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(r+=this._flushBuffer(i,r)));for(var o=e.length-(e.length-t)%this.blockSize;t<o;t+=this.blockSize)this._update(e,t,i,r),r+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return i},i.prototype._updateDecrypt=function(e){for(var t=0,r=0,n=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,i=new Array(n*this.blockSize);n>0;n--)t+=this._buffer(e,t),r+=this._flushBuffer(i,r);return t+=this._buffer(e,t),i},i.prototype.final=function(e){var t,r;return e&&(t=this.update(e)),r="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(r):r},i.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},i.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},i.prototype._unpad=function(e){return e},i.prototype._finalDecrypt=function(){n.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}},4628:(e,t,r)=>{"use strict";var n=r(6111),i=r(2937),o=r(6400),s=r(7936);function a(){this.tmp=new Array(2),this.keys=null}function u(e){s.call(this,e);var t=new a;this._desState=t,this.deriveKeys(t,e.key)}i(u,s),e.exports=u,u.create=function(e){return new u(e)};var c=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];u.prototype.deriveKeys=function(e,t){e.keys=new Array(32),n.equal(t.length,this.blockSize,"Invalid key length");var r=o.readUInt32BE(t,0),i=o.readUInt32BE(t,4);o.pc1(r,i,e.tmp,0),r=e.tmp[0],i=e.tmp[1];for(var s=0;s<e.keys.length;s+=2){var a=c[s>>>1];r=o.r28shl(r,a),i=o.r28shl(i,a),o.pc2(r,i,e.keys,s)}},u.prototype._update=function(e,t,r,n){var i=this._desState,s=o.readUInt32BE(e,t),a=o.readUInt32BE(e,t+4);o.ip(s,a,i.tmp,0),s=i.tmp[0],a=i.tmp[1],"encrypt"===this.type?this._encrypt(i,s,a,i.tmp,0):this._decrypt(i,s,a,i.tmp,0),s=i.tmp[0],a=i.tmp[1],o.writeUInt32BE(r,s,n),o.writeUInt32BE(r,a,n+4)},u.prototype._pad=function(e,t){if(!1===this.padding)return!1;for(var r=e.length-t,n=t;n<e.length;n++)e[n]=r;return!0},u.prototype._unpad=function(e){if(!1===this.padding)return e;for(var t=e[e.length-1],r=e.length-t;r<e.length;r++)n.equal(e[r],t);return e.slice(0,e.length-t)},u.prototype._encrypt=function(e,t,r,n,i){for(var s=t,a=r,u=0;u<e.keys.length;u+=2){var c=e.keys[u],f=e.keys[u+1];o.expand(a,e.tmp,0),c^=e.tmp[0],f^=e.tmp[1];var l=o.substitute(c,f),h=a;a=(s^o.permute(l))>>>0,s=h}o.rip(a,s,n,i)},u.prototype._decrypt=function(e,t,r,n,i){for(var s=r,a=t,u=e.keys.length-2;u>=0;u-=2){var c=e.keys[u],f=e.keys[u+1];o.expand(s,e.tmp,0),c^=e.tmp[0],f^=e.tmp[1];var l=o.substitute(c,f),h=s;s=(a^o.permute(l))>>>0,a=h}o.rip(s,a,n,i)}},8245:(e,t,r)=>{"use strict";var n=r(6111),i=r(2937),o=r(7936),s=r(4628);function a(e,t){n.equal(t.length,24,"Invalid key length");var r=t.slice(0,8),i=t.slice(8,16),o=t.slice(16,24);this.ciphers="encrypt"===e?[s.create({type:"encrypt",key:r}),s.create({type:"decrypt",key:i}),s.create({type:"encrypt",key:o})]:[s.create({type:"decrypt",key:o}),s.create({type:"encrypt",key:i}),s.create({type:"decrypt",key:r})]}function u(e){o.call(this,e);var t=new a(this.type,this.options.key);this._edeState=t}i(u,o),e.exports=u,u.create=function(e){return new u(e)},u.prototype._update=function(e,t,r,n){var i=this._edeState;i.ciphers[0]._update(e,t,r,n),i.ciphers[1]._update(r,n,r,n),i.ciphers[2]._update(r,n,r,n)},u.prototype._pad=s.prototype._pad,u.prototype._unpad=s.prototype._unpad},6400:(e,t)=>{"use strict";t.readUInt32BE=function(e,t){return(e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])>>>0},t.writeUInt32BE=function(e,t,r){e[0+r]=t>>>24,e[1+r]=t>>>16&255,e[2+r]=t>>>8&255,e[3+r]=255&t},t.ip=function(e,t,r,n){for(var i=0,o=0,s=6;s>=0;s-=2){for(var a=0;a<=24;a+=8)i<<=1,i|=t>>>a+s&1;for(a=0;a<=24;a+=8)i<<=1,i|=e>>>a+s&1}for(s=6;s>=0;s-=2){for(a=1;a<=25;a+=8)o<<=1,o|=t>>>a+s&1;for(a=1;a<=25;a+=8)o<<=1,o|=e>>>a+s&1}r[n+0]=i>>>0,r[n+1]=o>>>0},t.rip=function(e,t,r,n){for(var i=0,o=0,s=0;s<4;s++)for(var a=24;a>=0;a-=8)i<<=1,i|=t>>>a+s&1,i<<=1,i|=e>>>a+s&1;for(s=4;s<8;s++)for(a=24;a>=0;a-=8)o<<=1,o|=t>>>a+s&1,o<<=1,o|=e>>>a+s&1;r[n+0]=i>>>0,r[n+1]=o>>>0},t.pc1=function(e,t,r,n){for(var i=0,o=0,s=7;s>=5;s--){for(var a=0;a<=24;a+=8)i<<=1,i|=t>>a+s&1;for(a=0;a<=24;a+=8)i<<=1,i|=e>>a+s&1}for(a=0;a<=24;a+=8)i<<=1,i|=t>>a+s&1;for(s=1;s<=3;s++){for(a=0;a<=24;a+=8)o<<=1,o|=t>>a+s&1;for(a=0;a<=24;a+=8)o<<=1,o|=e>>a+s&1}for(a=0;a<=24;a+=8)o<<=1,o|=e>>a+s&1;r[n+0]=i>>>0,r[n+1]=o>>>0},t.r28shl=function(e,t){return e<<t&268435455|e>>>28-t};var r=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];t.pc2=function(e,t,n,i){for(var o=0,s=0,a=r.length>>>1,u=0;u<a;u++)o<<=1,o|=e>>>r[u]&1;for(u=a;u<r.length;u++)s<<=1,s|=t>>>r[u]&1;n[i+0]=o>>>0,n[i+1]=s>>>0},t.expand=function(e,t,r){var n=0,i=0;n=(1&e)<<5|e>>>27;for(var o=23;o>=15;o-=4)n<<=6,n|=e>>>o&63;for(o=11;o>=3;o-=4)i|=e>>>o&63,i<<=6;i|=(31&e)<<1|e>>>31,t[r+0]=n>>>0,t[r+1]=i>>>0};var n=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];t.substitute=function(e,t){for(var r=0,i=0;i<4;i++)r<<=4,r|=n[64*i+(e>>>18-6*i&63)];for(i=0;i<4;i++)r<<=4,r|=n[256+64*i+(t>>>18-6*i&63)];return r>>>0};var i=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];t.permute=function(e){for(var t=0,r=0;r<i.length;r++)t<<=1,t|=e>>>i[r]&1;return t>>>0},t.padSplit=function(e,t,r){for(var n=e.toString(2);n.length<t;)n="0"+n;for(var i=[],o=0;o<t;o+=r)i.push(n.slice(o,o+r));return i.join(" ")}},4365:(e,t,r)=>{"use strict";var n=t;n.version=r(6573).i8,n.utils=r(7603),n.rand=r(9456),n.curve=r(4956),n.curves=r(4234),n.ec=r(756),n.eddsa=r(5036)},7687:(e,t,r)=>{"use strict";var n=r(1172),i=r(7603),o=i.getNAF,s=i.getJSF,a=i.assert;function u(e,t){this.type=e,this.p=new n(t.p,16),this.red=t.prime?n.red(t.prime):n.mont(this.p),this.zero=new n(0).toRed(this.red),this.one=new n(1).toRed(this.red),this.two=new n(2).toRed(this.red),this.n=t.n&&new n(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function c(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=u,u.prototype.point=function(){throw new Error("Not implemented")},u.prototype.validate=function(){throw new Error("Not implemented")},u.prototype._fixedNafMul=function(e,t){a(e.precomputed);var r=e._getDoubles(),n=o(t,1,this._bitLength),i=(1<<r.step+1)-(r.step%2==0?2:1);i/=3;var s,u,c=[];for(s=0;s<n.length;s+=r.step){u=0;for(var f=s+r.step-1;f>=s;f--)u=(u<<1)+n[f];c.push(u)}for(var l=this.jpoint(null,null,null),h=this.jpoint(null,null,null),d=i;d>0;d--){for(s=0;s<c.length;s++)(u=c[s])===d?h=h.mixedAdd(r.points[s]):u===-d&&(h=h.mixedAdd(r.points[s].neg()));l=l.add(h)}return l.toP()},u.prototype._wnafMul=function(e,t){var r=4,n=e._getNAFPoints(r);r=n.wnd;for(var i=n.points,s=o(t,r,this._bitLength),u=this.jpoint(null,null,null),c=s.length-1;c>=0;c--){for(var f=0;c>=0&&0===s[c];c--)f++;if(c>=0&&f++,u=u.dblp(f),c<0)break;var l=s[c];a(0!==l),u="affine"===e.type?l>0?u.mixedAdd(i[l-1>>1]):u.mixedAdd(i[-l-1>>1].neg()):l>0?u.add(i[l-1>>1]):u.add(i[-l-1>>1].neg())}return"affine"===e.type?u.toP():u},u.prototype._wnafMulAdd=function(e,t,r,n,i){var a,u,c,f=this._wnafT1,l=this._wnafT2,h=this._wnafT3,d=0;for(a=0;a<n;a++){var p=(c=t[a])._getNAFPoints(e);f[a]=p.wnd,l[a]=p.points}for(a=n-1;a>=1;a-=2){var y=a-1,b=a;if(1===f[y]&&1===f[b]){var v=[t[y],null,null,t[b]];0===t[y].y.cmp(t[b].y)?(v[1]=t[y].add(t[b]),v[2]=t[y].toJ().mixedAdd(t[b].neg())):0===t[y].y.cmp(t[b].y.redNeg())?(v[1]=t[y].toJ().mixedAdd(t[b]),v[2]=t[y].add(t[b].neg())):(v[1]=t[y].toJ().mixedAdd(t[b]),v[2]=t[y].toJ().mixedAdd(t[b].neg()));var g=[-3,-1,-5,-7,0,7,5,1,3],m=s(r[y],r[b]);for(d=Math.max(m[0].length,d),h[y]=new Array(d),h[b]=new Array(d),u=0;u<d;u++){var w=0|m[0][u],S=0|m[1][u];h[y][u]=g[3*(w+1)+(S+1)],h[b][u]=0,l[y]=v}}else h[y]=o(r[y],f[y],this._bitLength),h[b]=o(r[b],f[b],this._bitLength),d=Math.max(h[y].length,d),d=Math.max(h[b].length,d)}var A=this.jpoint(null,null,null),_=this._wnafT4;for(a=d;a>=0;a--){for(var M=0;a>=0;){var k=!0;for(u=0;u<n;u++)_[u]=0|h[u][a],0!==_[u]&&(k=!1);if(!k)break;M++,a--}if(a>=0&&M++,A=A.dblp(M),a<0)break;for(u=0;u<n;u++){var x=_[u];0!==x&&(x>0?c=l[u][x-1>>1]:x<0&&(c=l[u][-x-1>>1].neg()),A="affine"===c.type?A.mixedAdd(c):A.add(c))}}for(a=0;a<n;a++)l[a]=null;return i?A:A.toP()},u.BasePoint=c,c.prototype.eq=function(){throw new Error("Not implemented")},c.prototype.validate=function(){return this.curve.validate(this)},u.prototype.decodePoint=function(e,t){e=i.toArray(e,t);var r=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*r)return 6===e[0]?a(e[e.length-1]%2==0):7===e[0]&&a(e[e.length-1]%2==1),this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));if((2===e[0]||3===e[0])&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),3===e[0]);throw new Error("Unknown point format")},c.prototype.encodeCompressed=function(e){return this.encode(e,!0)},c.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))},c.prototype.encode=function(e,t){return i.encode(this._encode(t),e)},c.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},c.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},c.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],n=this,i=0;i<t;i+=e){for(var o=0;o<e;o++)n=n.dbl();r.push(n)}return{step:e,points:r}},c.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,n=1===r?null:this.dbl(),i=1;i<r;i++)t[i]=t[i-1].add(n);return{wnd:e,points:t}},c.prototype._getBeta=function(){return null},c.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t}},994:(e,t,r)=>{"use strict";var n=r(7603),i=r(1172),o=r(2937),s=r(7687),a=n.assert;function u(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,s.call(this,"edwards",e),this.a=new i(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new i(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new i(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function c(e,t,r,n,o){s.BasePoint.call(this,e,"projective"),null===t&&null===r&&null===n?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new i(t,16),this.y=new i(r,16),this.z=n?new i(n,16):this.curve.one,this.t=o&&new i(o,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}o(u,s),e.exports=u,u.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},u.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},u.prototype.jpoint=function(e,t,r,n){return this.point(e,t,r,n)},u.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),n=this.c2.redSub(this.a.redMul(r)),o=this.one.redSub(this.c2.redMul(this.d).redMul(r)),s=n.redMul(o.redInvm()),a=s.redSqrt();if(0!==a.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");var u=a.fromRed().isOdd();return(t&&!u||!t&&u)&&(a=a.redNeg()),this.point(e,a)},u.prototype.pointFromY=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),n=r.redSub(this.c2),o=r.redMul(this.d).redMul(this.c2).redSub(this.a),s=n.redMul(o.redInvm());if(0===s.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var a=s.redSqrt();if(0!==a.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)},u.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),r=e.y.redSqr(),n=t.redMul(this.a).redAdd(r),i=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(r)));return 0===n.cmp(i)},o(c,s.BasePoint),u.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},u.prototype.point=function(e,t,r,n){return new c(this,e,t,r,n)},c.fromJSON=function(e,t){return new c(e,t[0],t[1],t[2])},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},c.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var n=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),o=n.redAdd(t),s=o.redSub(r),a=n.redSub(t),u=i.redMul(s),c=o.redMul(a),f=i.redMul(a),l=s.redMul(o);return this.curve.point(u,c,l,f)},c.prototype._projDbl=function(){var e,t,r,n,i,o,s=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),u=this.y.redSqr();if(this.curve.twisted){var c=(n=this.curve._mulA(a)).redAdd(u);this.zOne?(e=s.redSub(a).redSub(u).redMul(c.redSub(this.curve.two)),t=c.redMul(n.redSub(u)),r=c.redSqr().redSub(c).redSub(c)):(i=this.z.redSqr(),o=c.redSub(i).redISub(i),e=s.redSub(a).redISub(u).redMul(o),t=c.redMul(n.redSub(u)),r=c.redMul(o))}else n=a.redAdd(u),i=this.curve._mulC(this.z).redSqr(),o=n.redSub(i).redSub(i),e=this.curve._mulC(s.redISub(n)).redMul(o),t=this.curve._mulC(n).redMul(a.redISub(u)),r=n.redMul(o);return this.curve.point(e,t,r)},c.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},c.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),r=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),i=this.z.redMul(e.z.redAdd(e.z)),o=r.redSub(t),s=i.redSub(n),a=i.redAdd(n),u=r.redAdd(t),c=o.redMul(s),f=a.redMul(u),l=o.redMul(u),h=s.redMul(a);return this.curve.point(c,f,h,l)},c.prototype._projAdd=function(e){var t,r,n=this.z.redMul(e.z),i=n.redSqr(),o=this.x.redMul(e.x),s=this.y.redMul(e.y),a=this.curve.d.redMul(o).redMul(s),u=i.redSub(a),c=i.redAdd(a),f=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(o).redISub(s),l=n.redMul(u).redMul(f);return this.curve.twisted?(t=n.redMul(c).redMul(s.redSub(this.curve._mulA(o))),r=u.redMul(c)):(t=n.redMul(c).redMul(s.redSub(o)),r=this.curve._mulC(u).redMul(c)),this.curve.point(l,t,r)},c.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},c.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!1)},c.prototype.jmulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!0)},c.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},c.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()},c.prototype.getY=function(){return this.normalize(),this.y.fromRed()},c.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},c.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var r=e.clone(),n=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),0===this.x.cmp(t))return!0}},c.prototype.toP=c.prototype.normalize,c.prototype.mixedAdd=c.prototype.add},4956:(e,t,r)=>{"use strict";var n=t;n.base=r(7687),n.short=r(6997),n.mont=r(2301),n.edwards=r(994)},2301:(e,t,r)=>{"use strict";var n=r(1172),i=r(2937),o=r(7687),s=r(7603);function a(e){o.call(this,"mont",e),this.a=new n(e.a,16).toRed(this.red),this.b=new n(e.b,16).toRed(this.red),this.i4=new n(4).toRed(this.red).redInvm(),this.two=new n(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function u(e,t,r){o.BasePoint.call(this,e,"projective"),null===t&&null===r?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new n(t,16),this.z=new n(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}i(a,o),e.exports=a,a.prototype.validate=function(e){var t=e.normalize().x,r=t.redSqr(),n=r.redMul(t).redAdd(r.redMul(this.a)).redAdd(t);return 0===n.redSqrt().redSqr().cmp(n)},i(u,o.BasePoint),a.prototype.decodePoint=function(e,t){return this.point(s.toArray(e,t),1)},a.prototype.point=function(e,t){return new u(this,e,t)},a.prototype.pointFromJSON=function(e){return u.fromJSON(this,e)},u.prototype.precompute=function(){},u.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},u.fromJSON=function(e,t){return new u(e,t[0],t[1]||e.one)},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},u.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),r=e.redSub(t),n=e.redMul(t),i=r.redMul(t.redAdd(this.curve.a24.redMul(r)));return this.curve.point(n,i)},u.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.diffAdd=function(e,t){var r=this.x.redAdd(this.z),n=this.x.redSub(this.z),i=e.x.redAdd(e.z),o=e.x.redSub(e.z).redMul(r),s=i.redMul(n),a=t.z.redMul(o.redAdd(s).redSqr()),u=t.x.redMul(o.redISub(s).redSqr());return this.curve.point(a,u)},u.prototype.mul=function(e){for(var t=e.clone(),r=this,n=this.curve.point(null,null),i=[];0!==t.cmpn(0);t.iushrn(1))i.push(t.andln(1));for(var o=i.length-1;o>=0;o--)0===i[o]?(r=r.diffAdd(n,this),n=n.dbl()):(n=r.diffAdd(n,this),r=r.dbl());return n},u.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},u.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},6997:(e,t,r)=>{"use strict";var n=r(7603),i=r(1172),o=r(2937),s=r(7687),a=n.assert;function u(e){s.call(this,"short",e),this.a=new i(e.a,16).toRed(this.red),this.b=new i(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function c(e,t,r,n){s.BasePoint.call(this,e,"affine"),null===t&&null===r?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(t,16),this.y=new i(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function f(e,t,r,n){s.BasePoint.call(this,e,"jacobian"),null===t&&null===r&&null===n?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(t,16),this.y=new i(r,16),this.z=new i(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}o(u,s),e.exports=u,u.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,r;if(e.beta)t=new i(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=(t=n[0].cmp(n[1])<0?n[0]:n[1]).toRed(this.red)}if(e.lambda)r=new i(e.lambda,16);else{var o=this._getEndoRoots(this.n);0===this.g.mul(o[0]).x.cmp(this.g.x.redMul(t))?r=o[0]:(r=o[1],a(0===this.g.mul(r).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:r,basis:e.basis?e.basis.map((function(e){return{a:new i(e.a,16),b:new i(e.b,16)}})):this._getEndoBasis(r)}}},u.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:i.mont(e),r=new i(2).toRed(t).redInvm(),n=r.redNeg(),o=new i(3).toRed(t).redNeg().redSqrt().redMul(r);return[n.redAdd(o).fromRed(),n.redSub(o).fromRed()]},u.prototype._getEndoBasis=function(e){for(var t,r,n,o,s,a,u,c,f,l=this.n.ushrn(Math.floor(this.n.bitLength()/2)),h=e,d=this.n.clone(),p=new i(1),y=new i(0),b=new i(0),v=new i(1),g=0;0!==h.cmpn(0);){var m=d.div(h);c=d.sub(m.mul(h)),f=b.sub(m.mul(p));var w=v.sub(m.mul(y));if(!n&&c.cmp(l)<0)t=u.neg(),r=p,n=c.neg(),o=f;else if(n&&2==++g)break;u=c,d=h,h=c,b=p,p=f,v=y,y=w}s=c.neg(),a=f;var S=n.sqr().add(o.sqr());return s.sqr().add(a.sqr()).cmp(S)>=0&&(s=t,a=r),n.negative&&(n=n.neg(),o=o.neg()),s.negative&&(s=s.neg(),a=a.neg()),[{a:n,b:o},{a:s,b:a}]},u.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],n=t[1],i=n.b.mul(e).divRound(this.n),o=r.b.neg().mul(e).divRound(this.n),s=i.mul(r.a),a=o.mul(n.a),u=i.mul(r.b),c=o.mul(n.b);return{k1:e.sub(s).sub(a),k2:u.add(c).neg()}},u.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=r.redSqrt();if(0!==n.redSqr().redSub(r).cmp(this.zero))throw new Error("invalid point");var o=n.fromRed().isOdd();return(t&&!o||!t&&o)&&(n=n.redNeg()),this.point(e,n)},u.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,n=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return 0===r.redSqr().redISub(i).cmpn(0)},u.prototype._endoWnafMulAdd=function(e,t,r){for(var n=this._endoWnafT1,i=this._endoWnafT2,o=0;o<e.length;o++){var s=this._endoSplit(t[o]),a=e[o],u=a._getBeta();s.k1.negative&&(s.k1.ineg(),a=a.neg(!0)),s.k2.negative&&(s.k2.ineg(),u=u.neg(!0)),n[2*o]=a,n[2*o+1]=u,i[2*o]=s.k1,i[2*o+1]=s.k2}for(var c=this._wnafMulAdd(1,n,i,2*o,r),f=0;f<2*o;f++)n[f]=null,i[f]=null;return c},o(c,s.BasePoint),u.prototype.point=function(e,t,r){return new c(this,e,t,r)},u.prototype.pointFromJSON=function(e,t){return c.fromJSON(this,e,t)},c.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,n=function(e){return r.point(e.x.redMul(r.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}},c.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},c.fromJSON=function(e,t,r){"string"==typeof t&&(t=JSON.parse(t));var n=e.point(t[0],t[1],r);if(!t[2])return n;function i(t){return e.point(t[0],t[1],r)}var o=t[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(i))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(i))}},n},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.inf},c.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,n)},c.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),n=e.redInvm(),i=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(n),o=i.redSqr().redISub(this.x.redAdd(this.x)),s=i.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,s)},c.prototype.getX=function(){return this.x.fromRed()},c.prototype.getY=function(){return this.y.fromRed()},c.prototype.mul=function(e){return e=new i(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i):this.curve._wnafMulAdd(1,n,i,2)},c.prototype.jmulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i,!0):this.curve._wnafMulAdd(1,n,i,2,!0)},c.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},c.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,n=function(e){return e.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(n)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(n)}}}return t},c.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},o(f,s.BasePoint),u.prototype.jpoint=function(e,t,r){return new f(this,e,t,r)},f.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(r,n)},f.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},f.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),n=this.x.redMul(t),i=e.x.redMul(r),o=this.y.redMul(t.redMul(e.z)),s=e.y.redMul(r.redMul(this.z)),a=n.redSub(i),u=o.redSub(s);if(0===a.cmpn(0))return 0!==u.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=a.redSqr(),f=c.redMul(a),l=n.redMul(c),h=u.redSqr().redIAdd(f).redISub(l).redISub(l),d=u.redMul(l.redISub(h)).redISub(o.redMul(f)),p=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(h,d,p)},f.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,n=e.x.redMul(t),i=this.y,o=e.y.redMul(t).redMul(this.z),s=r.redSub(n),a=i.redSub(o);if(0===s.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var u=s.redSqr(),c=u.redMul(s),f=r.redMul(u),l=a.redSqr().redIAdd(c).redISub(f).redISub(f),h=a.redMul(f.redISub(l)).redISub(i.redMul(c)),d=this.z.redMul(s);return this.curve.jpoint(l,h,d)},f.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var r=this;for(t=0;t<e;t++)r=r.dbl();return r}var n=this.curve.a,i=this.curve.tinv,o=this.x,s=this.y,a=this.z,u=a.redSqr().redSqr(),c=s.redAdd(s);for(t=0;t<e;t++){var f=o.redSqr(),l=c.redSqr(),h=l.redSqr(),d=f.redAdd(f).redIAdd(f).redIAdd(n.redMul(u)),p=o.redMul(l),y=d.redSqr().redISub(p.redAdd(p)),b=p.redISub(y),v=d.redMul(b);v=v.redIAdd(v).redISub(h);var g=c.redMul(a);t+1<e&&(u=u.redMul(h)),o=y,a=g,c=v}return this.curve.jpoint(o,c.redMul(i),a)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},f.prototype._zeroDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),s=this.x.redAdd(i).redSqr().redISub(n).redISub(o);s=s.redIAdd(s);var a=n.redAdd(n).redIAdd(n),u=a.redSqr().redISub(s).redISub(s),c=o.redIAdd(o);c=(c=c.redIAdd(c)).redIAdd(c),e=u,t=a.redMul(s.redISub(u)).redISub(c),r=this.y.redAdd(this.y)}else{var f=this.x.redSqr(),l=this.y.redSqr(),h=l.redSqr(),d=this.x.redAdd(l).redSqr().redISub(f).redISub(h);d=d.redIAdd(d);var p=f.redAdd(f).redIAdd(f),y=p.redSqr(),b=h.redIAdd(h);b=(b=b.redIAdd(b)).redIAdd(b),e=y.redISub(d).redISub(d),t=p.redMul(d.redISub(e)).redISub(b),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(e,t,r)},f.prototype._threeDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),s=this.x.redAdd(i).redSqr().redISub(n).redISub(o);s=s.redIAdd(s);var a=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),u=a.redSqr().redISub(s).redISub(s);e=u;var c=o.redIAdd(o);c=(c=c.redIAdd(c)).redIAdd(c),t=a.redMul(s.redISub(u)).redISub(c),r=this.y.redAdd(this.y)}else{var f=this.z.redSqr(),l=this.y.redSqr(),h=this.x.redMul(l),d=this.x.redSub(f).redMul(this.x.redAdd(f));d=d.redAdd(d).redIAdd(d);var p=h.redIAdd(h),y=(p=p.redIAdd(p)).redAdd(p);e=d.redSqr().redISub(y),r=this.y.redAdd(this.z).redSqr().redISub(l).redISub(f);var b=l.redSqr();b=(b=(b=b.redIAdd(b)).redIAdd(b)).redIAdd(b),t=d.redMul(p.redISub(e)).redISub(b)}return this.curve.jpoint(e,t,r)},f.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,n=this.z,i=n.redSqr().redSqr(),o=t.redSqr(),s=r.redSqr(),a=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(i)),u=t.redAdd(t),c=(u=u.redIAdd(u)).redMul(s),f=a.redSqr().redISub(c.redAdd(c)),l=c.redISub(f),h=s.redSqr();h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var d=a.redMul(l).redISub(h),p=r.redAdd(r).redMul(n);return this.curve.jpoint(f,d,p)},f.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),n=t.redSqr(),i=e.redAdd(e).redIAdd(e),o=i.redSqr(),s=this.x.redAdd(t).redSqr().redISub(e).redISub(n),a=(s=(s=(s=s.redIAdd(s)).redAdd(s).redIAdd(s)).redISub(o)).redSqr(),u=n.redIAdd(n);u=(u=(u=u.redIAdd(u)).redIAdd(u)).redIAdd(u);var c=i.redIAdd(s).redSqr().redISub(o).redISub(a).redISub(u),f=t.redMul(c);f=(f=f.redIAdd(f)).redIAdd(f);var l=this.x.redMul(a).redISub(f);l=(l=l.redIAdd(l)).redIAdd(l);var h=this.y.redMul(c.redMul(u.redISub(c)).redISub(s.redMul(a)));h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var d=this.z.redAdd(s).redSqr().redISub(r).redISub(a);return this.curve.jpoint(l,h,d)},f.prototype.mul=function(e,t){return e=new i(e,t),this.curve._wnafMul(this,e)},f.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(0!==this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0))return!1;var n=t.redMul(this.z),i=r.redMul(e.z);return 0===this.y.redMul(i).redISub(e.y.redMul(n)).cmpn(0)},f.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(r))return!0;for(var n=e.clone(),i=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),0===this.x.cmp(r))return!0}},f.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},f.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},4234:(e,t,r)=>{"use strict";var n,i=t,o=r(4751),s=r(4956),a=r(7603).assert;function u(e){"short"===e.type?this.curve=new s.short(e):"edwards"===e.type?this.curve=new s.edwards(e):this.curve=new s.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function c(e,t){Object.defineProperty(i,e,{configurable:!0,enumerable:!0,get:function(){var r=new u(t);return Object.defineProperty(i,e,{configurable:!0,enumerable:!0,value:r}),r}})}i.PresetCurve=u,c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:o.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:o.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:o.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:o.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:o.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{n=r(4612)}catch(e){n=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:o.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",n]})},756:(e,t,r)=>{"use strict";var n=r(1172),i=r(5065),o=r(7603),s=r(4234),a=r(9456),u=o.assert,c=r(2378),f=r(3591);function l(e){if(!(this instanceof l))return new l(e);"string"==typeof e&&(u(Object.prototype.hasOwnProperty.call(s,e),"Unknown curve "+e),e=s[e]),e instanceof s.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=l,l.prototype.keyPair=function(e){return new c(this,e)},l.prototype.keyFromPrivate=function(e,t){return c.fromPrivate(this,e,t)},l.prototype.keyFromPublic=function(e,t){return c.fromPublic(this,e,t)},l.prototype.genKeyPair=function(e){e||(e={});for(var t=new i({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||a(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),o=this.n.sub(new n(2));;){var s=new n(t.generate(r));if(!(s.cmp(o)>0))return s.iaddn(1),this.keyFromPrivate(s)}},l.prototype._truncateToN=function(e,t){var r=8*e.byteLength()-this.n.bitLength();return r>0&&(e=e.ushrn(r)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},l.prototype.sign=function(e,t,r,o){"object"==typeof r&&(o=r,r=null),o||(o={}),t=this.keyFromPrivate(t,r),e=this._truncateToN(new n(e,16));for(var s=this.n.byteLength(),a=t.getPrivate().toArray("be",s),u=e.toArray("be",s),c=new i({hash:this.hash,entropy:a,nonce:u,pers:o.pers,persEnc:o.persEnc||"utf8"}),l=this.n.sub(new n(1)),h=0;;h++){var d=o.k?o.k(h):new n(c.generate(this.n.byteLength()));if(!((d=this._truncateToN(d,!0)).cmpn(1)<=0||d.cmp(l)>=0)){var p=this.g.mul(d);if(!p.isInfinity()){var y=p.getX(),b=y.umod(this.n);if(0!==b.cmpn(0)){var v=d.invm(this.n).mul(b.mul(t.getPrivate()).iadd(e));if(0!==(v=v.umod(this.n)).cmpn(0)){var g=(p.getY().isOdd()?1:0)|(0!==y.cmp(b)?2:0);return o.canonical&&v.cmp(this.nh)>0&&(v=this.n.sub(v),g^=1),new f({r:b,s:v,recoveryParam:g})}}}}}},l.prototype.verify=function(e,t,r,i){e=this._truncateToN(new n(e,16)),r=this.keyFromPublic(r,i);var o=(t=new f(t,"hex")).r,s=t.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;var a,u=s.invm(this.n),c=u.mul(e).umod(this.n),l=u.mul(o).umod(this.n);return this.curve._maxwellTrick?!(a=this.g.jmulAdd(c,r.getPublic(),l)).isInfinity()&&a.eqXToP(o):!(a=this.g.mulAdd(c,r.getPublic(),l)).isInfinity()&&0===a.getX().umod(this.n).cmp(o)},l.prototype.recoverPubKey=function(e,t,r,i){u((3&r)===r,"The recovery param is more than two bits"),t=new f(t,i);var o=this.n,s=new n(e),a=t.r,c=t.s,l=1&r,h=r>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&h)throw new Error("Unable to find sencond key candinate");a=h?this.curve.pointFromX(a.add(this.curve.n),l):this.curve.pointFromX(a,l);var d=t.r.invm(o),p=o.sub(s).mul(d).umod(o),y=c.mul(d).umod(o);return this.g.mulAdd(p,a,y)},l.prototype.getKeyRecoveryParam=function(e,t,r,n){if(null!==(t=new f(t,n)).recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var o;try{o=this.recoverPubKey(e,t,i)}catch(e){continue}if(o.eq(r))return i}throw new Error("Unable to find valid recovery factor")}},2378:(e,t,r)=>{"use strict";var n=r(1172),i=r(7603).assert;function o(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=o,o.fromPublic=function(e,t,r){return t instanceof o?t:new o(e,{pub:t,pubEnc:r})},o.fromPrivate=function(e,t,r){return t instanceof o?t:new o(e,{priv:t,privEnc:r})},o.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},o.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},o.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},o.prototype._importPrivate=function(e,t){this.priv=new n(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},o.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?i(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||i(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},o.prototype.derive=function(e){return e.validate()||i(e.validate(),"public point not validated"),e.mul(this.priv).getX()},o.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)},o.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},o.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},3591:(e,t,r)=>{"use strict";var n=r(1172),i=r(7603),o=i.assert;function s(e,t){if(e instanceof s)return e;this._importDER(e,t)||(o(e.r&&e.s,"Signature without r or s"),this.r=new n(e.r,16),this.s=new n(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function a(){this.place=0}function u(e,t){var r=e[t.place++];if(!(128&r))return r;var n=15&r;if(0===n||n>4)return!1;for(var i=0,o=0,s=t.place;o<n;o++,s++)i<<=8,i|=e[s],i>>>=0;return!(i<=127)&&(t.place=s,i)}function c(e){for(var t=0,r=e.length-1;!e[t]&&!(128&e[t+1])&&t<r;)t++;return 0===t?e:e.slice(t)}function f(e,t){if(t<128)e.push(t);else{var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|r);--r;)e.push(t>>>(r<<3)&255);e.push(t)}}e.exports=s,s.prototype._importDER=function(e,t){e=i.toArray(e,t);var r=new a;if(48!==e[r.place++])return!1;var o=u(e,r);if(!1===o)return!1;if(o+r.place!==e.length)return!1;if(2!==e[r.place++])return!1;var s=u(e,r);if(!1===s)return!1;var c=e.slice(r.place,s+r.place);if(r.place+=s,2!==e[r.place++])return!1;var f=u(e,r);if(!1===f)return!1;if(e.length!==f+r.place)return!1;var l=e.slice(r.place,f+r.place);if(0===c[0]){if(!(128&c[1]))return!1;c=c.slice(1)}if(0===l[0]){if(!(128&l[1]))return!1;l=l.slice(1)}return this.r=new n(c),this.s=new n(l),this.recoveryParam=null,!0},s.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&r[0]&&(r=[0].concat(r)),t=c(t),r=c(r);!(r[0]||128&r[1]);)r=r.slice(1);var n=[2];f(n,t.length),(n=n.concat(t)).push(2),f(n,r.length);var o=n.concat(r),s=[48];return f(s,o.length),s=s.concat(o),i.encode(s,e)}},5036:(e,t,r)=>{"use strict";var n=r(4751),i=r(4234),o=r(7603),s=o.assert,a=o.parseBytes,u=r(5361),c=r(5821);function f(e){if(s("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof f))return new f(e);e=i[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=n.sha512}e.exports=f,f.prototype.sign=function(e,t){e=a(e);var r=this.keyFromSecret(t),n=this.hashInt(r.messagePrefix(),e),i=this.g.mul(n),o=this.encodePoint(i),s=this.hashInt(o,r.pubBytes(),e).mul(r.priv()),u=n.add(s).umod(this.curve.n);return this.makeSignature({R:i,S:u,Rencoded:o})},f.prototype.verify=function(e,t,r){e=a(e),t=this.makeSignature(t);var n=this.keyFromPublic(r),i=this.hashInt(t.Rencoded(),n.pubBytes(),e),o=this.g.mul(t.S());return t.R().add(n.pub().mul(i)).eq(o)},f.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return o.intFromLE(e.digest()).umod(this.curve.n)},f.prototype.keyFromPublic=function(e){return u.fromPublic(this,e)},f.prototype.keyFromSecret=function(e){return u.fromSecret(this,e)},f.prototype.makeSignature=function(e){return e instanceof c?e:new c(this,e)},f.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},f.prototype.decodePoint=function(e){var t=(e=o.parseBytes(e)).length-1,r=e.slice(0,t).concat(-129&e[t]),n=!!(128&e[t]),i=o.intFromLE(r);return this.curve.pointFromY(i,n)},f.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},f.prototype.decodeInt=function(e){return o.intFromLE(e)},f.prototype.isPoint=function(e){return e instanceof this.pointClass}},5361:(e,t,r)=>{"use strict";var n=r(7603),i=n.assert,o=n.parseBytes,s=n.cachedProperty;function a(e,t){this.eddsa=e,this._secret=o(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=o(t.pub)}a.fromPublic=function(e,t){return t instanceof a?t:new a(e,{pub:t})},a.fromSecret=function(e,t){return t instanceof a?t:new a(e,{secret:t})},a.prototype.secret=function(){return this._secret},s(a,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),s(a,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),s(a,"privBytes",(function(){var e=this.eddsa,t=this.hash(),r=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[r]&=127,n[r]|=64,n})),s(a,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),s(a,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),s(a,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),a.prototype.sign=function(e){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},a.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},a.prototype.getSecret=function(e){return i(this._secret,"KeyPair is public only"),n.encode(this.secret(),e)},a.prototype.getPublic=function(e){return n.encode(this.pubBytes(),e)},e.exports=a},5821:(e,t,r)=>{"use strict";var n=r(1172),i=r(7603),o=i.assert,s=i.cachedProperty,a=i.parseBytes;function u(e,t){this.eddsa=e,"object"!=typeof t&&(t=a(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),o(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof n&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}s(u,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),s(u,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),s(u,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),s(u,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),u.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},u.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},e.exports=u},4612:e=>{e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},7603:(e,t,r)=>{"use strict";var n=t,i=r(1172),o=r(6111),s=r(179);n.assert=o,n.toArray=s.toArray,n.zero2=s.zero2,n.toHex=s.toHex,n.encode=s.encode,n.getNAF=function(e,t,r){var n,i=new Array(Math.max(e.bitLength(),r)+1);for(n=0;n<i.length;n+=1)i[n]=0;var o=1<<t+1,s=e.clone();for(n=0;n<i.length;n++){var a,u=s.andln(o-1);s.isOdd()?(a=u>(o>>1)-1?(o>>1)-u:u,s.isubn(a)):a=0,i[n]=a,s.iushrn(1)}return i},n.getJSF=function(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n,i=0,o=0;e.cmpn(-i)>0||t.cmpn(-o)>0;){var s,a,u=e.andln(3)+i&3,c=t.andln(3)+o&3;3===u&&(u=-1),3===c&&(c=-1),s=1&u?3!=(n=e.andln(7)+i&7)&&5!==n||2!==c?u:-u:0,r[0].push(s),a=1&c?3!=(n=t.andln(7)+o&7)&&5!==n||2!==u?c:-c:0,r[1].push(a),2*i===s+1&&(i=1-i),2*o===a+1&&(o=1-o),e.iushrn(1),t.iushrn(1)}return r},n.cachedProperty=function(e,t,r){var n="_"+t;e.prototype[t]=function(){return void 0!==this[n]?this[n]:this[n]=r.call(this)}},n.parseBytes=function(e){return"string"==typeof e?n.toArray(e,"hex"):e},n.intFromLE=function(e){return new i(e,"hex","le")}},4751:(e,t,r)=>{var n=t;n.utils=r(2582),n.common=r(5567),n.sha=r(9306),n.ripemd=r(8498),n.hmac=r(3101),n.sha1=n.sha.sha1,n.sha256=n.sha.sha256,n.sha224=n.sha.sha224,n.sha384=n.sha.sha384,n.sha512=n.sha.sha512,n.ripemd160=n.ripemd.ripemd160},5567:(e,t,r)=>{"use strict";var n=r(2582),i=r(6111);function o(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=o,o.prototype.update=function(e,t){if(e=n.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var r=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-r,e.length),0===this.pending.length&&(this.pending=null),e=n.join32(e,0,e.length-r,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},o.prototype.digest=function(e){return this.update(this._pad()),i(null===this.pending),this._digest(e)},o.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,n=new Array(r+this.padLength);n[0]=128;for(var i=1;i<r;i++)n[i]=0;if(e<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)n[i++]=0;n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=e>>>24&255,n[i++]=e>>>16&255,n[i++]=e>>>8&255,n[i++]=255&e}else for(n[i++]=255&e,n[i++]=e>>>8&255,n[i++]=e>>>16&255,n[i++]=e>>>24&255,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,o=8;o<this.padLength;o++)n[i++]=0;return n}},3101:(e,t,r)=>{"use strict";var n=r(2582),i=r(6111);function o(e,t,r){if(!(this instanceof o))return new o(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(t,r))}e.exports=o,o.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},o.prototype.update=function(e,t){return this.inner.update(e,t),this},o.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},8498:(e,t,r)=>{"use strict";var n=r(2582),i=r(5567),o=n.rotl32,s=n.sum32,a=n.sum32_3,u=n.sum32_4,c=i.BlockHash;function f(){if(!(this instanceof f))return new f;c.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function l(e,t,r,n){return e<=15?t^r^n:e<=31?t&r|~t&n:e<=47?(t|~r)^n:e<=63?t&n|r&~n:t^(r|~n)}function h(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function d(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}n.inherits(f,c),t.ripemd160=f,f.blockSize=512,f.outSize=160,f.hmacStrength=192,f.padLength=64,f.prototype._update=function(e,t){for(var r=this.h[0],n=this.h[1],i=this.h[2],c=this.h[3],f=this.h[4],g=r,m=n,w=i,S=c,A=f,_=0;_<80;_++){var M=s(o(u(r,l(_,n,i,c),e[p[_]+t],h(_)),b[_]),f);r=f,f=c,c=o(i,10),i=n,n=M,M=s(o(u(g,l(79-_,m,w,S),e[y[_]+t],d(_)),v[_]),A),g=A,A=S,S=o(w,10),w=m,m=M}M=a(this.h[1],i,S),this.h[1]=a(this.h[2],c,A),this.h[2]=a(this.h[3],f,g),this.h[3]=a(this.h[4],r,m),this.h[4]=a(this.h[0],n,w),this.h[0]=M},f.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"little"):n.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],y=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],b=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],v=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},9306:(e,t,r)=>{"use strict";t.sha1=r(8598),t.sha224=r(7070),t.sha256=r(4373),t.sha384=r(1744),t.sha512=r(3708)},8598:(e,t,r)=>{"use strict";var n=r(2582),i=r(5567),o=r(8474),s=n.rotl32,a=n.sum32,u=n.sum32_5,c=o.ft_1,f=i.BlockHash,l=[1518500249,1859775393,2400959708,3395469782];function h(){if(!(this instanceof h))return new h;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}n.inherits(h,f),e.exports=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=s(r[n-3]^r[n-8]^r[n-14]^r[n-16],1);var i=this.h[0],o=this.h[1],f=this.h[2],h=this.h[3],d=this.h[4];for(n=0;n<r.length;n++){var p=~~(n/20),y=u(s(i,5),c(p,o,f,h),d,r[n],l[p]);d=h,h=f,f=s(o,30),o=i,i=y}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],o),this.h[2]=a(this.h[2],f),this.h[3]=a(this.h[3],h),this.h[4]=a(this.h[4],d)},h.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},7070:(e,t,r)=>{"use strict";var n=r(2582),i=r(4373);function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}n.inherits(o,i),e.exports=o,o.blockSize=512,o.outSize=224,o.hmacStrength=192,o.padLength=64,o.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")}},4373:(e,t,r)=>{"use strict";var n=r(2582),i=r(5567),o=r(8474),s=r(6111),a=n.sum32,u=n.sum32_4,c=n.sum32_5,f=o.ch32,l=o.maj32,h=o.s0_256,d=o.s1_256,p=o.g0_256,y=o.g1_256,b=i.BlockHash,v=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function g(){if(!(this instanceof g))return new g;b.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=v,this.W=new Array(64)}n.inherits(g,b),e.exports=g,g.blockSize=512,g.outSize=256,g.hmacStrength=192,g.padLength=64,g.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=u(y(r[n-2]),r[n-7],p(r[n-15]),r[n-16]);var i=this.h[0],o=this.h[1],b=this.h[2],v=this.h[3],g=this.h[4],m=this.h[5],w=this.h[6],S=this.h[7];for(s(this.k.length===r.length),n=0;n<r.length;n++){var A=c(S,d(g),f(g,m,w),this.k[n],r[n]),_=a(h(i),l(i,o,b));S=w,w=m,m=g,g=a(v,A),v=b,b=o,o=i,i=a(A,_)}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],o),this.h[2]=a(this.h[2],b),this.h[3]=a(this.h[3],v),this.h[4]=a(this.h[4],g),this.h[5]=a(this.h[5],m),this.h[6]=a(this.h[6],w),this.h[7]=a(this.h[7],S)},g.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},1744:(e,t,r)=>{"use strict";var n=r(2582),i=r(3708);function o(){if(!(this instanceof o))return new o;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}n.inherits(o,i),e.exports=o,o.blockSize=1024,o.outSize=384,o.hmacStrength=192,o.padLength=128,o.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")}},3708:(e,t,r)=>{"use strict";var n=r(2582),i=r(5567),o=r(6111),s=n.rotr64_hi,a=n.rotr64_lo,u=n.shr64_hi,c=n.shr64_lo,f=n.sum64,l=n.sum64_hi,h=n.sum64_lo,d=n.sum64_4_hi,p=n.sum64_4_lo,y=n.sum64_5_hi,b=n.sum64_5_lo,v=i.BlockHash,g=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function m(){if(!(this instanceof m))return new m;v.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=g,this.W=new Array(160)}function w(e,t,r,n,i){var o=e&r^~e&i;return o<0&&(o+=4294967296),o}function S(e,t,r,n,i,o){var s=t&n^~t&o;return s<0&&(s+=4294967296),s}function A(e,t,r,n,i){var o=e&r^e&i^r&i;return o<0&&(o+=4294967296),o}function _(e,t,r,n,i,o){var s=t&n^t&o^n&o;return s<0&&(s+=4294967296),s}function M(e,t){var r=s(e,t,28)^s(t,e,2)^s(t,e,7);return r<0&&(r+=4294967296),r}function k(e,t){var r=a(e,t,28)^a(t,e,2)^a(t,e,7);return r<0&&(r+=4294967296),r}function x(e,t){var r=a(e,t,14)^a(e,t,18)^a(t,e,9);return r<0&&(r+=4294967296),r}function E(e,t){var r=s(e,t,1)^s(e,t,8)^u(e,t,7);return r<0&&(r+=4294967296),r}function B(e,t){var r=a(e,t,1)^a(e,t,8)^c(e,t,7);return r<0&&(r+=4294967296),r}function O(e,t){var r=a(e,t,19)^a(t,e,29)^c(e,t,6);return r<0&&(r+=4294967296),r}n.inherits(m,v),e.exports=m,m.blockSize=1024,m.outSize=512,m.hmacStrength=192,m.padLength=128,m.prototype._prepareBlock=function(e,t){for(var r=this.W,n=0;n<32;n++)r[n]=e[t+n];for(;n<r.length;n+=2){var i=(b=r[n-4],v=r[n-3],g=void 0,(g=s(b,v,19)^s(v,b,29)^u(b,v,6))<0&&(g+=4294967296),g),o=O(r[n-4],r[n-3]),a=r[n-14],c=r[n-13],f=E(r[n-30],r[n-29]),l=B(r[n-30],r[n-29]),h=r[n-32],y=r[n-31];r[n]=d(i,o,a,c,f,l,h,y),r[n+1]=p(i,o,a,c,f,l,h,y)}var b,v,g},m.prototype._update=function(e,t){this._prepareBlock(e,t);var r,n,i,a=this.W,u=this.h[0],c=this.h[1],d=this.h[2],p=this.h[3],v=this.h[4],g=this.h[5],m=this.h[6],E=this.h[7],B=this.h[8],O=this.h[9],j=this.h[10],I=this.h[11],P=this.h[12],C=this.h[13],N=this.h[14],U=this.h[15];o(this.k.length===a.length);for(var T=0;T<a.length;T+=2){var R=N,D=U,K=(i=void 0,(i=s(r=B,n=O,14)^s(r,n,18)^s(n,r,9))<0&&(i+=4294967296),i),L=x(B,O),z=w(B,0,j,0,P),H=S(0,O,0,I,0,C),q=this.k[T],F=this.k[T+1],V=a[T],$=a[T+1],J=y(R,D,K,L,z,H,q,F,V,$),W=b(R,D,K,L,z,H,q,F,V,$);R=M(u,c),D=k(u,c),K=A(u,0,d,0,v),L=_(0,c,0,p,0,g);var G=l(R,D,K,L),Z=h(R,D,K,L);N=P,U=C,P=j,C=I,j=B,I=O,B=l(m,E,J,W),O=h(E,E,J,W),m=v,E=g,v=d,g=p,d=u,p=c,u=l(J,W,G,Z),c=h(J,W,G,Z)}f(this.h,0,u,c),f(this.h,2,d,p),f(this.h,4,v,g),f(this.h,6,m,E),f(this.h,8,B,O),f(this.h,10,j,I),f(this.h,12,P,C),f(this.h,14,N,U)},m.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},8474:(e,t,r)=>{"use strict";var n=r(2582).rotr32;function i(e,t,r){return e&t^~e&r}function o(e,t,r){return e&t^e&r^t&r}function s(e,t,r){return e^t^r}t.ft_1=function(e,t,r,n){return 0===e?i(t,r,n):1===e||3===e?s(t,r,n):2===e?o(t,r,n):void 0},t.ch32=i,t.maj32=o,t.p32=s,t.s0_256=function(e){return n(e,2)^n(e,13)^n(e,22)},t.s1_256=function(e){return n(e,6)^n(e,11)^n(e,25)},t.g0_256=function(e){return n(e,7)^n(e,18)^e>>>3},t.g1_256=function(e){return n(e,17)^n(e,19)^e>>>10}},2582:(e,t,r)=>{"use strict";var n=r(6111),i=r(2937);function o(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function s(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function a(e){return 1===e.length?"0"+e:e}function u(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=i,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16))}else for(var n=0,i=0;i<e.length;i++){var s=e.charCodeAt(i);s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=63&s|128):o(e,i)?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++i)),r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=63&s|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=63&s|128)}else for(i=0;i<e.length;i++)r[i]=0|e[i];return r},t.toHex=function(e){for(var t="",r=0;r<e.length;r++)t+=a(e[r].toString(16));return t},t.htonl=s,t.toHex32=function(e,t){for(var r="",n=0;n<e.length;n++){var i=e[n];"little"===t&&(i=s(i)),r+=u(i.toString(16))}return r},t.zero2=a,t.zero8=u,t.join32=function(e,t,r,i){var o=r-t;n(o%4==0);for(var s=new Array(o/4),a=0,u=t;a<s.length;a++,u+=4){var c;c="big"===i?e[u]<<24|e[u+1]<<16|e[u+2]<<8|e[u+3]:e[u+3]<<24|e[u+2]<<16|e[u+1]<<8|e[u],s[a]=c>>>0}return s},t.split32=function(e,t){for(var r=new Array(4*e.length),n=0,i=0;n<e.length;n++,i+=4){var o=e[n];"big"===t?(r[i]=o>>>24,r[i+1]=o>>>16&255,r[i+2]=o>>>8&255,r[i+3]=255&o):(r[i+3]=o>>>24,r[i+2]=o>>>16&255,r[i+1]=o>>>8&255,r[i]=255&o)}return r},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,r){return e+t+r>>>0},t.sum32_4=function(e,t,r,n){return e+t+r+n>>>0},t.sum32_5=function(e,t,r,n,i){return e+t+r+n+i>>>0},t.sum64=function(e,t,r,n){var i=e[t],o=n+e[t+1]>>>0,s=(o<n?1:0)+r+i;e[t]=s>>>0,e[t+1]=o},t.sum64_hi=function(e,t,r,n){return(t+n>>>0<t?1:0)+e+r>>>0},t.sum64_lo=function(e,t,r,n){return t+n>>>0},t.sum64_4_hi=function(e,t,r,n,i,o,s,a){var u=0,c=t;return u+=(c=c+n>>>0)<t?1:0,u+=(c=c+o>>>0)<o?1:0,e+r+i+s+(u+=(c=c+a>>>0)<a?1:0)>>>0},t.sum64_4_lo=function(e,t,r,n,i,o,s,a){return t+n+o+a>>>0},t.sum64_5_hi=function(e,t,r,n,i,o,s,a,u,c){var f=0,l=t;return f+=(l=l+n>>>0)<t?1:0,f+=(l=l+o>>>0)<o?1:0,f+=(l=l+a>>>0)<a?1:0,e+r+i+s+u+(f+=(l=l+c>>>0)<c?1:0)>>>0},t.sum64_5_lo=function(e,t,r,n,i,o,s,a,u,c){return t+n+o+a+c>>>0},t.rotr64_hi=function(e,t,r){return(t<<32-r|e>>>r)>>>0},t.rotr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0},t.shr64_hi=function(e,t,r){return e>>>r},t.shr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0}},5065:(e,t,r)=>{"use strict";var n=r(4751),i=r(179),o=r(6111);function s(e){if(!(this instanceof s))return new s(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=i.toArray(e.entropy,e.entropyEnc||"hex"),r=i.toArray(e.nonce,e.nonceEnc||"hex"),n=i.toArray(e.pers,e.persEnc||"hex");o(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,n)}e.exports=s,s.prototype._init=function(e,t,r){var n=e.concat(t).concat(r);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},s.prototype._hmac=function(){return new n.hmac(this.hash,this.K)},s.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},s.prototype.reseed=function(e,t,r,n){"string"!=typeof t&&(n=r,r=t,t=null),e=i.toArray(e,t),r=i.toArray(r,n),o(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1},s.prototype.generate=function(e,t,r,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(n=r,r=t,t=null),r&&(r=i.toArray(r,n||"hex"),this._update(r));for(var o=[];o.length<e;)this.V=this._hmac().update(this.V).digest(),o=o.concat(this.V);var s=o.slice(0,e);return this._update(r),this._reseed++,i.encode(s,t)}},551:(e,t)=>{t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,c=u>>1,f=-7,l=r?i-1:0,h=r?-1:1,d=e[t+l];for(l+=h,o=d&(1<<-f)-1,d>>=-f,f+=a;f>0;o=256*o+e[t+l],l+=h,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=n;f>0;s=256*s+e[t+l],l+=h,f-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),o-=c}return(d?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,u,c=8*o-i-1,f=(1<<c)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+l>=1?h/u:h*Math.pow(2,1-l))*u>=2&&(s++,u/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(t*u-1)*Math.pow(2,i),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;e[r+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+d]=255&s,d+=p,s/=256,c-=8);e[r+d-p]|=128*y}},2937:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},6842:function(e){!function(t){"use strict";const r="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp(`^${r}\\.${r}\\.${r}\\.${r}$`,"i"),threeOctet:new RegExp(`^${r}\\.${r}\\.${r}$`,"i"),twoOctet:new RegExp(`^${r}\\.${r}$`,"i"),longValue:new RegExp(`^${r}$`,"i")},i=new RegExp("^0[0-7]+$","i"),o=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",a="(?:[0-9a-f]+::?)+",u={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${a})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${r}\\.${r}\\.${r}\\.${r}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${a})|(?:::)(?:${a})?)${r}\\.${r}\\.${r}\\.${r}(${s})?$`,"i")};function c(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let r,n,i=0,o=-1,s=(e.match(u.zoneIndex)||[])[0];for(s&&(s=s.substring(1),e=e.replace(/%.+$/,""));(o=e.indexOf(":",o+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(n=t-i,r=":";n--;)r+="0:";return":"===(e=e.replace("::",r))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),r=[];for(let e=0;e<t.length;e++)r.push(parseInt(t[e],16));return r}(),zoneId:s}}function f(e,t,r,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,o=0;for(;n>0;){if(i=r-n,i<0&&(i=0),e[o]>>i!=t[o]>>i)return!1;n-=r,o+=1}return!0}function l(e){if(o.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function h(e,t){for(;e.length<t;)e=`0${e}`;return e}const d={};d.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,r;for(t=0;t<e.length;t++)if(r=e[t],!(0<=r&&r<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,18,0,0]),15],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]],as112:[[new e([192,175,48,0]),24],[new e([192,31,196,0]),24]],amt:[[new e([192,52,193,0]),24]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return f(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,i,o;for(n=3;n>=0;n-=1){if(i=this.octets[n],!(i in r))return null;if(o=r[i],t&&0!==o)return null;8!==o&&(t=!0),e+=o}return 32-e},e.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return d.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),d.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let o=0;for(;o<4;)i.push(parseInt(r[o],10)|255^parseInt(n[o],10)),o++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.isIPv4=function(e){return null!==this.parser(e)},d.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},d.IPv4.isValidCIDR=function(e){try{return this.parseCIDR(e),!0}catch(e){return!1}},d.IPv4.isValidFourPartDecimal=function(e){return!(!d.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},d.IPv4.networkAddressFromCIDR=function(e){let t,r,n,i,o;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),o=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],r=0;r<4;)i.push(parseInt(n[r],10)&parseInt(o[r],10)),r++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},d.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const r=[this.parse(t[1]),e];return Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},d.IPv4.parser=function(e){let t,r,i;if(t=e.match(n.fourOctet))return function(){const e=t.slice(1,6),n=[];for(let t=0;t<e.length;t++)r=e[t],n.push(l(r));return n}();if(t=e.match(n.longValue)){if(i=l(t[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(n.twoOctet))?function(){const e=t.slice(1,4),r=[];if(i=l(e[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return r.push(l(e[0])),r.push(i>>16&255),r.push(i>>8&255),r.push(255&i),r}():(t=e.match(n.threeOctet))?function(){const e=t.slice(1,5),r=[];if(i=l(e[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return r.push(l(e[0])),r.push(l(e[1])),r.push(i>>8&255),r.push(255&i),r}():null},d.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let r=0;const n=Math.floor(e/8);for(;r<n;)t[r]=255,r++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},d.IPv6=function(){function e(e,t){let r,n;if(16===e.length)for(this.parts=[],r=0;r<=14;r+=2)this.parts.push(e[r]<<8|e[r+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(r=0;r<this.parts.length;r++)if(n=this.parts[r],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],discard:[new e([256,0,0,0,0,0,0,0]),64],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],benchmarking:[new e([8193,2,0,0,0,0,0,0]),48],amt:[new e([8193,3,0,0,0,0,0,0]),32],as112v6:[[new e([8193,4,274,0,0,0,0,0]),48],[new e([9760,79,32768,0,0,0,0,0]),48]],deprecated:[new e([8193,16,0,0,0,0,0,0]),28],orchid2:[new e([8193,32,0,0,0,0,0,0]),28],droneRemoteIdProtocolEntityTags:[new e([8193,48,0,0,0,0,0,0]),28],reserved:[[new e([8193,0,0,0,0,0,0,0]),23],[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return f(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,i;for(let o=7;o>=0;o-=1){if(n=this.parts[o],!(n in r))return null;if(i=r[n],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],r=this.parts;for(let n=0;n<r.length;n++)e=r[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(h(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],r=e[1];return new d.IPv4([t>>8,255&t,r>>8,255&r])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let r,n=0,i=-1;for(;r=e.exec(t);)r[0].length>i&&(n=r.index,i=r[0].length);return i<0?t:`${t.substring(0,n)}::${t.substring(n+i)}`},e.prototype.toString=function(){return this.toRFC5952String()},e}(),d.IPv6.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let o=0;for(;o<16;)i.push(parseInt(r[o],10)|255^parseInt(n[o],10)),o++;return new this(i)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},d.IPv6.isIPv6=function(e){return null!==this.parser(e)},d.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},d.IPv6.isValidCIDR=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{return this.parseCIDR(e),!0}catch(e){return!1}},d.IPv6.networkAddressFromCIDR=function(e){let t,r,n,i,o;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),o=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],r=0;r<16;)i.push(parseInt(n[r],10)&parseInt(o[r],10)),r++;return new this(i)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},d.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},d.IPv6.parseCIDR=function(e){let t,r,n;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]),t>=0&&t<=128))return n=[this.parse(r[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},d.IPv6.parser=function(e){let t,r,n,i,o,s;if(n=e.match(u.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(u.native.test(e))return c(e,8);if((n=e.match(u.transitional))&&(s=n[6]||"",t=n[1],n[1].endsWith("::")||(t=t.slice(0,-1)),t=c(t+s,6),t.parts)){for(o=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],r=0;r<o.length;r++)if(i=o[r],!(0<=i&&i<=255))return null;return t.parts.push(o[0]<<8|o[1]),t.parts.push(o[2]<<8|o[3]),{parts:t.parts,zoneId:t.zoneId}}return null},d.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw new Error("ipaddr: invalid IPv6 prefix length");const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let r=0;const n=Math.floor(e/8);for(;r<n;)t[r]=255,r++;return n<16&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},d.fromByteArray=function(e){const t=e.length;if(4===t)return new d.IPv4(e);if(16===t)return new d.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},d.isValid=function(e){return d.IPv6.isValid(e)||d.IPv4.isValid(e)},d.isValidCIDR=function(e){return d.IPv6.isValidCIDR(e)||d.IPv4.isValidCIDR(e)},d.parse=function(e){if(d.IPv6.isValid(e))return d.IPv6.parse(e);if(d.IPv4.isValid(e))return d.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},d.parseCIDR=function(e){try{return d.IPv6.parseCIDR(e)}catch(t){try{return d.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},d.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},d.subnetMatch=function(e,t,r){let n,i,o,s;for(i in null==r&&(r="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(o=t[i],!o[0]||o[0]instanceof Array||(o=[o]),n=0;n<o.length;n++)if(s=o[n],e.kind()===s[0].kind()&&e.match.apply(e,s))return i;return r},e.exports?e.exports=d:t.ipaddr=d}(this)},3149:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},8849:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.unwrapKey=t.wrapKey=t.decrypt=t.encrypt=void 0;var c=o(r(6852)),f=o(r(8110)),l=o(r(598)),h=u(r(1800)),d=function(e){var t=e.name,r=e.iv,n=e.tagLength;if(h.default.ciphers[t].ivLength){if(!(r instanceof Uint8Array))throw new Error("InvalidArguments");if(r.byteLength<2||r.byteLength>16)throw new Error("InvalidIVLength");if(h.default.ciphers[t].staticIvLength&&h.default.ciphers[t].ivLength!==r.byteLength)throw new Error("InvalidIVLength")}if(h.default.ciphers[t].tagLength&&n){if(!Number.isInteger(n))throw new Error("InvalidArguments");if(n<4||n>16)throw new Error("InvalidTagLength")}};t.encrypt=function(e,t,r){var n=r.name,i=void 0===n?"AES-GCM":n,o=r.iv,u=r.additionalData,p=void 0===u?new Uint8Array([]):u,y=r.tagLength;return s(void 0,void 0,void 0,(function(){var r;return a(this,(function(n){if(d({name:i,iv:o,tagLength:y}),h.default.ciphers[i].tagLength&&!y&&(y=h.default.ciphers[i].tagLength),"webCrypto"===(r=c.getCrypto()).name){if("function"!=typeof r.crypto.importKey||"function"!=typeof r.crypto.encrypt)throw new Error("UnsupportedWebCrypto");return[2,l.encrypt(e,t,{name:i,iv:o,additionalData:p,tagLength:y},r.crypto)]}if("nodeCrypto"===r.name)return[2,f.encrypt(e,t,{name:i,iv:o,additionalData:p,tagLength:y},r.crypto)];throw new Error("UnsupportedEnvironment")}))}))},t.decrypt=function(e,t,r){var n=r.name,i=void 0===n?"AES-GCM":n,o=r.iv,u=r.additionalData,p=void 0===u?new Uint8Array([]):u,y=r.tagLength;return s(void 0,void 0,void 0,(function(){var r;return a(this,(function(n){if(d({name:i,iv:o,tagLength:y}),h.default.ciphers[i].tagLength&&!y&&(y=h.default.ciphers[i].tagLength),"webCrypto"===(r=c.getCrypto()).name){if("function"!=typeof r.crypto.importKey||"function"!=typeof r.crypto.decrypt)throw new Error("UnsupportedWebCrypto");return[2,l.decrypt(e,t,{name:i,iv:o,additionalData:p,tagLength:y},r.crypto)]}if("nodeCrypto"===r.name)return[2,f.decrypt(e,t,{name:i,iv:o,additionalData:p,tagLength:y},r.crypto)];throw new Error("UnsupportedEnvironment")}))}))},t.wrapKey=function(e,t,r){var n=r.name;return s(void 0,void 0,void 0,(function(){var r,i;return a(this,(function(o){if(e.length%8>0)throw new Error("WrappedKeyMustBeMultipleOf8");if(r=c.getCrypto(),i=h.default.wrapKeys["AES-KW"].defaultIv,"webCrypto"===r.name){if("function"!=typeof r.crypto.importKey||"function"!=typeof r.crypto.wrapKey)throw new Error("UnsupportedWebCrypto");return[2,l.wrapKey(e,t,{name:n,iv:i},r.crypto)]}if("nodeCrypto"===r.name)return[2,f.wrapKey(e,t,{name:n,iv:i},r.crypto)];throw new Error("UnsupportedEnvironment")}))}))},t.unwrapKey=function(e,t,r){var n=r.name;return s(void 0,void 0,void 0,(function(){var r,i;return a(this,(function(o){if(r=c.getCrypto(),i=h.default.wrapKeys["AES-KW"].defaultIv,"webCrypto"===r.name){if("function"!=typeof r.crypto.importKey||"function"!=typeof r.crypto.unwrapKey)throw new Error("UnsupportedWebCrypto");return[2,l.unwrapKey(e,t,{name:n,iv:i},r.crypto)]}if("nodeCrypto"===r.name)return[2,f.unwrapKey(e,t,{name:n,iv:i},r.crypto)];throw new Error("UnsupportedEnvironment")}))}))}},8683:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.unwrapKey=t.wrapKey=t.decrypt=t.encrypt=void 0;var s=o(r(8849));t.encrypt=s.encrypt,t.decrypt=s.decrypt,t.wrapKey=s.wrapKey,t.unwrapKey=s.unwrapKey,t.default={encrypt:t.encrypt,decrypt:t.decrypt,wrapKey:t.wrapKey,unwrapKey:t.unwrapKey}},8110:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=t.unwrapKey=t.wrapKey=void 0;var i=n(r(1800));t.wrapKey=function(e,r,n,i){var o=n.name,s=n.iv;return(0,t.encrypt)(e,r,{name:o,iv:s},i,!0)},t.unwrapKey=function(e,r,n,i){var o=n.name,s=n.iv;return(0,t.decrypt)(e,r,{name:o,iv:s},i,!0)},t.encrypt=function(e,t,r,n,s){var a=r.name,u=r.iv,c=r.additionalData,f=r.tagLength;void 0===s&&(s=!1);var l,h,d,p,y=o(a,t.byteLength,s?i.default.wrapKeys:i.default.ciphers);switch(a){case"AES-GCM":(l=n.createCipheriv(y,t,u,{authTagLength:f})).setAAD(c);break;case"AES-CTR":if(0===u.length||u.length>16)throw new Error("InvalidIVLength");var b=new Uint8Array(16);b.set(u),b[15]+=1,l=n.createCipheriv(y,t,b);break;default:l=n.createCipheriv(y,t,u)}try{h=new Uint8Array(l.update(e)),d=new Uint8Array(l.final()),p=new Uint8Array([]),"AES-GCM"===a&&(p=new Uint8Array(l.getAuthTag()))}catch(e){throw new Error("NodeCrypto_EncryptionFailure")}var v=new Uint8Array(h.length+d.length+p.length);return v.set(h),v.set(d,h.length),v.set(p,h.length+d.length),v},t.decrypt=function(e,t,r,n,s){var a=r.name,u=r.iv,c=r.additionalData,f=r.tagLength;void 0===s&&(s=!1);var l,h,d,p,y=o(a,t.byteLength,s?i.default.wrapKeys:i.default.ciphers);switch(a){case"AES-GCM":(l=n.createDecipheriv(y,t,u,{authTagLength:f})).setAAD(c),h=e.slice(0,e.length-f);var b=e.slice(e.length-f);l.setAuthTag(b);break;case"AES-CTR":if(0===u.length||u.length>16)throw new Error("InvalidIVLength");var v=new Uint8Array(16);v.set(u),v[15]+=1,l=n.createDecipheriv(y,t,v),h=e;break;default:l=n.createDecipheriv(y,t,u),h=e}try{d=l.update(h),p=l.final()}catch(e){throw new Error("NodeCrypto_DecryptionFailure")}var g=new Uint8Array(p.length+d.length);return g.set(d),g.set(p,d.length),g};var o=function(e,t,r){var n=r[e].nodePrefix;return(n="".concat(n).concat((8*t).toString()))+r[e].nodeSuffix}},1800:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={"AES-KW":{nodePrefix:"id-aes",nodeSuffix:"-wrap",ivLength:8,staticIvLength:!0,defaultIv:new Uint8Array([166,166,166,166,166,166,166,166])}};t.default={ciphers:{"AES-GCM":{nodePrefix:"aes-",nodeSuffix:"-gcm",ivLength:12,tagLength:16,staticIvLength:!0},"AES-CBC":{nodePrefix:"aes-",nodeSuffix:"-cbc",ivLength:16,staticIvLength:!0},"AES-CTR":{nodePrefix:"aes-",nodeSuffix:"-ctr",ivLength:12,staticIvLength:!1}},wrapKeys:r}},598:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=t.unwrapKey=t.wrapKey=void 0,t.wrapKey=function(e,t,i,o){var s=i.name,a=i.iv;return r(void 0,void 0,void 0,(function(){var r,i,u,c;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,o.importKey("raw",t,{name:s},!1,["wrapKey","unwrapKey"])];case 1:return r=n.sent(),[4,o.importKey("raw",e,{name:s},!0,["wrapKey","unwrapKey"])];case 2:return i=n.sent(),[4,o.wrapKey("raw",i,r,{name:s,iv:a})];case 3:return u=n.sent(),[2,new Uint8Array(u)];case 4:throw(c=n.sent())instanceof Error?new Error("WebCrypto_FailedToWrapKey - ".concat(c.message)):new Error("WebCrypto_FailedToWrapKey");case 5:return[2]}}))}))},t.unwrapKey=function(e,t,i,o){var s=i.name,a=i.iv;return r(void 0,void 0,void 0,(function(){var r,i,u,c;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,o.importKey("raw",t,{name:s},!1,["wrapKey","unwrapKey"])];case 1:return r=n.sent(),[4,o.unwrapKey("raw",e,r,{name:s,iv:a},{name:"AES-GCM"},!0,["encrypt","decrypt"])];case 2:return i=n.sent(),u=Uint8Array.bind,[4,o.exportKey("raw",i)];case 3:return[2,new(u.apply(Uint8Array,[void 0,n.sent()]))];case 4:throw(c=n.sent())instanceof Error?new Error("WebCrypto_FailedToUnwrapKey - ".concat(c.message)):new Error("WebCrypto_FailedToUnwrapKey");case 5:return[2]}}))}))},t.encrypt=function(e,t,o,s){var a=o.name,u=void 0===a?"AES-GCM":a,c=o.iv,f=o.additionalData,l=o.tagLength;return r(void 0,void 0,void 0,(function(){var r,o,a,h;return n(this,(function(n){switch(n.label){case 0:r=i({name:u,iv:c,additionalData:f,tagLength:l}),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,s.importKey("raw",t,r,!1,["encrypt","decrypt"])];case 2:return o=n.sent(),[4,s.encrypt(r,o,e)];case 3:return a=n.sent(),[2,new Uint8Array(a)];case 4:throw(h=n.sent())instanceof Error?new Error("WebCrypto_EncryptionFailure: ".concat(h.message)):new Error("WebCrypto_EncryptionFailure");case 5:return[2]}}))}))},t.decrypt=function(e,t,o,s){var a=o.name,u=o.iv,c=o.additionalData,f=o.tagLength;return r(void 0,void 0,void 0,(function(){var r,o,l,h;return n(this,(function(n){switch(n.label){case 0:r=i({name:a,iv:u,additionalData:c,tagLength:f}),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,s.importKey("raw",t,r,!1,["encrypt","decrypt"])];case 2:return o=n.sent(),[4,s.decrypt(r,o,e)];case 3:return l=n.sent(),[2,new Uint8Array(l)];case 4:throw(h=n.sent())instanceof Error?new Error("WebCrypto_DecryptionFailure: ".concat(h.message)):new Error("WebCrypto_DecryptionFailure");case 5:return[2]}}))}))};var i=function(e){var t=e.name,r=e.iv,n=e.additionalData,i=e.tagLength,o={name:t,iv:r,additionalData:n,tagLength:i};switch(t){case"AES-GCM":o.tagLength=8*i;break;case"AES-CBC":break;case"AES-CTR":if(0===r.length||r.length>16)throw new Error("InvalidIVLength");o.counter=new Uint8Array(16),o.counter.set(r),o.counter[15]+=1,o.length=128}return o}},3266:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.encodeAsn1Signature=t.decodeAsn1Signature=void 0;var a=r(6229),u=s(r(2993)),c=o(r(5872)).Buffer,f=u.default.bignum;t.decodeAsn1Signature=function(e,t){var r=c.from(e),n=l.decode(r,"der"),i=a.namedCurves[t].payloadSize,o=new Uint8Array(n.r.toArray("be",i)),s=new Uint8Array(n.s.toArray("be",i)),u=new Uint8Array(2*i);return u.set(o),u.set(s,i),u},t.encodeAsn1Signature=function(e,t){var r=a.namedCurves[t].payloadSize,n=e.slice(0,r),i=e.slice(r,e.length),o=l.encode({r:new f(n),s:new f(i)},"der");return new Uint8Array(o)};var l=u.default.define("ECDSASignature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},8251:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.deriveSecret=t.verify=t.sign=t.generateKey=void 0;var u=o(r(6852)),c=o(r(8241)),f=o(r(9350)),l=o(r(2464));t.generateKey=function(e){return void 0===e&&(e="P-256"),s(void 0,void 0,void 0,(function(){var t,r,n,i;return a(this,(function(o){switch(o.label){case 0:t=u.getCrypto(),r=!1,o.label=1;case 1:return o.trys.push([1,8,,12]),"webCrypto"!==t.name||"function"!=typeof t.crypto.generateKey||"function"!=typeof t.crypto.exportKey?[3,3]:[4,c.generateKey(e,t.crypto)];case 2:return n=o.sent(),[3,7];case 3:return"nodeCrypto"!==t.name?[3,5]:[4,f.generateKey(e,t.crypto)];case 4:return n=o.sent(),[3,7];case 5:return r=!0,[4,l.generateKey(e)];case 6:n=o.sent(),o.label=7;case 7:return[2,n];case 8:if(i=o.sent(),!r)return[3,9];throw i instanceof Error?new Error("UnsupportedEnvironment: ".concat(i.message)):new Error("UnsupportedEnvironment");case 9:return[4,l.generateKey(e).catch((function(e){throw new Error("FailedBothNativeAndPureJSEnvs: ".concat(e.message))}))];case 10:return[2,n=o.sent()];case 11:return[3,12];case 12:return[2]}}))}))},t.sign=function(e,t,r,n){return void 0===r&&(r="SHA-256"),void 0===n&&(n="raw"),s(void 0,void 0,void 0,(function(){var i,o,s,h;return a(this,(function(a){switch(a.label){case 0:i=u.getCrypto(),o=!1,a.label=1;case 1:return a.trys.push([1,8,,12]),"webCrypto"!==i.name||"function"!=typeof i.crypto.importKey||"function"!=typeof i.crypto.sign?[3,3]:[4,c.sign(e,t,r,n,i.crypto)];case 2:return s=a.sent(),[3,7];case 3:return"nodeCrypto"!==i.name?[3,5]:[4,f.sign(e,t,r,n,i.crypto)];case 4:return s=a.sent(),[3,7];case 5:return o=!0,[4,l.sign(e,t,r,n)];case 6:s=a.sent(),a.label=7;case 7:return[2,s];case 8:if(h=a.sent(),!o)return[3,9];throw h instanceof Error?new Error("UnsupportedEnvironment: ".concat(h.message)):new Error("UnsupportedEnvironment");case 9:return[4,l.sign(e,t,r,n).catch((function(e){throw new Error("FailedBothNativeAndPureJSEnvs: ".concat(e.message))}))];case 10:return[2,s=a.sent()];case 11:return[3,12];case 12:return[2]}}))}))},t.verify=function(e,t,r,n,i){return void 0===n&&(n="SHA-256"),void 0===i&&(i="raw"),s(void 0,void 0,void 0,(function(){var o,s,h,d;return a(this,(function(a){switch(a.label){case 0:o=u.getCrypto(),s=!1,a.label=1;case 1:return a.trys.push([1,8,,12]),"webCrypto"!==o.name||"function"!=typeof o.crypto.importKey||"function"!=typeof o.crypto.sign?[3,3]:[4,c.verify(e,t,r,n,i,o.crypto)];case 2:return h=a.sent(),[3,7];case 3:return"nodeCrypto"!==o.name?[3,5]:[4,f.verify(e,t,r,n,i,o.crypto)];case 4:return h=a.sent(),[3,7];case 5:return s=!0,[4,l.verify(e,t,r,n,i)];case 6:h=a.sent(),a.label=7;case 7:return[2,h];case 8:if(d=a.sent(),!s)return[3,9];throw d instanceof Error?new Error("UnsupportedEnvironment: ".concat(d.message)):new Error("UnsupportedEnvironment");case 9:return[4,l.verify(e,t,r,n,i).catch((function(e){throw new Error("FailedBothNativeAndPureJSEnvs: ".concat(e.message))}))];case 10:return[2,h=a.sent()];case 11:return[3,12];case 12:return[2]}}))}))},t.deriveSecret=function(e,t){return s(void 0,void 0,void 0,(function(){var r,n,i,o;return a(this,(function(s){switch(s.label){case 0:if(e.crv!==t.crv)throw new Error("UnmatchedCurveName");r=u.getCrypto(),n=!1,s.label=1;case 1:return s.trys.push([1,7,,11]),"webCrypto"!==r.name||"function"!=typeof r.crypto.importKey||"function"!=typeof r.crypto.deriveBits?[3,3]:[4,c.deriveSecret(e,t,r.crypto)];case 2:return i=s.sent(),[3,6];case 3:return"nodeCrypto"!==r.name?[3,4]:(i=f.deriveSecret(e,t,r.crypto),[3,6]);case 4:return n=!0,[4,l.deriveSecret(e,t)];case 5:i=s.sent(),s.label=6;case 6:return[2,i];case 7:if(o=s.sent(),!n)return[3,8];throw o instanceof Error?new Error("UnsupportedEnvironment: ".concat(o.message)):new Error("UnsupportedEnvironment");case 8:return[4,l.deriveSecret(e,t).catch((function(e){throw new Error("FailedBothNativeAndPureJSEnvs: ".concat(e.message))}))];case 9:return[2,i=s.sent()];case 10:return[3,11];case 11:return[2]}}))}))}},6432:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.deriveSecret=t.verify=t.sign=t.generateKey=void 0;var s=o(r(8251));t.generateKey=s.generateKey,t.sign=s.sign,t.verify=s.verify,t.deriveSecret=s.deriveSecret,t.default={generateKey:t.generateKey,sign:t.sign,verify:t.verify,deriveSecret:t.deriveSecret}},9350:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deriveSecret=t.verify=t.sign=t.generateKey=void 0;var c=r(6229),f=o(r(3266)),l=r(1402),h=u(r(4471));t.generateKey=function(e,t){return s(void 0,void 0,void 0,(function(){var r,n,i,o,s,u,f;return a(this,(function(a){switch(a.label){case 0:if((r=t.ECDH(c.namedCurves[e].nodeName)).generateKeys(),n=new Uint8Array(r.getPublicKey()),i=new Uint8Array(r.getPrivateKey()),(o=new l.Key("oct",n,{namedCurve:e})).isPrivate)throw new Error("NotPublicKeyForECCKeyGenNode");return[4,o.export("jwk",{outputPublic:!0})];case 1:if(s=a.sent(),!(u=new l.Key("oct",i,{namedCurve:e})).isPrivate)throw new Error("NotPrivateKeyForECCKeyGenNode");return[4,u.export("jwk")];case 2:return f=a.sent(),[2,{publicKey:s,privateKey:f}]}}))}))},t.sign=function(e,t,r,n,i){return s(void 0,void 0,void 0,(function(){var o,s,u,h;return a(this,(function(a){switch(a.label){case 0:if(!(o=new l.Key("jwk",t)).isPrivate)throw new Error("NotPrivateKeyForECCSignNode");return[4,o.export("pem")];case 1:return s=a.sent(),(u=i.createSign(c.hashes[r].nodeName)).update(e),h=u.sign(s),[2,"raw"===n?f.decodeAsn1Signature(h,t.crv):h]}}))}))},t.verify=function(e,t,r,n,i,o){return s(void 0,void 0,void 0,(function(){var s,u,h,d;return a(this,(function(a){switch(a.label){case 0:if(!(s=new l.Key("jwk",r)).isPrivate)throw new Error("NotPrivateKeyForECCVerifyNode");return[4,s.export("pem",{outputPublic:!0,compact:!1})];case 1:return u=a.sent(),(h=o.createVerify(c.hashes[n].nodeName)).update(e),d="raw"===i?f.encodeAsn1Signature(t,r.crv):t,[2,h.verify(u,d)]}}))}))},t.deriveSecret=function(e,t,r){var n=c.namedCurves[t.crv].nodeName,i=c.namedCurves[t.crv].payloadSize,o=r.createECDH(n),s=h.default.encoder.decodeBase64Url(t.d),a=new Uint8Array(2*i+1);return a[0]=4,a.set(h.default.encoder.decodeBase64Url(e.x),1),a.set(h.default.encoder.decodeBase64Url(e.y),i+1),o.setPrivateKey(s),new Uint8Array(o.computeSecret(a))}},6229:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hashes=t.namedCurves=void 0,t.namedCurves={"P-256":{indutnyName:"p256",nodeName:"prime256v1",payloadSize:32},"P-384":{indutnyName:"p384",nodeName:"secp384r1",payloadSize:48},"P-521":{indutnyName:"p521",nodeName:"secp521r1",payloadSize:66},"P-256K":{indutnyName:"secp256k1",nodeName:"secp256k1",payloadSize:32}},t.hashes={"SHA-256":{nodeName:"sha256"},"SHA-384":{nodeName:"sha384"},"SHA-512":{nodeName:"sha512"},"SHA-1":{nodeName:"sha1"}}},2464:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deriveSecret=t.verify=t.sign=t.generateKey=void 0;var c=r(6229),f=o(r(3266)),l=u(r(3669)),h=u(r(3249)),d=r(1402),p=u(r(4471)),y=o(r(4365)).ec;t.generateKey=function(e){return s(void 0,void 0,void 0,(function(){var t,r,n,i,o,s,u,f,h,b,v,g,m,w,S;return a(this,(function(a){switch(a.label){case 0:return t=c.namedCurves[e].indutnyName,r=new y(t),o=(i=r).genKeyPair,S={},u=(s=p.default.encoder).arrayBufferToString,[4,l.default.getRandomBytes(32)];case 1:if(n=o.apply(i,[(S.entropy=u.apply(s,[a.sent()]),S)]),f=c.namedCurves[e].payloadSize,h=new Uint8Array(n.getPublic("array")),b=new Uint8Array(n.getPrivate().toArray("be",f)),(v=new d.Key("oct",h,{namedCurve:e})).isPrivate)throw new Error("NotPublicKeyForECCKeyGenPureJS");return[4,v.export("jwk",{outputPublic:!0})];case 2:if(g=a.sent(),!(m=new d.Key("oct",b,{namedCurve:e})).isPrivate)throw new Error("NotPrivateKeyForECCKeyGenPureJS");return[4,m.export("jwk")];case 3:return w=a.sent(),[2,{publicKey:g,privateKey:w}]}}))}))},t.sign=function(e,t,r,n){return s(void 0,void 0,void 0,(function(){var i,o,s,u,l,p,b,v,g,m,w,S;return a(this,(function(a){switch(a.label){case 0:if(i=t.crv,o=c.namedCurves[i].indutnyName,s=new y(o),!(u=new d.Key("jwk",t)).isPrivate)throw new Error("NotPrivateKeyForECCSignPureJS");return[4,u.export("oct")];case 1:return l=a.sent(),p=s.keyFromPrivate(l),[4,h.default.compute(e,r)];case 2:return b=a.sent(),v=p.sign(b),g=c.namedCurves[i].payloadSize,m=new Uint8Array(v.r.toArray("be",g)),w=new Uint8Array(v.s.toArray("be",g)),(S=new Uint8Array(m.length+w.length)).set(m),S.set(w,m.length),[2,"raw"===n?S:f.encodeAsn1Signature(S,i)]}}))}))},t.verify=function(e,t,r,n,i){return s(void 0,void 0,void 0,(function(){var o,s,u,l,p,b,v,g,m,w;return a(this,(function(a){switch(a.label){case 0:if(o=r.crv,s=c.namedCurves[o].indutnyName,u=new y(s),(l=new d.Key("jwk",r)).isPrivate)throw new Error("NotPublicKeyForECCVerifyPureJS");return[4,l.export("oct",{compact:!1,outputPublic:!0})];case 1:return p=a.sent(),b=u.keyFromPublic(p),v=c.namedCurves[o].payloadSize,t instanceof Uint8Array||(t=new Uint8Array(t)),t="raw"===i?t:f.decodeAsn1Signature(t,o),g=t.slice(0,v),m=t.slice(v,v+g.length),[4,h.default.compute(e,n)];case 2:return w=a.sent(),[2,b.verify(w,{s:m,r:g})]}}))}))},t.deriveSecret=function(e,t){return s(void 0,void 0,void 0,(function(){var r,n,i,o,s,u,f,l,h,p;return a(this,(function(a){switch(a.label){case 0:if(r=t.crv,n=c.namedCurves[r].indutnyName,i=new y(n),!(o=new d.Key("jwk",t)).isPrivate)throw new Error("NotPrivateKeyForECCSDeriveKeyPureJS");return[4,o.export("oct")];case 1:if(s=a.sent(),(u=new d.Key("jwk",e)).isPrivate)throw new Error("NotPublicKeyForECCDeriveKeyPureJS");return[4,u.export("oct",{compact:!1,outputPublic:!0})];case 2:return f=a.sent(),l=i.keyFromPrivate(s),h=i.keyFromPublic(f),p=c.namedCurves[r].payloadSize,[2,new Uint8Array(l.derive(h.getPublic()).toArray("be",p))]}}))}))}},8241:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deriveSecret=t.verify=t.sign=t.generateKey=void 0;var c=u(r(4471)),f=o(r(3266));t.generateKey=function(e,t){return s(void 0,void 0,void 0,(function(){var r,n,i;return a(this,(function(o){switch(o.label){case 0:return[4,t.generateKey({name:"ECDSA",namedCurve:e,hash:{name:"SHA-256"}},!0,["sign","verify"])];case 1:return r=o.sent(),[4,t.exportKey("jwk",r.publicKey)];case 2:return n=o.sent(),[4,t.exportKey("jwk",r.privateKey)];case 3:return i=o.sent(),["key_ops","alg","ext"].forEach((function(e){delete n[e],delete i[e]})),[2,{publicKey:n,privateKey:i}]}}))}))},t.sign=function(e,t,r,n,i){return s(void 0,void 0,void 0,(function(){var o,s,u;return a(this,(function(a){switch(a.label){case 0:return o={name:"ECDSA",namedCurve:t.crv,hash:{name:r}},[4,i.importKey("jwk",t,o,!1,["sign"])];case 1:return s=a.sent(),[4,i.sign(o,s,e)];case 2:return u=a.sent(),[2,"raw"===n?new Uint8Array(u):f.encodeAsn1Signature(new Uint8Array(u),t.crv)]}}))}))},t.verify=function(e,t,r,n,i,o){return s(void 0,void 0,void 0,(function(){var s,u,c;return a(this,(function(a){switch(a.label){case 0:return s={name:"ECDSA",namedCurve:r.crv,hash:{name:n}},[4,o.importKey("jwk",r,s,!1,["verify"])];case 1:return u=a.sent(),c="raw"===i?t:f.decodeAsn1Signature(t,r.crv),[2,o.verify(s,u,c,e)]}}))}))},t.deriveSecret=function(e,t,r){return s(void 0,void 0,void 0,(function(){var n,i,o,s,u;return a(this,(function(a){switch(a.label){case 0:return n={name:"ECDH",namedCurve:t.crv},[4,r.importKey("jwk",t,n,!1,["deriveBits"])];case 1:return i=a.sent(),[4,r.importKey("jwk",e,n,!1,[])];case 2:return o=a.sent(),s=function(){return 8*c.default.encoder.decodeBase64Url(t.x).length},u=Uint8Array.bind,[4,r.deriveBits(Object.assign(n,{public:o}),i,s())];case 3:return[2,new(u.apply(Uint8Array,[void 0,a.sent()]))]}}))}))}},6852:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCrypto=t.getRootWebCrypto=t.getWebCrypto=t.getNodeCrypto=void 0;var n=function(){return"undefined"!=typeof window&&window.crypto||"undefined"==typeof window&&"undefined"!=typeof crypto?void 0:r(6100)};t.getNodeCrypto=n;var i=function(){return"undefined"!=typeof window&&window.crypto?window.crypto.subtle:"undefined"==typeof window&&"undefined"!=typeof crypto?crypto.subtle:void 0};t.getWebCrypto=i;var o=function(){return"undefined"!=typeof window&&window.crypto?window.crypto:"undefined"==typeof window&&"undefined"!=typeof crypto?crypto:void 0};t.getRootWebCrypto=o;var s=function(){var e=i(),t=n();return void 0!==t?{name:"nodeCrypto",crypto:t}:void 0!==e?{name:"webCrypto",crypto:e}:{name:void 0}};t.getCrypto=s,t.default={getNodeCrypto:n,getWebCrypto:i,getRootWebCrypto:o,getCrypto:s}},357:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.compute=void 0;var c=o(r(6852)),f=u(r(3284)),l=u(r(6706)),h=r(8423),d=o(r(4751));t.compute=function(e,t){return void 0===t&&(t="SHA-256"),s(void 0,void 0,void 0,(function(){var r,n,i,o,s,u;return a(this,(function(a){switch(a.label){case 0:r=c.getCrypto(),o=!0,a.label=1;case 1:return a.trys.push([1,5,,6]),"webCrypto"!==r.name||"function"!=typeof r.crypto.digest?[3,3]:[4,r.crypto.digest(t,e)];case 2:return n=a.sent(),[3,4];case 3:"nodeCrypto"===r.name?n=p(t,e,r.crypto):o=!1,a.label=4;case 4:return[3,6];case 5:return(s=a.sent())instanceof Error&&(i=s.message),o=!1,[3,6];case 6:if(o)return[3,10];a.label=7;case 7:return a.trys.push([7,9,,10]),[4,y(t,e)];case 8:return n=a.sent(),[3,10];case 9:throw(u=a.sent())instanceof Error?(i="".concat(void 0===i?"":i," => ").concat(u.message),new Error("UnsupportedEnvironment: ".concat(i))):new Error("UnsupportedEnvironment");case 10:return[2,new Uint8Array(n)]}}))}))};var p=function(e,t,r){var n=f.default.hashes[e].nodeName,i=r.createHash(n);return i.update(t),i.digest()},y=function(e,t){return s(void 0,void 0,void 0,(function(){var n,i,s,u;return a(this,(function(a){switch(a.label){case 0:return"MD5"!==e?[3,1]:(n=(0,l.default)(Array.from(t),{asBytes:!0}),[3,4]);case 1:return["SHA3-512","SHA3-384","SHA3-256","SHA3-224"].indexOf(e)>=0?(i=8*f.default.hashes[e].hashSize,s=new h.SHA3(i),[4,Promise.resolve().then((function(){return o(r(5872))}))]):[3,3];case 2:return u=a.sent().Buffer,s.update(u.from(t)),n=s.digest("binary"),[3,4];case 3:n=d[f.default.hashes[e].nodeName]().update(t).digest(),a.label=4;case 4:return[2,new Uint8Array(n)]}}))}))}},3249:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.compute=void 0;var s=o(r(357));t.compute=s.compute,t.default={compute:t.compute}},3284:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={hashes:{"SHA3-512":{nodeName:"sha3-512",hashSize:64},"SHA3-384":{nodeName:"sha3-384",hashSize:48},"SHA3-256":{nodeName:"sha3-256",hashSize:32},"SHA3-224":{nodeName:"sha3-224",hashSize:28},"SHA-256":{nodeName:"sha256",hashSize:32},"SHA-384":{nodeName:"sha384",hashSize:48},"SHA-512":{nodeName:"sha512",hashSize:64},"SHA-1":{nodeName:"sha1",hashSize:20},MD5:{nodeName:"md5",hashSize:16}}}},6355:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.compute=void 0;var c=u(r(6187)),f=o(r(6852)),l=u(r(3669)),h=u(r(2955)),d=u(r(4471));t.compute=function(e,t,r,n,i){return void 0===t&&(t="SHA-256"),void 0===r&&(r=32),void 0===n&&(n=""),void 0===i&&(i=null),s(void 0,void 0,void 0,(function(){var o,s,u,c;return a(this,(function(a){switch(a.label){case 0:if(o=f.getCrypto(),i||(i=l.default.getRandomBytes(r)),"webCrypto"!==o.name||"function"!=typeof o.crypto.importKey||"function"!=typeof o.crypto.deriveBits)return[3,7];a.label=1;case 1:return a.trys.push([1,4,,6]),[4,o.crypto.importKey("raw",e,{name:"HKDF"},!1,["deriveKey","deriveBits"])];case 2:return u=a.sent(),c={name:"HKDF",salt:i,info:d.default.encoder.stringToArrayBuffer(n),hash:t},[4,o.crypto.deriveBits(c,u,8*r)];case 3:return s=a.sent(),s=new Uint8Array(s),[3,6];case 4:return a.sent(),[4,p(e,t,r,n,i)];case 5:return s=a.sent(),[3,6];case 6:return[3,9];case 7:return[4,p(e,t,r,n,i)];case 8:s=a.sent(),a.label=9;case 9:return[2,{key:s,salt:i}]}}))}))};var p=function(e,t,r,n,i){return s(void 0,void 0,void 0,(function(){var o,s,u,f,l,p,y;return a(this,(function(a){switch(a.label){case 0:return o=c.default.hashes[t].hashSize,[4,h.default.compute(i,e,t)];case 1:s=a.sent(),u=new Uint8Array([]),f=new Uint8Array(Math.ceil(r/o)*o),l=d.default.encoder.stringToArrayBuffer(n),p=0,a.label=2;case 2:return p<Math.ceil(r/o)?((y=new Uint8Array(u.length+l.length+1)).set(u),y.set(l,u.length),y.set(new Uint8Array([p+1]),u.length+l.length),[4,h.default.compute(s,y,t)]):[3,5];case 3:u=a.sent(),f.set(u,o*p),a.label=4;case 4:return p++,[3,2];case 5:return[2,f.slice(0,r)]}}))}))}},4097:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.nistConcatKdf=t.compute=void 0;var s=o(r(6355)),a=o(r(2789));t.compute=s.compute,t.nistConcatKdf=a.nistConcatKdf,t.default={compute:t.compute,nistConcatKdf:t.nistConcatKdf}},2789:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.nistConcatKdf=void 0;var s=o(r(6187)),a=o(r(3249));t.nistConcatKdf=function(e,t,r,o){return void 0===r&&(r=32),void 0===o&&(o="SHA-256"),n(void 0,void 0,void 0,(function(){var n,c,f,l,h,d;return i(this,(function(i){switch(i.label){case 0:if((n=Math.ceil(r/s.default.hashes[o].hashSize))>Math.pow(2,32)-1)throw new Error("TooLongKeyDataIndicated");c=new Uint8Array(s.default.hashes[o].hashSize*n),f=new Uint8Array(4),l=0,i.label=1;case 1:return l<n?(f=u(f),(h=new Uint8Array(4+e.length+t.length)).set(f),h.set(e,f.length),h.set(t,f.length+e.length),[4,a.default.compute(h,o)]):[3,4];case 2:d=i.sent(),c.set(d,l*s.default.hashes[o].hashSize),i.label=3;case 3:return l++,[3,1];case 4:return[2,c.slice(0,r)]}}))}))};var u=function(e){e[3]+=1;for(var t=!0,r=3;t&&r>0;)e[r-1]+=t&&0===e[r]?1:0,t=t&&0===e[r],r--;return e}},6187:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={hashes:{"SHA3-512":{nodeName:"sha3-512",hashSize:64},"SHA3-384":{nodeName:"sha3-384",hashSize:48},"SHA3-256":{nodeName:"sha3-256",hashSize:32},"SHA3-224":{nodeName:"sha3-224",hashSize:28},"SHA-256":{nodeName:"sha256",hashSize:32},"SHA-384":{nodeName:"sha384",hashSize:48},"SHA-512":{nodeName:"sha512",hashSize:64},"SHA-1":{nodeName:"sha1",hashSize:20},MD5:{nodeName:"md5",hashSize:16}}}},7756:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.verify=t.compute=void 0;var c=u(r(4779)),f=o(r(6852)),l=u(r(3249));t.compute=function(e,t,r){return void 0===r&&(r="SHA-256"),s(void 0,void 0,void 0,(function(){var n,i,o,s,u,l,d,p;return a(this,(function(a){switch(a.label){case 0:n=f.getCrypto(),s=!0,a.label=1;case 1:return a.trys.push([1,6,,7]),"webCrypto"!==n.name||"function"!=typeof n.crypto.importKey||"function"!=typeof n.crypto.sign?[3,4]:[4,n.crypto.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign","verify"])];case 2:return u=a.sent(),[4,n.crypto.sign({name:"HMAC",hash:{name:r}},u,t)];case 3:return i=a.sent(),[3,5];case 4:"nodeCrypto"===n.name?(l=n.crypto.createHmac(c.default.hashes[r].nodeName,e),i=l.update(t).digest()):s=!1,a.label=5;case 5:return[3,7];case 6:return(d=a.sent())instanceof Error&&(o=d.message),s=!1,[3,7];case 7:if(s)return[3,11];a.label=8;case 8:return a.trys.push([8,10,,11]),[4,h(e,t,r)];case 9:return i=a.sent(),[3,11];case 10:throw(p=a.sent())instanceof Error?(o="".concat(o," => ").concat(p.message),new Error("UnsupportedEnvironments: ".concat(o))):new Error("UnsupportedEnvironments");case 11:return[2,new Uint8Array(i)]}}))}))};var h=function(e,t,r){return s(void 0,void 0,void 0,(function(){var n,i,o,s,u,f,h,d;return a(this,(function(a){switch(a.label){case 0:return n=c.default.hashes[r].blockSize,i=c.default.hashes[r].hashSize,e.length>n?[4,l.default.compute(e,r)]:[3,2];case 1:e=a.sent(),a.label=2;case 2:return(o=new Uint8Array(n)).set(e),s=o.map((function(e){return 255&(54^e)})),u=o.map((function(e){return 255&(92^e)})),(f=new Uint8Array(n+t.length)).set(s),f.set(t,n),[4,l.default.compute(f,r)];case 3:return h=a.sent(),(d=new Uint8Array(n+i)).set(u),d.set(h,n),[2,l.default.compute(d,r)]}}))}))};t.verify=function(e,r,n,i){return void 0===i&&(i="SHA-256"),s(void 0,void 0,void 0,(function(){var o;return a(this,(function(s){switch(s.label){case 0:return[4,(0,t.compute)(e,r,i)];case 1:return o=s.sent(),[2,n.toString()===o.toString()]}}))}))}},2955:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.verify=t.compute=void 0;var s=o(r(7756));t.compute=s.compute,t.verify=s.verify,t.default={compute:t.compute,verify:t.verify}},4779:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={hashes:{"SHA3-512":{nodeName:"sha3-512",hashSize:64,blockSize:72},"SHA3-384":{nodeName:"sha3-384",hashSize:48,blockSize:104},"SHA3-256":{nodeName:"sha3-256",hashSize:32,blockSize:136},"SHA3-224":{nodeName:"sha3-224",hashSize:28,blockSize:144},"SHA-256":{nodeName:"sha256",hashSize:32,blockSize:64},"SHA-384":{nodeName:"sha384",hashSize:48,blockSize:128},"SHA-512":{nodeName:"sha512",hashSize:64,blockSize:128},"SHA-1":{nodeName:"sha1",hashSize:20,blockSize:64},MD5:{nodeName:"md5",hashSize:16,blockSize:64}}}},5807:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PBES2ESParams=t.PBKDF2Params=t.PBES2Params=t.PBEParameter=t.EncryptedPrivateKeyInfo=t.OneAsymmetricKey=t.SubjectPublicKeyInfo=t.KeyStructure=void 0;var i=n(r(2993));t.KeyStructure=i.default.define("KeyStructure",(function(){this.choice({subjectPublicKeyInfo:this.use(t.SubjectPublicKeyInfo),oneAsymmetricKey:this.use(t.OneAsymmetricKey),encryptedPrivateKeyInfo:this.use(t.EncryptedPrivateKeyInfo)})})),t.SubjectPublicKeyInfo=i.default.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(o),this.key("subjectPublicKey").bitstr())})),t.OneAsymmetricKey=i.default.define("OneAsymmetricKey",(function(){this.seq().obj(this.key("version").use(s),this.key("privateKeyAlgorithm").use(o),this.key("privateKey").octstr(),this.key("attributes").implicit(0).optional().any(),this.key("publicKey").implicit(1).optional().bitstr())})),t.EncryptedPrivateKeyInfo=i.default.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("encryptionAlgorithm").use(o),this.key("encryptedData").octstr())})),t.PBEParameter=i.default.define("PBEParameter",(function(){this.seq().obj(this.key("salt").octstr(8),this.key("iterationCount").int())})),t.PBES2Params=i.default.define("PBES2Params",(function(){this.seq().obj(this.key("keyDerivationFunc").use(o),this.key("encryptionScheme").use(o))})),t.PBKDF2Params=i.default.define("PBKDF2Params",(function(){this.seq().obj(this.key("salt").choice({specified:this.octstr(),otherSource:this.use(o)}),this.key("iterationCount").int(),this.key("keyLength").int().optional(),this.key("prf").use(o).def({algorithm:[1,2,840,113549,2,7],parameters:Buffer.from([5,0])}))})),t.PBES2ESParams={"des-ede3-cbc":i.default.define("DesEde3CbcParams",(function(){this.octstr()})),"aes128-cbc":i.default.define("Aes128CbcParams",(function(){this.octstr()})),"aes192-cbc":i.default.define("Aes192CbcParams",(function(){this.octstr()})),"aes256-cbc":i.default.define("Aes256CbcParams",(function(){this.octstr()}))};var o=i.default.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional().any())})),s=i.default.define("Version",(function(){this.int()}))},5313:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toJWK=t.fromJWK=void 0;var a=s(r(2993)),u=o(r(1252)),c=r(4571);t.fromJWK=function(e,t,r){void 0===r&&(r=!1);var n=(0,c.fromJwk)(e,{outputFormat:"binary",outputPublic:!0,compact:r}),i=u.publicKeyAlgorithms.EC.oid,o={unused:0,data:Array.from(n)},s=f.encode({type:"namedCurve",value:u.namedCurves[e.crv].oid},"der"),a={algorithm:i,parameters:s},h={};if("public"===t)h.subjectPublicKey=o,h.algorithm=a;else if("private"===t){var d=(0,c.fromJwk)(e,{outputFormat:"binary",outputPublic:!1,compact:r});h.version=0,h.privateKeyAlgorithm=a,h.privateKey=l.encode({version:1,privateKey:Array.from(d),parameters:s,publicKey:o},"der")}return h},t.toJWK=function(e,t){if("public"===t){e.algorithm.parameters=f.decode(e.algorithm.parameters,"der");var r=new Uint8Array(e.subjectPublicKey.data),n=u.getAlgorithmFromOid(e.algorithm.parameters.value,u.namedCurves);return(0,c.toJwk)(r,n[0],{outputPublic:!0})}e.privateKeyAlgorithm.parameters=f.decode(e.privateKeyAlgorithm.parameters,"der");try{e.privateKey=l.decode(e.privateKey,"der")}catch(t){e.privateKey=h.decode(e.privateKey,"der")}var i=new Uint8Array(e.privateKey.privateKey);if((n=u.getAlgorithmFromOid(e.privateKeyAlgorithm.parameters.value,u.namedCurves)).length<1)throw new Error("UnsupportedCurve");return(0,c.toJwk)(i,n[0],{outputPublic:!1})};var f=a.default.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})})),l=a.default.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").explicit(0).optional().any(),this.key("publicKey").explicit(1).optional().bitstr())})),h=a.default.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("publicKey").explicit(1).optional().bitstr())}))},3780:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toJwk=t.fromJwk=void 0;var c=o(r(5313)),f=o(r(1155)),l=r(1252),h=u(r(4471)),d=o(r(5872)),p=r(5807),y=r(8482),b=r(792),v=d.Buffer;t.fromJwk=function(e,t,r){var n=r.outputPublic,i=r.compact,o=void 0!==i&&i,u=r.encOptions;return s(void 0,void 0,void 0,(function(){var r,i,s,l;return a(this,(function(a){switch(a.label){case 0:return r=(0,b.getJwkType)(e),i="boolean"==typeof n&&n?"public":r,"EC"===e.kty?s=c.fromJWK(e,i,o):"RSA"===e.kty&&(s=f.fromJwk(e,i)),"public"!==i?[3,1]:(l=p.SubjectPublicKeyInfo.encode(s,"der"),[3,3]);case 1:return l=p.OneAsymmetricKey.encode(s,"der"),void 0!==u&&void 0!==u.passphrase&&u.passphrase.length>0?[4,(0,y.encryptEncryptedPrivateKeyInfo)(l,u)]:[3,3];case 2:l=a.sent(),i="encryptedPrivate",a.label=3;case 3:return l=new Uint8Array(l),[2,"pem"===t?h.default.formatter.binToPem(l,i):l]}}))}))},t.toJwk=function(e,t,r){var n=r.outputPublic,i=r.passphrase;return s(void 0,void 0,void 0,(function(){var r,o,s,u;return a(this,(function(a){switch(a.label){case 0:r="pem"===t?h.default.formatter.pemToBin(e):e;try{o=p.KeyStructure.decode(v.from(r),"der")}catch(e){throw new Error("FailedToDecodeKey")}return"subjectPublicKeyInfo"!==o.type?[3,1]:(s="public",o=o.value,[3,4]);case 1:return s="boolean"==typeof n&&n?"public":"private","encryptedPrivateKeyInfo"!==o.type?[3,3]:[4,(0,y.decryptEncryptedPrivateKeyInfo)(o.value,i)];case 2:return o=a.sent(),[3,4];case 3:if("oneAsymmetricKey"!==o.type)throw new Error("UnsupportedKeyStructure");o=o.value,a.label=4;case 4:if((u=(0,l.getAlgorithmFromOid)("public"===s?o.algorithm.algorithm:o.privateKeyAlgorithm.algorithm,l.publicKeyAlgorithms)).length<1)throw new Error("UnsupportedKey");if("EC"===u[0])return[2,c.toJWK(o,s)];if("RSA"===u[0])return[2,f.toJwk(o,s)];throw new Error("InvalidKeyType")}}))}))}},1155:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toJwk=t.fromJwk=void 0;var a=s(r(2993)),u=s(r(4471)),c=o(r(5872)).Buffer,f=o(r(1252)),l=r(792);t.fromJwk=function(e,t){var r={algorithm:f.publicKeyAlgorithms.RSA.oid,parameters:c.from([5,0])},n=u.default.encoder.decodeBase64Url(e.n),i=n.length,o=i%128==0?i:i+(128-i%128),s=new a.default.bignum((0,l.appendLeadingZeros)(n,o)),p=new a.default.bignum(u.default.encoder.decodeBase64Url(e.e)),y={};return"public"===t?(y.subjectPublicKey={unused:0,data:h.encode({modulus:s,publicExponent:p},"der")},y.algorithm=r):"private"===t&&(y.version=0,y.privateKeyAlgorithm=r,y.privateKey=d.encode({version:0,modulus:s,publicExponent:p,privateExponent:new a.default.bignum((0,l.appendLeadingZeros)(u.default.encoder.decodeBase64Url(e.d),o)),prime1:new a.default.bignum((0,l.appendLeadingZeros)(u.default.encoder.decodeBase64Url(e.p),o)),prime2:new a.default.bignum((0,l.appendLeadingZeros)(u.default.encoder.decodeBase64Url(e.q),o)),exponent1:new a.default.bignum((0,l.appendLeadingZeros)(u.default.encoder.decodeBase64Url(e.dp),o)),exponent2:new a.default.bignum((0,l.appendLeadingZeros)(u.default.encoder.decodeBase64Url(e.dq),o)),coefficient:new a.default.bignum((0,l.appendLeadingZeros)(u.default.encoder.decodeBase64Url(e.qi),o))},"der")),y},t.toJwk=function(e,t){if("public"===t){e.subjectPublicKey.data=h.decode(e.subjectPublicKey.data,"der");var r=e.subjectPublicKey.data.modulus,n=e.subjectPublicKey.data.publicExponent,i=(s=r.byteLength())%128==0?s:s+(128-s%128);return r=new Uint8Array(r.toArray("be",i)),n=new Uint8Array(n.toArray("be",n.byteLength())),{kty:"RSA",n:u.default.encoder.encodeBase64Url((0,l.pruneLeadingZeros)(r)),e:u.default.encoder.encodeBase64Url((0,l.pruneLeadingZeros)(n))}}e.privateKey=d.decode(e.privateKey,"der");var o={};o.modulus=e.privateKey.modulus;var s,a=(s=o.modulus.byteLength())%128==0?s:s+(128-s%128);return o.modulus=new Uint8Array(o.modulus.toArray("be",a)),o.publicExponent=new Uint8Array(e.privateKey.publicExponent.toArray("be",e.privateKey.publicExponent.byteLength())),o.privateExponent=new Uint8Array(e.privateKey.privateExponent.toArray("be",a)),["prime1","prime2","exponent1","exponent2","coefficient"].forEach((function(t){o[t]=new Uint8Array(e.privateKey[t].toArray("be",a>>1))})),{kty:"RSA",n:u.default.encoder.encodeBase64Url((0,l.pruneLeadingZeros)(o.modulus)),e:u.default.encoder.encodeBase64Url((0,l.pruneLeadingZeros)(o.publicExponent)),d:u.default.encoder.encodeBase64Url((0,l.pruneLeadingZeros)(o.privateExponent)),p:u.default.encoder.encodeBase64Url((0,l.pruneLeadingZeros)(o.prime1)),q:u.default.encoder.encodeBase64Url((0,l.pruneLeadingZeros)(o.prime2)),dp:u.default.encoder.encodeBase64Url((0,l.pruneLeadingZeros)(o.exponent1)),dq:u.default.encoder.encodeBase64Url((0,l.pruneLeadingZeros)(o.exponent2)),qi:u.default.encoder.encodeBase64Url((0,l.pruneLeadingZeros)(o.coefficient))}};var h=a.default.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())})),d=a.default.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int(),this.key("otherPrimeInfos").optional().use(p))})),p=a.default.define("OtherPrimeInfos",(function(){this.seqof(y)})),y=a.default.define("OtherPrimeInfo",(function(){this.seq().obj(this.key("prime").int(),this.key("exponent").int(),this.key("coefficient").int())}))},8237:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.toJwkFrom=t.fromJwkTo=void 0;var u=o(r(3780)),c=o(r(4571));t.fromJwkTo=function(e,t,r){return void 0===e&&(e="pem"),void 0===r&&(r={}),s(void 0,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:if("EC"!==t.kty&&"RSA"!==t.kty)throw new Error("UnsupportedKeyType");return"EC"===t.kty&&void 0===r.compact&&(r.compact=!1),"oct"===e&&"string"!==r.output&&(r.output="binary"),void 0===r.encryptParams&&(r.encryptParams={passphrase:""}),"der"!==e&&"pem"!==e||void 0!==r.encryptParams.passphrase||(r.encryptParams.passphrase=""),"der"!==e&&"pem"!==e?[3,2]:[4,u.fromJwk(t,e,{outputPublic:r.outputPublic,compact:r.compact,encOptions:r.encryptParams})];case 1:return[2,n.sent()];case 2:if("oct"===e&&"EC"===t.kty)return[2,c.fromJwk(t,{outputPublic:r.outputPublic,outputFormat:r.output,compact:r.compact})];throw new Error("UnsupportedConversion");case 3:return[2]}}))}))},t.toJwkFrom=function(e,t,r){return void 0===r&&(r={}),s(void 0,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:if("oct"===e&&!r.namedCurve)throw new Error("InappropriateOptions");return"der"!==e&&"pem"!==e||void 0!==r.passphrase||(r.passphrase=""),"der"!==e&&"pem"!==e?[3,2]:[4,u.toJwk(t,e,{outputPublic:r.outputPublic,passphrase:r.passphrase})];case 1:return[2,n.sent()];case 2:if("oct"===e)return[2,c.toJwk(t,r.namedCurve,{outputPublic:r.outputPublic})];throw new Error("UnsupportedConversion");case 3:return[2]}}))}))}},1402:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Key=void 0;var s=o(r(7423));t.Key=s.Key,t.default={Key:t.Key}},7423:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Key=void 0;var s=r(8237),a=r(3066),u=o(r(4471)),c=r(792),f=r(2323),l=function(){function e(e,t,r){void 0===r&&(r={});var n=f(t),i=f(r);if(this._type=null,this._jwk=null,this._der=null,this._oct={},this._isEncrypted=!1,this._current={jwk:!1,der:!1,oct:!1},"jwk"===e)this._setJwk(n);else if("der"===e||"pem"===e){if("der"===e&&!(n instanceof Uint8Array))throw new Error("DerKeyMustBeUint8Array");if("pem"===e&&"string"!=typeof n)throw new Error("PemKeyMustBeString");this._setAsn1(n,e)}else{if("oct"!==e)throw new Error("UnsupportedType");if("string"!=typeof i.namedCurve)throw new Error("namedCurveMustBeSpecified");if(!(n instanceof Uint8Array))throw new Error("OctetKeyMustBeUint8Array");this._setSec1(n,i.namedCurve)}}return e.prototype._setJwk=function(e){this._type=(0,c.getJwkType)(e),this._jwk=e,this._isEncrypted&&(this._der=null),this._isEncrypted=!1,this._setCurrentStatus()},e.prototype._setAsn1=function(e,t){this._type=(0,c.isAsn1Public)(e,t)?"public":"private",this._isEncrypted=(0,c.isAsn1Encrypted)(e,t),this._der="pem"===t?u.default.formatter.pemToBin(e):e,this._isEncrypted&&(this._jwk=null,this._oct={}),this._setCurrentStatus()},e.prototype._setSec1=function(e,t){this._type=(0,c.getSec1KeyType)(e,t),this._oct={namedCurve:t,key:e},this._isEncrypted&&(this._der=null),this._isEncrypted=!1,this._setCurrentStatus()},e.prototype._setCurrentStatus=function(){this._current.jwk=null!==this._jwk&&("RSA"===this._jwk.kty||"EC"===this._jwk.kty),this._current.der=null!==this._der&&this._der.length>0,this._current.oct=void 0!==this._oct.key&&void 0!==this._oct.namedCurve&&this._oct.key.length>0},e.prototype.export=function(e,t){return void 0===e&&(e="jwk"),void 0===t&&(t={}),n(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:if(this._isEncrypted&&"private"===this._type){if("der"!==e&&"pem"!==e||0!==Object.keys(t).length||!this._current.der)throw new Error("DecryptionRequired");return[2,"pem"===e?u.default.formatter.binToPem(this._der,"encryptedPrivate"):this._der]}return this._current.jwk?(r=this._jwk,[3,6]):[3,1];case 1:return this._current.oct?[4,(0,s.toJwkFrom)("oct",this._oct.key,{namedCurve:this._oct.namedCurve})]:[3,3];case 2:case 4:return r=n.sent(),[3,6];case 3:return this._current.der?[4,(0,s.toJwkFrom)("der",this._der)]:[3,5];case 5:throw new Error("InvalidStatus");case 6:return this._setJwk(r),"der"!==e&&"pem"!==e?[3,8]:[4,(0,s.fromJwkTo)(e,r,{outputPublic:t.outputPublic,compact:t.compact,encryptParams:t.encryptParams})];case 7:case 9:return[2,n.sent()];case 8:return"oct"!==e?[3,10]:[4,(0,s.fromJwkTo)(e,r,{outputPublic:t.outputPublic,output:t.output,compact:t.compact})];case 10:return[2,r]}}))}))},e.prototype.encrypt=function(e){return n(this,void 0,void 0,(function(){var t,r;return i(this,(function(n){switch(n.label){case 0:if(this._isEncrypted)throw new Error("AlreadyEncrypted");return t={encryptParams:{passphrase:e}},r=this._setAsn1,[4,this.export("der",t)];case 1:return r.apply(this,[n.sent(),"der"]),[2,!0]}}))}))},e.prototype.decrypt=function(e){return n(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:if(!this._isEncrypted)throw new Error("NotEncrypted");return this._current.der?[4,(0,s.toJwkFrom)("der",this._der,{passphrase:e})]:[3,2];case 1:return t=r.sent(),[3,3];case 2:throw new Error("FailedToDecrypt");case 3:return this._setJwk(t),[2,!0]}}))}))},e.prototype.getJwkThumbprint=function(e,t){return void 0===e&&(e="SHA-256"),void 0===t&&(t="binary"),n(this,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:if(this._isEncrypted)throw new Error("DecryptionRequired");return r=a.getJwkThumbprint,[4,this.export("jwk")];case 1:return[4,r.apply(void 0,[n.sent(),e,t])];case 2:return[2,n.sent()]}}))}))},Object.defineProperty(e.prototype,"keyType",{get:function(){var e=this;if(this._isEncrypted)throw new Error("DecryptionRequired");return new Promise((function(t,r){e.export("jwk").then((function(e){t(e.kty)})).catch((function(e){r(e)}))}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"jwkThumbprint",{get:function(){return this.getJwkThumbprint()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEncrypted",{get:function(){return this._isEncrypted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPrivate",{get:function(){return"private"===this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"der",{get:function(){return this.export("der")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pem",{get:function(){return this.export("pem")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"jwk",{get:function(){return this.export("jwk")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oct",{get:function(){return this.export("oct",{output:"string"})},enumerable:!1,configurable:!0}),e}();t.Key=l},4571:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toJwk=t.fromJwk=void 0;var a=o(r(1252)),u=s(r(4471)),c=o(r(4365)),f=r(792),l=c.ec;t.fromJwk=function(e,t){var r=t.outputPublic,n=t.outputFormat,i=void 0===n?"binary":n,o=t.compact,s=void 0!==o&&o,a=(0,f.getJwkType)(e);if("public"===("boolean"==typeof r&&r?"public":a)){var c=u.default.encoder.decodeBase64Url(e.x),l=u.default.encoder.decodeBase64Url(e.y),h=void 0;return s?((h=new Uint8Array(c.length+1))[0]=255&2+(1&l.slice(-1)[0]),h.set(c,1)):((h=new Uint8Array(c.length+l.length+1))[0]=4,h.set(c,1),h.set(l,c.length+1)),"string"===i?u.default.encoder.arrayBufferToHexString(h):h}if(!e.d)throw new Error("InvalidKey");var d=u.default.encoder.decodeBase64Url(e.d);return"string"===i?u.default.encoder.arrayBufferToHexString(d):d},t.toJwk=function(e,t,r){var n=r.outputPublic;if(Object.keys(a.namedCurves).indexOf(t)<0)throw new Error("UnsupportedCurve");var i=(0,f.getSec1KeyType)(e,t),o="boolean"==typeof n&&n?"public":i,s="string"==typeof e?u.default.encoder.hexStringToArrayBuffer(e):e,c=a.namedCurves[t].indutnyName,h=new l(c),d="public"===i?h.keyFromPublic(s):h.keyFromPrivate(s),p=new Uint8Array(d.getPublic("array")),y=a.namedCurves[t].payloadSize,b=p.slice(1,y+1),v=p.slice(y+1,2*y+1),g={kty:"EC",crv:t,x:u.default.encoder.encodeBase64Url(b),y:u.default.encoder.encodeBase64Url(v)};return"private"===o&&(g.d=u.default.encoder.encodeBase64Url(s)),g}},1252:(e,t)=>{"use strict";function r(e,t){return Object.keys(t).filter((function(r){return t[r].oid.toString()===e.toString()}))}Object.defineProperty(t,"__esModule",{value:!0}),t.getAlgorithmFromOidStrict=t.getAlgorithmFromOid=t.hashes=t.encryptionSchemes=t.pbkdf2Prfs=t.keyDerivationFunctions=t.passwordBasedEncryptionSchemes=t.publicKeyAlgorithms=t.namedCurves=void 0,t.namedCurves={"P-256":{indutnyName:"p256",payloadSize:32,oid:[1,2,840,10045,3,1,7]},"P-384":{indutnyName:"p384",payloadSize:48,oid:[1,3,132,0,34]},"P-521":{indutnyName:"p521",payloadSize:66,oid:[1,3,132,0,35]},"P-256K":{indutnyName:"secp256k1",payloadSize:32,oid:[1,3,132,0,10]}},t.publicKeyAlgorithms={EC:{oid:[1,2,840,10045,2,1]},RSA:{oid:[1,2,840,113549,1,1,1]}},t.passwordBasedEncryptionSchemes={"pbeWithMD5AndDES-CBC":{oid:[1,2,840,113549,1,5,3],hash:"MD5",encrypt:"DES-CBC"},"pbeWithSHA1AndDES-CBC":{oid:[1,2,840,113549,1,5,10],hash:"SHA-1",encrypt:"DES-CBC"},pbes2:{oid:[1,2,840,113549,1,5,13]}},t.keyDerivationFunctions={pbkdf2:{oid:[1,2,840,113549,1,5,12],defaultSaltLen:8}},t.pbkdf2Prfs={hmacWithSHA1:{oid:[1,2,840,113549,2,7],hash:"SHA-1"},hmacWithSHA256:{oid:[1,2,840,113549,2,9],hash:"SHA-256"},hmacWithSHA384:{oid:[1,2,840,113549,2,10],hash:"SHA-384"},hmacWithSHA512:{oid:[1,2,840,113549,2,11],hash:"SHA-512"}},t.encryptionSchemes={"des-ede3-cbc":{oid:[1,2,840,113549,3,7],keyLength:24,ivLength:8},"aes128-cbc":{oid:[2,16,840,1,101,3,4,1,2],keyLength:16,ivLength:16},"aes192-cbc":{oid:[2,16,840,1,101,3,4,1,22],keyLength:24,ivLength:16},"aes256-cbc":{oid:[2,16,840,1,101,3,4,1,42],keyLength:32,ivLength:16}},t.hashes={"SHA-256":{hashSize:32},"SHA-384":{hashSize:48},"SHA-512":{hashSize:64},"SHA-1":{hashSize:20},MD5:{hashSize:16}},t.getAlgorithmFromOid=r,t.getAlgorithmFromOidStrict=function(e,t){var n=r(e,t);if(0===n.length)throw new Error("UnsupportedAlgorithm");return n[0]}},8482:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decryptEncryptedPrivateKeyInfo=t.encryptEncryptedPrivateKeyInfo=void 0;var c=o(r(1252)),f=r(5807),l=u(r(4833)),h=o(r(5872)),d=u(r(2993)),p=u(r(4471)),y=u(r(1914)),b=u(r(8683)),v=u(r(3669)),g=h.Buffer,m=d.default.bignum;t.encryptEncryptedPrivateKeyInfo=function(e,t){return void 0===t&&(t={passphrase:""}),s(void 0,void 0,void 0,(function(){var r,n;return a(this,(function(i){switch(i.label){case 0:return void 0===t.algorithm&&(t.algorithm="pbes2"),void 0===t.iterationCount&&(t.iterationCount=2048),"pbes2"!==t.algorithm?[3,2]:(void 0===t.cipher&&(t.cipher="aes256-cbc"),void 0===t.prf&&(t.prf="hmacWithSHA256"),[4,A(e,t.passphrase,"pbkdf2",t.prf,t.iterationCount,t.cipher)]);case 1:return r=i.sent(),[2,w(r)];case 2:return[4,M(e,t.passphrase,t.algorithm,t.iterationCount)];case 3:return(n=i.sent()).encryptionAlgorithm.algorithm=c.passwordBasedEncryptionSchemes[n.encryptionAlgorithm.algorithm].oid,n.encryptionAlgorithm.parameters=f.PBEParameter.encode(n.encryptionAlgorithm.parameters,"der"),[2,f.EncryptedPrivateKeyInfo.encode(n,"der")]}}))}))},t.decryptEncryptedPrivateKeyInfo=function(e,t){return s(void 0,void 0,void 0,(function(){var r;return a(this,(function(n){switch(n.label){case 0:return(r={}).encryptionAlgorithm={algorithm:c.getAlgorithmFromOidStrict(e.encryptionAlgorithm.algorithm,c.passwordBasedEncryptionSchemes)},"pbes2"===r.encryptionAlgorithm.algorithm?r.encryptionAlgorithm.parameters=S(e.encryptionAlgorithm.parameters):r.encryptionAlgorithm.parameters=f.PBEParameter.decode(e.encryptionAlgorithm.parameters,"der"),r.encryptedData=e.encryptedData,"pbes2"!==r.encryptionAlgorithm.algorithm?[3,2]:[4,_(r,t)];case 1:case 3:return[2,n.sent()];case 2:return[4,k(r,t)]}}))}))};var w=function(e){var t={encryptionAlgorithm:{}};t.encryptionAlgorithm.algorithm=c.passwordBasedEncryptionSchemes[e.encryptionAlgorithm.algorithm].oid;var r=e.encryptionAlgorithm.parameters.keyDerivationFunc;if("pbkdf2"!==r.algorithm)throw new Error("UnsupportedKDF");r.parameters.prf.algorithm=c.pbkdf2Prfs[r.parameters.prf.algorithm].oid,r.parameters=f.PBKDF2Params.encode(r.parameters,"der"),r.algorithm=c.keyDerivationFunctions[r.algorithm].oid;var n=e.encryptionAlgorithm.parameters.encryptionScheme;if(!(Object.keys(f.PBES2ESParams).indexOf(n.algorithm)>=0))throw new Error("UnsupportedCipher");return n.parameters=f.PBES2ESParams[n.algorithm].encode(n.parameters,"der"),n.algorithm=c.encryptionSchemes[n.algorithm].oid,t.encryptionAlgorithm.parameters=f.PBES2Params.encode({keyDerivationFunc:r,encryptionScheme:n},"der"),t.encryptedData=e.encryptedData,f.EncryptedPrivateKeyInfo.encode(t,"der")},S=function(e){var t,r,n,i=f.PBES2Params.decode(e,"der"),o=c.getAlgorithmFromOidStrict(i.keyDerivationFunc.algorithm,c.keyDerivationFunctions);if("pbkdf2"!==o)throw new Error("UnsupportedKDF");var s=f.PBKDF2Params.decode(i.keyDerivationFunc.parameters,"der");n={algorithm:c.getAlgorithmFromOidStrict(s.prf.algorithm,c.pbkdf2Prfs),parameters:s.prf.parameters},t=s.iterationCount,r={type:s.salt.type,value:s.salt.value};var a=c.getAlgorithmFromOidStrict(i.encryptionScheme.algorithm,c.encryptionSchemes);if(!(Object.keys(f.PBES2ESParams).indexOf(a)>=0))throw new Error("UnsupportedCipher");return{keyDerivationFunc:{algorithm:o,parameters:{salt:r,iterationCount:t,prf:n}},encryptionScheme:{algorithm:a,parameters:f.PBES2ESParams[a].decode(i.encryptionScheme.parameters,"der")}}},A=function(e,t,r,n,i,o){return s(void 0,void 0,void 0,(function(){var s,u,f,h,d,w,S,A,_,M,k,x;return a(this,(function(a){switch(a.label){case 0:return s=p.default.encoder.stringToArrayBuffer(t),[4,v.default.getRandomBytes(c.keyDerivationFunctions[r].defaultSaltLen)];case 1:return u=a.sent(),f=c.encryptionSchemes[o].keyLength,"pbkdf2"!==r?[3,3]:[4,y.default.pbkdf2(s,u,i,f,c.pbkdf2Prfs[n].hash)];case 2:return h=a.sent(),[3,4];case 3:throw new Error("UnsupportedKDF");case 4:return"des-ede3-cbc"!==o?[3,6]:(A=(S=g).from,[4,v.default.getRandomBytes(c.encryptionSchemes[o].ivLength)]);case 5:return d=A.apply(S,[a.sent()]),_=l.default.CBC.instantiate(l.default.EDE),M=_.create({type:"encrypt",key:g.from(h),iv:d}),w=g.from(M.update(e).concat(M.final())),[3,10];case 6:return"aes128-cbc"!==o&&"aes192-cbc"!==o&&"aes256-cbc"!==o?[3,9]:[4,v.default.getRandomBytes(c.encryptionSchemes[o].ivLength)];case 7:return d=a.sent(),x=(k=g).from,[4,b.default.encrypt(new Uint8Array(e),h,{name:"AES-CBC",iv:d})];case 8:return w=x.apply(k,[a.sent()]),d=g.from(d),[3,10];case 9:throw new Error("UnsupportedCipher");case 10:return[2,{encryptedData:w,encryptionAlgorithm:{algorithm:"pbes2",parameters:{keyDerivationFunc:{algorithm:r,parameters:{salt:{type:"specified",value:g.from(u)},iterationCount:new m(i),prf:{algorithm:n,parameters:g.from([5,0])}}},encryptionScheme:{algorithm:o,parameters:d}}}}]}}))}))},_=function(e,t){return s(void 0,void 0,void 0,(function(){var r,n,i,o,s,u,h,d,v,m,w,S,A,_;return a(this,(function(a){switch(a.label){case 0:if(r=e.encryptionAlgorithm.parameters.keyDerivationFunc,n=e.encryptionAlgorithm.parameters.encryptionScheme,i=c.encryptionSchemes[n.algorithm].keyLength,"pbkdf2"!==r.algorithm)return[3,2];if(s=p.default.encoder.stringToArrayBuffer(t),"specified"!==r.parameters.salt.type)throw new Error("UnsupportedSaltSource");return u=new Uint8Array(r.parameters.salt.value),h=r.parameters.iterationCount.toNumber(),d=r.parameters.prf.algorithm,[4,y.default.pbkdf2(s,u,h,i,c.pbkdf2Prfs[d].hash)];case 1:return o=a.sent(),[3,3];case 2:throw new Error("UnsupportedKDF");case 3:return"des-ede3-cbc"!==n.algorithm?[3,4]:(S=n.parameters,m=l.default.CBC.instantiate(l.default.EDE),w=m.create({type:"decrypt",key:o,iv:S}),v=g.from(w.update(e.encryptedData).concat(w.final())),[3,7]);case 4:return"aes128-cbc"!==n.algorithm&&"aes192-cbc"!==n.algorithm&&"aes256-cbc"!==n.algorithm?[3,6]:(S=new Uint8Array(n.parameters),_=(A=g).from,[4,b.default.decrypt(new Uint8Array(e.encryptedData),o,{name:"AES-CBC",iv:S})]);case 5:return v=_.apply(A,[a.sent()]),[3,7];case 6:throw new Error("UnsupportedEncryptionAlgorithm");case 7:return[2,f.OneAsymmetricKey.decode(v,"der")]}}))}))},M=function(e,t,r,n){return s(void 0,void 0,void 0,(function(){var i,o,s,u,f,h,d,b,w;return a(this,(function(a){switch(a.label){case 0:return i=p.default.encoder.stringToArrayBuffer(t),[4,v.default.getRandomBytes(8)];case 1:return o=a.sent(),s=c.passwordBasedEncryptionSchemes[r].hash,[4,y.default.pbkdf1(i,o,n,16,s)];case 2:if(u=a.sent(),f=u.slice(0,8),h=u.slice(8,16),"DES-CBC"!==c.passwordBasedEncryptionSchemes[r].encrypt)throw new Error("UnsupportedEncryptionAlgorithm");return b=l.default.CBC.instantiate(l.default.DES),w=b.create({type:"encrypt",key:f,iv:h}),d=g.from(w.update(e).concat(w.final())),[2,{encryptionAlgorithm:{algorithm:r,parameters:{salt:g.from(o),iterationCount:new m(n)}},encryptedData:d}]}}))}))},k=function(e,t){return s(void 0,void 0,void 0,(function(){var r,n,i,o,s,u,h,d,b,v;return a(this,(function(a){switch(a.label){case 0:return r=p.default.encoder.stringToArrayBuffer(t),n=new Uint8Array(e.encryptionAlgorithm.parameters.salt),i=c.passwordBasedEncryptionSchemes[e.encryptionAlgorithm.algorithm].hash,o=e.encryptionAlgorithm.parameters.iterationCount.toNumber(),[4,y.default.pbkdf1(r,n,o,16,i)];case 1:if(s=a.sent(),u=s.slice(0,8),h=s.slice(8,16),"DES-CBC"!==c.passwordBasedEncryptionSchemes[e.encryptionAlgorithm.algorithm].encrypt)throw new Error("UnsupportedEncryptionAlgorithm");return b=l.default.CBC.instantiate(l.default.DES),v=b.create({type:"decrypt",key:u,iv:h}),d=g.from(v.update(e.encryptedData).concat(v.final())),[2,f.OneAsymmetricKey.decode(d,"der")]}}))}))}},3066:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getJwkThumbprint=void 0;var c=u(r(4471)),f=u(r(3249)),l=o(r(5872)).Buffer;t.getJwkThumbprint=function(e,t,r){return void 0===t&&(t="SHA-256"),void 0===r&&(r="binary"),s(void 0,void 0,void 0,(function(){var n,i,o;return a(this,(function(s){switch(s.label){case 0:if(["hex","binary"].indexOf(r)<0)throw new Error("UnsupportedOutputFormat");if("EC"===e.kty)n=JSON.stringify({crv:e.crv,kty:e.kty,x:e.x,y:e.y});else{if("RSA"!==e.kty)throw new Error("UnsupportedKeyType");n=JSON.stringify({e:e.e,kty:e.kty,n:e.n})}return i=new Uint8Array(l.from(n,"utf8")),[4,f.default.compute(i,t)];case 1:return o=s.sent(),"hex"===r?[2,c.default.encoder.arrayBufferToHexString(o)]:"base64"===r?[2,c.default.encoder.encodeBase64(o)]:[2,o]}}))}))}},792:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.appendLeadingZeros=t.pruneLeadingZeros=t.getJwkType=t.getSec1KeyType=t.getAsn1KeyType=t.isAsn1Public=t.isAsn1Encrypted=void 0;var a=s(r(4471)),u=o(r(1252)),c=r(5807);t.isAsn1Encrypted=function(e,r){var n;void 0===r&&(r="pem");try{n=(0,t.getAsn1KeyType)(e,r)}catch(e){return!1}return"encryptedPrivate"===n},t.isAsn1Public=function(e,r){var n;void 0===r&&(r="pem");try{n=(0,t.getAsn1KeyType)(e,r)}catch(e){return!1}return"public"===n},t.getAsn1KeyType=function(e,t){void 0===t&&(t="pem");var r="pem"===t?a.default.formatter.pemToBin(e):e,n=c.KeyStructure.decode(Buffer.from(r),"der");if("encryptedPrivateKeyInfo"===n.type)return"encryptedPrivate";if("oneAsymmetricKey"===n.type)return"private";if("subjectPublicKeyInfo"===n.type)return"public";throw new Error("NotSpkiNorPkcs8Key")},t.getSec1KeyType=function(e,t){var r=u.namedCurves[t].payloadSize,n=e instanceof Uint8Array?e:a.default.encoder.hexStringToArrayBuffer(e);if(n.length<=r)return"private";if(n.length===2*r+1&&4===n[0]||n.length===r+1&&(2===n[0]||3===n[0]))return"public";throw new Error("UnsupportedKeyStructure")},t.getJwkType=function(e){if("EC"===e.kty){if(e.x&&e.y&&e.d)return"private";if(e.x&&e.y)return"public";throw new Error("InvalidECKey")}if("RSA"===e.kty){if(e.n&&e.e&&e.d&&e.p&&e.q&&e.dp&&e.dq&&e.qi)return"private";if(e.n&&e.e)return"public";throw new Error("InvalidRSAKey")}throw new Error("UnsupportedJWKType")},t.pruneLeadingZeros=function(e){for(var t=0,r=0;r<e.length&&0===e[r];r++)t++;var n=new Uint8Array(e.length-t);return n.set(e.slice(t,e.length)),n},t.appendLeadingZeros=function(e,t){if(e.length>t)throw new Error("InvalidLength");var r=new Uint8Array(t);return r.set(e,t-e.length),r}},1914:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.pbkdf1=t.pbkdf2=void 0;var s=o(r(9282));t.pbkdf2=s.pbkdf2,t.pbkdf1=s.pbkdf1,t.default={pbkdf2:t.pbkdf2,pbkdf1:t.pbkdf1}},6601:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={hashes:{"SHA3-512":{hashSize:64},"SHA3-384":{hashSize:48},"SHA3-256":{hashSize:32},"SHA3-224":{hashSize:28},"SHA-256":{hashSize:32},"SHA-384":{hashSize:48},"SHA-512":{hashSize:64},"SHA-1":{hashSize:20},MD5:{hashSize:16}}}},9282:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.pbkdf1=t.pbkdf2=void 0;var s=o(r(4471)),a=o(r(3249)),u=o(r(2955)),c=o(r(6601));t.pbkdf2=function(e,t,r,o,a){return n(void 0,void 0,void 0,(function(){var l,h,d,p,y,b,v,g;return i(this,(function(m){switch(m.label){case 0:if(r<=0)throw new Error("InvalidIterationCount");if(o<=0)throw new Error("InvalidDerivedKeyLength");if(l="string"==typeof e?s.default.encoder.stringToArrayBuffer(e):e,h=c.default.hashes[a].hashSize,o>(Math.pow(2,32)-1)*h)throw new Error("DerivedKeyTooLong");for(d=Math.ceil(o/h),p=o-(d-1)*h,y=function(e){return n(void 0,void 0,void 0,(function(){var n,o,s,c;return i(this,(function(i){switch(i.label){case 0:return(n=new Uint8Array(t.length+4)).set(t),n.set(f(e+1,4),t.length),[4,u.default.compute(l,n,a)];case 1:o=i.sent(),s=new Uint8Array(o),c=1,i.label=2;case 2:return c<r?[4,u.default.compute(l,o,a)]:[3,5];case 3:o=i.sent(),s=o.map((function(e,t){return e^s[t]})),i.label=4;case 4:return c++,[3,2];case 5:return[2,{index:e,value:s}]}}))}))},b=[],v=new Uint8Array(o),g=0;g<d;g++)b.push(y(g));return[4,Promise.all(b)];case 1:return m.sent().forEach((function(e){e.index!==d-1?v.set(e.value,e.index*h):v.set(e.value.slice(0,p),e.index*h)})),[2,v]}}))}))};var f=function(e,t){for(var r=new Uint8Array(t),n=0;n<t;n++)r[n]=e>>8*(t-n-1);return r};t.pbkdf1=function(e,t,r,o,u){return n(void 0,void 0,void 0,(function(){var n,f;return i(this,(function(i){switch(i.label){case 0:if(r<=0)throw new Error("InvalidIterationCount");if(o<=0)throw new Error("InvalidDerivedKeyLength");if("string"==typeof e&&(e=s.default.encoder.stringToArrayBuffer(e)),o>c.default.hashes[u].hashSize)throw new Error("DerivedKeyTooLong");(n=new Uint8Array(e.length+t.length)).set(e),n.set(t,e.length),f=0,i.label=1;case 1:return f<r?[4,a.default.compute(n,u)]:[3,4];case 2:n=i.sent(),i.label=3;case 3:return f++,[3,1];case 4:return[2,n.slice(0,o)]}}))}))}},3669:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomSampledString=t.getRandomString=t.getRandomAsciiString=t.getRandomBytes=void 0;var s=o(r(706));t.getRandomBytes=s.getRandomBytes,t.getRandomAsciiString=s.getRandomAsciiString,t.getRandomString=s.getRandomString,t.getRandomSampledString=s.getRandomSampledString,t.default={getRandomBytes:t.getRandomBytes,getRandomAsciiString:t.getRandomAsciiString,getRandomString:t.getRandomString,getRandomSampledString:t.getRandomSampledString}},706:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomBytes=t.getRandomSampledString=t.getRandomAsciiString=t.getRandomString=void 0;var s=o(r(6852));t.getRandomString=function(e){for(var r=(0,t.getRandomBytes)(e),n=(0,t.getRandomBytes)(e),i="",o=0;o<e;o++)n[o]=n[o]%3,r[o]=0===n[o]?r[o]%10+48:r[o]%26+(1===n[o]?65:97),i+=String.fromCharCode(r[o]);return i},t.getRandomAsciiString=function(e){for(var r=(0,t.getRandomBytes)(e),n="",i=0;i<e;i++)r[i]=r[i]%94+32,n+=String.fromCharCode(r[i]);return n},t.getRandomSampledString=function(e,r){var n=r.length;if(0===n)return"";for(var i=(0,t.getRandomBytes)(e),o="",s=0;s<e;s++)o+=r[i[s]%n];return o},t.getRandomBytes=function(e){var t=s.getRootWebCrypto(),r=s.getNodeCrypto();if(void 0!==t&&"function"==typeof t.getRandomValues){var n=new Uint8Array(e);return t.getRandomValues(n),n}if(void 0!==r)return new Uint8Array(r.randomBytes(e));throw new Error("UnsupportedEnvironment")}},5414:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=t.verify=t.sign=t.generateKey=void 0;var s=o(r(4582));t.generateKey=s.generateKey,t.sign=s.sign,t.verify=s.verify,t.encrypt=s.encrypt,t.decrypt=s.decrypt,t.default={generateKey:t.generateKey,sign:t.sign,verify:t.verify,encrypt:t.encrypt,decrypt:t.decrypt}},4886:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decryptRsa=t.encryptRsa=t.verifyRsa=t.signRsa=t.generateKey=void 0;var c=o(r(4133)),f=r(1402),l=u(r(4471)),h=o(r(6567)),d=r(9098);r(5872),t.generateKey=function(e,t,r){return s(void 0,void 0,void 0,(function(){var n,i,o,s,u,c;return a(this,(function(a){switch(a.label){case 0:return n=new d(t),i={modulusLength:e,publicExponent:n.toNumber(),publicKeyEncoding:{type:"spki",format:"der"},privateKeyEncoding:{type:"pkcs8",format:"der"}},[4,new Promise((function(e,t){r.generateKeyPair("rsa",i,(function(r,n,i){r?t("KeyGenerationFailedNode"):e({publicKey:n,privateKey:i})}))})).catch((function(){throw new Error("KeyGenerationFailedNode")}))];case 1:return o=a.sent(),s=new f.Key("der",new Uint8Array(o.publicKey)),u=new f.Key("der",new Uint8Array(o.privateKey)),c={},[4,s.export("jwk")];case 2:return c.publicKey=a.sent(),[4,u.export("jwk")];case 3:return[2,(c.privateKey=a.sent(),c)]}}))}))},t.signRsa=function(e,t,r,n,i){return s(void 0,void 0,void 0,(function(){var o,s,u,l;return a(this,(function(a){switch(a.label){case 0:if(!(o=new f.Key("jwk",t)).isPrivate)throw new Error("NotPrivateKeyForRSASign");return[4,o.export("pem")];case 1:return s=a.sent(),(u=i.createSign(c.hashes[r].nodeName)).update(e),l="RSA-PSS"===n.name?{saltLength:n.saltLength,padding:i.constants.RSA_PKCS1_PSS_PADDING}:{},[2,new Uint8Array(u.sign(Object.assign({key:s},l)))]}}))}))},t.verifyRsa=function(e,t,r,n,i,o){return s(void 0,void 0,void 0,(function(){var s,u,l,h;return a(this,(function(a){switch(a.label){case 0:if((s=new f.Key("jwk",r)).isPrivate)throw new Error("NotPublicKeyForRSAVerify");return[4,s.export("pem",{outputPublic:!0})];case 1:return u=a.sent(),(l=o.createVerify(c.hashes[n].nodeName)).update(e),h="RSA-PSS"===i.name?{saltLength:i.saltLength,padding:o.constants.RSA_PKCS1_PSS_PADDING}:{},[2,l.verify(Object.assign({key:u},h),t)]}}))}))},t.encryptRsa=function(e,t,r,n,i){return void 0===r&&(r="SHA-256"),void 0===n&&(n=new Uint8Array([])),s(void 0,void 0,void 0,(function(){var o,s,u,c;return a(this,(function(a){switch(a.label){case 0:if((o=new f.Key("jwk",t)).isPrivate)throw new Error("NotPublicKeyForRSAEncrypt");return[4,o.export("pem",{outputPublic:!0})];case 1:return s=a.sent(),"SHA-1"!==r?[3,2]:(u=i.publicEncrypt({key:s,padding:i.constants.RSA_PKCS1_OAEP_PADDING},e),[3,4]);case 2:return[4,h.emeOaepEncode(e,n,l.default.encoder.decodeBase64Url(t.n).length,r)];case 3:c=a.sent(),u=i.publicEncrypt({key:s,padding:i.constants.RSA_NO_PADDING},c),a.label=4;case 4:return[2,new Uint8Array(u)]}}))}))},t.decryptRsa=function(e,t,r,n,i){return void 0===r&&(r="SHA-256"),void 0===n&&(n=new Uint8Array([])),s(void 0,void 0,void 0,(function(){var o,s,u,c;return a(this,(function(a){switch(a.label){case 0:if(!(o=new f.Key("jwk",t)).isPrivate)throw new Error("NotPrivateKeyForRSADecrypt");return[4,o.export("pem")];case 1:return s=a.sent(),"SHA-1"!==r?[3,2]:(u=i.privateDecrypt({key:s,padding:i.constants.RSA_PKCS1_OAEP_PADDING},e),[3,4]);case 2:return c=i.privateDecrypt({key:s,padding:i.constants.RSA_NO_PADDING},e),[4,h.emeOaepDecode(new Uint8Array(c),n,l.default.encoder.decodeBase64Url(t.n).length,r)];case 3:u=a.sent(),a.label=4;case 4:return[2,new Uint8Array(u)]}}))}))}},6567:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.emeOaepDecode=t.emeOaepEncode=t.checkLength=void 0;var c=o(r(4133)),f=u(r(3249)),l=u(r(3669));t.checkLength=function(e,t){var r=t.k,n=t.label,i=t.hash,o=t.mLen,s=t.cLen;if("encrypt"===e){if(n.length>(1<<c.hashes[i].maxInput)-1)throw new Error("LabelTooLong");if(o>r-2*c.hashes[i].hashSize-2)throw new Error("MessageTooLong")}else{if("decrypt"!==e)throw new Error("InvalidMode");if(n.length>(1<<c.hashes[i].maxInput)-1)throw new Error("DecryptionError");if(s!==r||r<2*c.hashes[i].hashSize+2)throw new Error("DecryptionError")}},t.emeOaepEncode=function(e,t,r,n){return void 0===n&&(n="SHA-256"),s(void 0,void 0,void 0,(function(){var i,o,s,u,d,p,y,b,v,g;return a(this,(function(a){switch(a.label){case 0:return i=c.hashes[n].hashSize,o=(o=new Uint8Array(r-e.length-2*i-2)).map((function(){return 0})),[4,f.default.compute(t,n)];case 1:return s=a.sent(),(u=new Uint8Array(r-i-1)).set(s),u.set(o,i),u.set(new Uint8Array([1]),r-e.length-i-2),u.set(e,r-e.length-i-1),[4,l.default.getRandomBytes(i)];case 2:return d=a.sent(),[4,h(d,r-i-1,n)];case 3:return p=a.sent(),y=u.map((function(e,t){return 255&(e^p[t])})),[4,h(y,i,n)];case 4:return b=a.sent(),v=d.map((function(e,t){return 255&(e^b[t])})),(g=new Uint8Array(r)).set(new Uint8Array([0])),g.set(v,1),g.set(y,i+1),[2,g]}}))}))},t.emeOaepDecode=function(e,t,r,n){return void 0===n&&(n="SHA-256"),s(void 0,void 0,void 0,(function(){var i,o,s,u,l,d,p,y,b,v;return a(this,(function(a){switch(a.label){case 0:return i=c.hashes[n].hashSize,[4,f.default.compute(t,n)];case 1:if(o=a.sent(),0!==e[0])throw new Error("DecryptionError");return s=e.slice(1,i+1),u=e.slice(i+1,e.length),[4,h(u,i,n)];case 2:return l=a.sent(),d=s.map((function(e,t){return 255&(e^l[t])})),[4,h(d,r-i-1,n)];case 3:if(p=a.sent(),(y=u.map((function(e,t){return 255&(e^p[t])}))).slice(0,i).toString()!==o.toString())throw new Error("DecryptionError");for(b=0,v=i;v<y.length;v++)if(0!==y[v]){b=v;break}if(1!==y[b])throw new Error("DecryptionError");return[2,y.slice(b+1,y.length)]}}))}))};var h=function(e,t,r){return void 0===r&&(r="SHA-256"),s(void 0,void 0,void 0,(function(){var n,i,o,s,u,l,h;return a(this,(function(a){switch(a.label){case 0:n=c.hashes[r].hashSize,i=Math.ceil(t/n),o=new Uint8Array(i*n),s=0,a.label=1;case 1:return s<i?(u=d(s,4),(l=new Uint8Array(e.length+4)).set(e),l.set(u,e.length),[4,f.default.compute(l,r)]):[3,4];case 2:h=a.sent(),o.set(h,s*n),a.label=3;case 3:return s++,[3,1];case 4:return[2,o.slice(0,t)]}}))}))},d=function(e,t){var r=new Uint8Array(t);return r.forEach((function(n,i){var o=255&e>>8*i;r[t-i-1]=o})),r}},4133:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hashes=void 0,t.hashes={"SHA-256":{nodeName:"sha256",hashSize:32,maxInput:61},"SHA-384":{nodeName:"sha384",hashSize:48,maxInput:125},"SHA-512":{nodeName:"sha512",hashSize:64,maxInput:125},"SHA-1":{nodeName:"sha1",hashSize:20,maxInput:61}}},4917:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.checkLength=void 0;var s=o(r(4133));t.checkLength=function(e,t){var r=t.k,n=t.hash,i=t.saltLength;if("sign"===e){if(r>(1<<s.hashes[n].maxInput)-1)throw new Error("Inconsistent");if(r<s.hashes[n].hashSize+i+2||i<0)throw new Error("EncodingError")}else{if("verify"!==e)throw new Error("InvalidMode");if(r>(1<<s.hashes[n].maxInput)-1)throw new Error("Inconsistent");if(r<s.hashes[n].hashSize+i+2||i<0)throw new Error("Inconsistent")}}},4582:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=t.verify=t.sign=t.generateKey=void 0;var c=o(r(6852)),f=u(r(4471)),l=o(r(1108)),h=o(r(4886)),d=o(r(4133)),p=r(6567),y=r(4917);t.generateKey=function(e,t){return void 0===e&&(e=2048),void 0===t&&(t=new Uint8Array([1,0,1])),s(void 0,void 0,void 0,(function(){var r,n,i,o;return a(this,(function(s){switch(s.label){case 0:r=c.getCrypto(),n=!1,s.label=1;case 1:return s.trys.push([1,7,,8]),"webCrypto"!==r.name||"function"!=typeof r.crypto.generateKey||"function"!=typeof r.crypto.exportKey?[3,3]:[4,l.generateKey(e,t,r.crypto)];case 2:return i=s.sent(),[3,6];case 3:return"nodeCrypto"!==r.name?[3,5]:[4,h.generateKey(e,t,r.crypto)];case 4:return i=s.sent(),[3,6];case 5:throw n=!0,new Error("UnsupportedPureJsEnvironment");case 6:return[2,i];case 7:throw(o=s.sent())instanceof Error?n?new Error(o.message):new Error("UnsupportedEnvironment: ".concat(o.message)):new Error("UnsupportedEnvironment");case 8:return[2]}}))}))},t.sign=function(e,t,r,n){return void 0===r&&(r="SHA-256"),void 0===n&&(n={name:"RSA-PSS",saltLength:d.hashes[r].hashSize}),s(void 0,void 0,void 0,(function(){var i,o,s,u;return a(this,(function(a){switch(a.label){case 0:if("RSA"!==t.kty)throw new Error("InvalidJwkRsaKey");"RSA-PSS"===n.name&&(0,y.checkLength)("sign",{k:f.default.encoder.decodeBase64Url(t.n).length,hash:r,saltLength:n.saltLength}),i=c.getCrypto(),o=!1,a.label=1;case 1:return a.trys.push([1,7,,8]),"webCrypto"!==i.name||"function"!=typeof i.crypto.sign||"function"!=typeof i.crypto.importKey?[3,3]:[4,l.signRsa(e,t,r,n,i.crypto)];case 2:return s=a.sent(),[3,6];case 3:return"nodeCrypto"!==i.name?[3,5]:[4,h.signRsa(e,t,r,n,i.crypto)];case 4:return s=a.sent(),[3,6];case 5:throw o=!0,new Error("UnsupportedPureJsEnvironment");case 6:return[2,s];case 7:throw(u=a.sent())instanceof Error?o?new Error(u.message):new Error("UnsupportedEnvironment: ".concat(u.message)):new Error("UnsupportedEnvironment");case 8:return[2]}}))}))},t.verify=function(e,t,r,n,i){return void 0===n&&(n="SHA-256"),void 0===i&&(i={name:"RSA-PSS",saltLength:d.hashes[n].hashSize}),s(void 0,void 0,void 0,(function(){var o,s,u,d;return a(this,(function(a){switch(a.label){case 0:if("RSA"!==r.kty)throw new Error("InvalidJwkRsaKey");"RSA-PSS"===i.name&&(0,y.checkLength)("verify",{k:f.default.encoder.decodeBase64Url(r.n).length,hash:n,saltLength:i.saltLength}),o=c.getCrypto(),s=!1,a.label=1;case 1:return a.trys.push([1,7,,8]),"webCrypto"!==o.name||"function"!=typeof o.crypto.verify||"function"!=typeof o.crypto.importKey?[3,3]:[4,l.verifyRsa(e,t,r,n,i,o.crypto)];case 2:return u=a.sent(),[3,6];case 3:return"nodeCrypto"!==o.name?[3,5]:[4,h.verifyRsa(e,t,r,n,i,o.crypto)];case 4:return u=a.sent(),[3,6];case 5:throw s=!0,new Error("UnsupportedPureJsEnvironment");case 6:return[2,u];case 7:throw(d=a.sent())instanceof Error?s?new Error(d.message):new Error("UnsupportedEnvironment: ".concat(d.message)):new Error("UnsupportedEnvironment");case 8:return[2]}}))}))},t.encrypt=function(e,t,r,n){return void 0===r&&(r="SHA-256"),void 0===n&&(n=new Uint8Array([])),s(void 0,void 0,void 0,(function(){var i,o,s,u;return a(this,(function(a){switch(a.label){case 0:if("RSA"!==t.kty)throw new Error("InvalidJwkRsaKey");(0,p.checkLength)("encrypt",{k:f.default.encoder.decodeBase64Url(t.n).length,label:n,hash:r,mLen:e.length,cLen:0}),i=c.getCrypto(),o=!1,a.label=1;case 1:return a.trys.push([1,7,,8]),"webCrypto"!==i.name||"function"!=typeof i.crypto.encrypt||"function"!=typeof i.crypto.importKey?[3,3]:[4,l.encryptRsa(e,t,r,n,i.crypto)];case 2:return s=a.sent(),[3,6];case 3:return"nodeCrypto"!==i.name?[3,5]:[4,h.encryptRsa(e,t,r,n,i.crypto)];case 4:return s=a.sent(),[3,6];case 5:throw o=!0,new Error("UnsupportedPureJsEnvironment");case 6:return[2,s];case 7:throw(u=a.sent())instanceof Error?o?new Error(u.message):new Error("UnsupportedEnvironment: ".concat(u.message)):new Error("UnsupportedEnvironment");case 8:return[2]}}))}))},t.decrypt=function(e,t,r,n){return void 0===r&&(r="SHA-256"),void 0===n&&(n=new Uint8Array([])),s(void 0,void 0,void 0,(function(){var i,o,s,u;return a(this,(function(a){switch(a.label){case 0:if("RSA"!==t.kty)throw new Error("InvalidJwkRsaKey");(0,p.checkLength)("decrypt",{k:f.default.encoder.decodeBase64Url(t.n).length,label:n,hash:r,mLen:0,cLen:e.length}),i=c.getCrypto(),o=!1,a.label=1;case 1:return a.trys.push([1,7,,8]),"webCrypto"!==i.name||"function"!=typeof i.crypto.decrypt||"function"!=typeof i.crypto.importKey?[3,3]:[4,l.decryptRsa(e,t,r,n,i.crypto)];case 2:return s=a.sent(),[3,6];case 3:return"nodeCrypto"!==i.name?[3,5]:[4,h.decryptRsa(e,t,r,n,i.crypto)];case 4:return s=a.sent(),[3,6];case 5:throw o=!0,new Error("UnsupportedPureJsEnvironment");case 6:return[2,s];case 7:throw(u=a.sent())instanceof Error?o?new Error(u.message):new Error("UnsupportedEnvironment: ".concat(u.message)):new Error("UnsupportedEnvironment");case 8:return[2]}}))}))}},1108:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.decryptRsa=t.encryptRsa=t.verifyRsa=t.signRsa=t.generateKey=void 0,t.generateKey=function(e,t,i){return r(void 0,void 0,void 0,(function(){var r,o,s,a;return n(this,(function(n){switch(n.label){case 0:return r={name:"RSA-OAEP",modulusLength:e,publicExponent:t,hash:{name:"SHA-256"}},[4,i.generateKey(r,!0,["encrypt","decrypt"])];case 1:return o=n.sent(),[4,i.exportKey("jwk",o.publicKey)];case 2:return s=n.sent(),[4,i.exportKey("jwk",o.privateKey)];case 3:return a=n.sent(),delete s.key_ops,delete s.alg,delete s.ext,delete a.key_ops,delete a.alg,delete a.ext,[2,{publicKey:s,privateKey:a}]}}))}))},t.signRsa=function(e,t,i,o,s){return r(this,void 0,void 0,(function(){var r,a,u;return n(this,(function(n){switch(n.label){case 0:return r={name:o.name,hash:{name:i},saltLength:o.saltLength},[4,s.importKey("jwk",t,r,!1,["sign"])];case 1:return a=n.sent(),[4,s.sign(r,a,e)];case 2:return u=n.sent(),[2,new Uint8Array(u)]}}))}))},t.verifyRsa=function(e,t,i,o,s,a){return r(void 0,void 0,void 0,(function(){var r,u;return n(this,(function(n){switch(n.label){case 0:return r={name:s.name,hash:{name:o},saltLength:s.saltLength},[4,a.importKey("jwk",i,r,!1,["verify"])];case 1:return u=n.sent(),[2,a.verify(r,u,t,e)]}}))}))},t.encryptRsa=function(e,t,i,o,s){return r(void 0,void 0,void 0,(function(){var r,a,u;return n(this,(function(n){switch(n.label){case 0:return r={name:"RSA-OAEP",hash:{name:i},label:o},[4,s.importKey("jwk",t,r,!1,["encrypt"])];case 1:return a=n.sent(),[4,s.encrypt(r,a,e)];case 2:return u=n.sent(),[2,new Uint8Array(u)]}}))}))},t.decryptRsa=function(e,t,i,o,s){return r(void 0,void 0,void 0,(function(){var r,a,u;return n(this,(function(n){switch(n.label){case 0:return r={name:"RSA-OAEP",hash:{name:i},label:o},[4,s.importKey("jwk",t,r,!1,["decrypt"])];case 1:return a=n.sent(),[4,s.decrypt(r,a,e)];case 2:return u=n.sent(),[2,new Uint8Array(u)]}}))}))}},5893:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.pbkdf=t.hkdf=t.hmac=t.hash=t.random=t.aes=t.x509=t.pkc=t.Key=void 0;var s=o(r(8683)),a=o(r(3669)),u=o(r(3249)),c=o(r(2955)),f=o(r(4097)),l=o(r(6222)),h=o(r(1914)),d=o(r(1402)),p=o(r(6264));t.Key=d.Key,t.pkc=p,t.x509=l,t.aes=s,t.random=a,t.hash=u,t.hmac=c,t.hkdf=f,t.pbkdf=h,t.default={Key:t.Key,pkc:t.pkc,x509:t.x509,aes:t.aes,random:t.random,hash:t.hash,hmac:t.hmac,hkdf:t.hkdf,pbkdf:t.pbkdf}},7230:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hashes=t.ciphers=void 0,t.ciphers={"AES-GCM":{ivLength:12},"AES-CTR":{ivLength:12},"AES-CBC":{ivLength:16},"AES-KW":{}},t.hashes={"SHA3-512":{hashSize:64},"SHA3-384":{hashSize:48},"SHA3-256":{hashSize:32},"SHA3-224":{hashSize:28},"SHA-256":{hashSize:32},"SHA-384":{hashSize:48},"SHA-512":{hashSize:64},"SHA-1":{hashSize:20}}},6264:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=t.verify=t.sign=t.generateKey=void 0;var c=u(r(6432)),f=u(r(5414)),l=r(1402),h=o(r(1766)),d=o(r(7230)),p=r(2323);t.generateKey=function(e,t){return void 0===e&&(e="EC"),s(void 0,void 0,void 0,(function(){var r,n;return a(this,(function(i){switch(i.label){case 0:return r=p(t),"EC"!==e?[3,2]:[4,c.default.generateKey(r.namedCurve)];case 1:case 3:return n=i.sent(),[3,5];case 2:return"RSA"!==e?[3,4]:(void 0===r.publicExponent&&(r.publicExponent=new Uint8Array([1,0,1])),[4,f.default.generateKey(r.modulusLength,r.publicExponent)]);case 4:throw new Error("UnsupportedKeyType");case 5:return[2,{publicKey:new l.Key("jwk",n.publicKey),privateKey:new l.Key("jwk",n.privateKey)}]}}))}))},t.sign=function(e,t,r,n){return void 0===r&&(r="SHA-256"),void 0===n&&(n=void 0),s(void 0,void 0,void 0,(function(){var i,o,s;return a(this,(function(a){switch(a.label){case 0:if(!(t instanceof l.Key))throw new Error("NonKeyObject");return[4,t.export("jwk")];case 1:return"EC"!==(i=a.sent()).kty?[3,3]:(s=void 0===n?{format:"raw"}:p(n),[4,c.default.sign(e,i,r,s.format)]);case 2:case 4:return o=a.sent(),[3,6];case 3:return"RSA"!==i.kty?[3,5]:(s=void 0===n?{name:"RSA-PSS",saltLength:d.hashes[r].hashSize}:p(n),[4,f.default.sign(e,i,r,s)]);case 5:throw new Error("UnsupportedKeyType");case 6:return[2,o]}}))}))},t.verify=function(e,t,r,n,i){return void 0===n&&(n="SHA-256"),void 0===i&&(i=void 0),s(void 0,void 0,void 0,(function(){var o,s,u;return a(this,(function(a){switch(a.label){case 0:if(!(r instanceof l.Key))throw new Error("NonKeyObject");return[4,r.export("jwk")];case 1:return"EC"!==(o=a.sent()).kty?[3,3]:(u=void 0===i?{format:"raw"}:p(i),[4,c.default.verify(e,t,o,n,u.format)]);case 2:case 4:return s=a.sent(),[3,6];case 3:return"RSA"!==o.kty?[3,5]:(u=void 0===i?{name:"RSA-PSS",saltLength:d.hashes[n].hashSize}:p(i),[4,f.default.verify(e,t,o,n,u)]);case 5:throw new Error("UnsupportedKeyType");case 6:return[2,s]}}))}))},t.encrypt=function(e,t,r){return void 0===r&&(r=void 0),s(void 0,void 0,void 0,(function(){var n,i,o,s,u;return a(this,(function(a){switch(a.label){case 0:if(!(t instanceof l.Key))throw new Error("NonKeyObject");return[4,t.export("jwk")];case 1:if("EC"!==(n=a.sent()).kty)return[3,4];if(!((s=p(r)).privateKey&&s.privateKey instanceof l.Key))throw new Error("MissingOrInvalidPrivateKeyForECDH");return o=s,[4,s.privateKey.export("jwk")];case 2:return o.privateKey=a.sent(),[4,h.encryptEc(e,n,s)];case 3:return i=a.sent(),[3,7];case 4:return"RSA"!==n.kty?[3,6]:(void 0!==(s=p(r)).hash&&(s.hash="SHA-256"),void 0!==s.label&&(s.label=new Uint8Array([])),u={},[4,f.default.encrypt(e,n,s.hash,s.label)]);case 5:return u.data=a.sent(),i=u,[3,7];case 6:throw new Error("UnsupportedKeyType");case 7:return[2,i]}}))}))},t.decrypt=function(e,t,r){return s(void 0,void 0,void 0,(function(){var n,i,o,s;return a(this,(function(a){switch(a.label){case 0:if(!(t instanceof l.Key))throw new Error("NonKeyObject");return[4,t.export("jwk")];case 1:if("EC"!==(n=a.sent()).kty)return[3,4];if(!(s=p(r)).publicKey)throw new Error("MissingPublicKeyForECDH");return o=s,[4,s.publicKey.export("jwk")];case 2:return o.publicKey=a.sent(),[4,h.decryptEc(e,n,s)];case 3:case 5:return i=a.sent(),[3,7];case 4:return"RSA"!==n.kty?[3,6]:(void 0!==(s=p(r)).hash&&(s.hash="SHA-256"),void 0!==s.label&&(s.label=new Uint8Array([])),[4,f.default.decrypt(e,n,s.hash,s.label)]);case 6:throw new Error("UnsupportedKeyType");case 7:return[2,i]}}))}))}},1766:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decryptEc=t.encryptEc=void 0;var c=u(r(3669)),f=u(r(6432)),l=u(r(4097)),h=u(r(8683)),d=o(r(7230));t.encryptEc=function(e,t,r){var n=r.privateKey,i=r.hash,o=void 0===i?"SHA-256":i,u=r.encrypt,p=void 0===u?"AES-GCM":u,y=r.keyLength,b=void 0===y?32:y,v=r.info,g=void 0===v?"":v;return s(void 0,void 0,void 0,(function(){var r,i,s;return a(this,(function(a){switch(a.label){case 0:return[4,f.default.deriveSecret(t,n)];case 1:return r=a.sent(),[4,l.default.compute(r,o,b,g)];case 2:return i=a.sent(),"AES-KW"===p?[3,5]:[4,c.default.getRandomBytes(d.ciphers[p].ivLength)];case 3:return s=a.sent(),[4,h.default.encrypt(e,i.key,{name:p,iv:s})];case 4:return[2,{data:a.sent(),salt:i.salt,iv:s}];case 5:return[4,h.default.wrapKey(e,i.key,{name:p})];case 6:return[2,{data:a.sent(),salt:i.salt}]}}))}))},t.decryptEc=function(e,t,r){var n=r.publicKey,i=r.hash,o=void 0===i?"SHA-256":i,u=r.encrypt,c=void 0===u?"AES-GCM":u,d=r.keyLength,p=void 0===d?32:d,y=r.info,b=void 0===y?"":y,v=r.salt,g=r.iv;return s(void 0,void 0,void 0,(function(){var r,i;return a(this,(function(s){switch(s.label){case 0:return[4,f.default.deriveSecret(n,t)];case 1:return r=s.sent(),[4,l.default.compute(r,o,p,b,v)];case 2:return i=s.sent(),"AES-KW"!==c?[2,h.default.decrypt(e,i.key,{name:c,iv:g})]:[2,h.default.unwrapKey(e,i.key,{name:c})]}}))}))}},1933:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.stringToArrayBuffer=t.arrayBufferToString=t.hexStringToArrayBuffer=t.arrayBufferToHexString=t.decodeBase64Url=t.encodeBase64Url=t.decodeBase64=t.encodeBase64=void 0;const s=o(r(4849));t.encodeBase64=e=>{let r="";return r="string"==typeof e?e:(0,t.arrayBufferToString)(e),s.getEnvBtoa()(r)},t.decodeBase64=e=>{const r=s.getEnvAtob()(e),n=(0,t.stringToArrayBuffer)(r);return u(n)};const a=e=>e instanceof Uint8Array?e:ArrayBuffer.isView(e)&&void 0!==e.buffer?new Uint8Array(e.buffer):new Uint8Array(e),u=e=>{let t=!0;for(let r=0;r<e.length;r++)if(e[r]>126||e[r]<32&&13!==e[r]&&10!==e[r]){t=!1;break}let r=null;if(t){r="";for(let t=0;t<e.length;t++)r+=String.fromCharCode(e[t])}else r=e;return r};t.encodeBase64Url=e=>(0,t.encodeBase64)(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),t.decodeBase64Url=e=>(e=e.replace(/-/g,"+").replace(/_/g,"/"),(0,t.decodeBase64)(e)),t.arrayBufferToHexString=e=>{const t=a(e);let r="";for(let e=0;e<t.length;e++){let n=(255&t[e]).toString(16);n=1===n.length?`0${n}`:n,r+=n}return r},t.hexStringToArrayBuffer=e=>{const t=[],r=e.length;for(let n=0;n<r;n+=2)t.push(parseInt(e.substr(n,2),16));return new Uint8Array(t)},t.arrayBufferToString=e=>{const t=a(e),r=new Array(t.length);return t.forEach(((e,t)=>{r[t]=e})),String.fromCharCode.apply(null,r)},t.stringToArrayBuffer=e=>new Uint8Array(e.length).map(((t,r)=>e.charCodeAt(r)))},4849:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnvAtob=t.getEnvBtoa=void 0,t.getEnvBtoa=()=>"undefined"!=typeof window?window.btoa:r,t.getEnvAtob=()=>"undefined"!=typeof window?window.atob:n;const r=e=>{if("undefined"==typeof Buffer)throw new Error("UnsupportedEnvironment");return Buffer.from(e.toString(),"binary").toString("base64")},n=e=>{if("undefined"==typeof Buffer)throw new Error("UnsupportedEnvironment");return Buffer.from(e,"base64").toString("binary")}},3357:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.binToPem=t.pemToBin=void 0;const s=o(r(1933)),a={public:"PUBLIC KEY",private:"PRIVATE KEY",encryptedPrivate:"ENCRYPTED PRIVATE KEY",certificate:"CERTIFICATE",certRequest:"CERTIFICATE REQUEST"};t.pemToBin=e=>{const t=c(e);return s.decodeBase64(t)},t.binToPem=(e,t)=>{const r=s.encodeBase64(e);return u(r,t)};const u=(e,t)=>{const r=a[t];let n=`-----BEGIN ${r}-----\n`;for(;e.length>0;)n+=`${e.substring(0,64)}\n`,e=e.substring(64);return n=`${n}-----END ${r}-----`,n},c=e=>{const t=RegExp("^-----[s]*BEGIN[^-]*-----$","gm"),r=RegExp("^-----[s]*END[^-]*-----$","gm");try{let n=e.split(t)[1].split(r)[0];return n=n.replace(/\r?\n/g,""),n}catch(e){throw new Error("Invalid format as PEM")}}},4471:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.formatter=t.encoder=void 0;const s=o(r(1933)),a=o(r(3357));var u,c;!function(e){e.encodeBase64=s.encodeBase64,e.decodeBase64=s.decodeBase64,e.encodeBase64Url=s.encodeBase64Url,e.decodeBase64Url=s.decodeBase64Url,e.arrayBufferToHexString=s.arrayBufferToHexString,e.hexStringToArrayBuffer=s.hexStringToArrayBuffer,e.stringToArrayBuffer=s.stringToArrayBuffer,e.arrayBufferToString=s.arrayBufferToString}(u||(t.encoder=u={})),function(e){e.binToPem=a.binToPem,e.pemToBin=a.pemToBin}(c||(t.formatter=c={})),t.default={encoder:u,formatter:c}},354:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getAsn1Signature=void 0;var c=o(r(2551)),f=u(r(6432)),l=o(r(5872)).Buffer;t.getAsn1Signature=function(e,t,r){return s(void 0,void 0,void 0,(function(){var n;return a(this,(function(i){switch(i.label){case 0:return[4,f.default.sign(e,t,c.signatureAlgorithms[r].hash,"der")];case 1:return n=i.sent(),[2,{unused:0,data:l.from(n)}]}}))}))}},6222:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.info=t.parse=t.toJwk=t.fromJwk=void 0;var s=o(r(9480));t.fromJwk=s.fromJwk,t.toJwk=s.toJwk,t.parse=s.parse,t.info=s.info,t.default={fromJwk:t.fromJwk,toJwk:t.toJwk,parse:t.parse,info:t.info}},2551:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ans1null=t.hashes=t.maskGeneratorFunctions=t.signatureAlgorithms=void 0,t.signatureAlgorithms={"ecdsa-with-sha256":{oid:[1,2,840,10045,4,3,2],hash:"SHA-256"},"ecdsa-with-sha384":{oid:[1,2,840,10045,4,3,3],hash:"SHA-384"},"ecdsa-with-sha512":{oid:[1,2,840,10045,4,3,4],hash:"SHA-512"},"ecdsa-with-sha1":{oid:[1,2,840,10045,4,3,1],hash:"SHA-1"},sha256WithRSAEncryption:{oid:[1,2,840,113549,1,1,11],hash:"SHA-256"},sha384WithRSAEncryption:{oid:[1,2,840,113549,1,1,12],hash:"SHA-384"},sha512WithRSAEncryption:{oid:[1,2,840,113549,1,1,13],hash:"SHA-512"},sha1WithRSAEncryption:{oid:[1,2,840,113549,1,1,5],hash:"SHA-1"},rsassaPss:{oid:[1,2,840,113549,1,1,10]}},t.maskGeneratorFunctions={MGF1:{oid:[1,2,840,113549,1,1,8]}},t.hashes={"SHA-1":{oid:[1,3,14,3,2,26]},"SHA-256":{oid:[2,16,840,1,101,3,4,2,1]},"SHA-384":{oid:[2,16,840,1,101,3,4,2,2]},"SHA-512":{oid:[2,16,840,1,101,3,4,2,3]}},t.ans1null=[5,0]},6185:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeRsassaPssParams=t.encodeRsassaPssParams=t.getSignature=void 0;var c=o(r(2551)),f=o(r(4714)),l=u(r(5414)),h=u(r(2993)),d=h.default.bignum,p=u(r(3650)),y=o(r(5872)).Buffer;t.getSignature=function(e,t,r,n){return s(void 0,void 0,void 0,(function(){var i;return a(this,(function(o){switch(o.label){case 0:return"rsassaPss"!==r?[3,2]:[4,l.default.sign(e,t,n.hash,{name:"RSA-PSS",saltLength:n.saltLength})];case 1:return i=o.sent(),[3,4];case 2:return[4,l.default.sign(e,t,c.signatureAlgorithms[r].hash,{name:"RSASSA-PKCS1-v1_5"})];case 3:i=o.sent(),o.label=4;case 4:return[2,{unused:0,data:y.from(i)}]}}))}))},t.encodeRsassaPssParams=function(e){if("SHA-1"===e.hash&&20===e.saltLength&&!1===e.explicit)return y.from([48,0]);var t={hashAlgorithm:{algorithm:c.hashes[e.hash].oid,parameters:y.from(c.ans1null)},maskGenAlgorithm:{algorithm:c.maskGeneratorFunctions.MGF1.oid,parameters:p.default.AlgorithmIdentifier.encode({algorithm:c.hashes[e.hash].oid,parameters:y.from(c.ans1null)},"der")},saltLength:new d(e.saltLength),trailerField:new d(1)};return b.encode(t,"der")},t.decodeRsassaPssParams=function(e){var t;if(new Uint8Array(e).toString()!==new Uint8Array([48,0]).toString()){var r=b.decode(e,"der");r.maskGenAlgorithm.parameters=p.default.AlgorithmIdentifier.decode(r.maskGenAlgorithm.parameters,"der"),r.saltLength=r.saltLength.toNumber(),r.trailerField=r.trailerField.toNumber();var n=f.getKeyFromOid(r.hashAlgorithm.algorithm,c.hashes),i=f.getKeyFromOid(r.maskGenAlgorithm.algorithm,c.maskGeneratorFunctions),o=f.getKeyFromOid(r.maskGenAlgorithm.parameters.algorithm,c.hashes);if(0===n.length||0===i.length||0===o.length)throw new Error("InvalidCertificateFormat");t={hash:n[0],mgf:i[0],hashForMgf:o[0],saltLength:r.saltLength}}else t={hash:"SHA-1",mgf:"MGF1",hashForMgf:"SHA-1",saltLength:20};return t};var b=h.default.define("rsassaPssParams",(function(){this.seq().obj(this.key("hashAlgorithm").explicit(0).use(p.default.AlgorithmIdentifier),this.key("maskGenAlgorithm").explicit(1).use(p.default.AlgorithmIdentifier),this.key("saltLength").explicit(2).int(),this.key("trailerField").explicit(3).int())}))},4714:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getKeyFromOid=void 0,t.getKeyFromOid=function(e,t){return Object.keys(t).filter((function(r){return t[r].oid.toString()===e.toString()}))}},9480:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.info=t.parse=t.toJwk=t.fromJwk=void 0;var c=o(r(2551)),f=o(r(6185)),l=o(r(354)),h=u(r(3650)),d=u(r(4471)),p=u(r(3669)),y=r(1402),b=o(r(5872)).Buffer,v=r(9098);t.fromJwk=function(e,t,r,n){return void 0===r&&(r="pem"),void 0===n&&(n={}),s(void 0,void 0,void 0,(function(){var i,o,s,u,m,w,S,A,_,M,k,x,E,B,O,j,I,P;return a(this,(function(a){switch(a.label){case 0:return void 0===n.signature&&(n.signature="EC"===t.kty?"ecdsa-with-sha256":"rsassaPss"),void 0===n.days&&(n.days=3650),void 0===n.issuer&&(n.issuer={organizationName:"Self"}),void 0===n.subject&&(n.subject={organizationName:"Self"}),void 0===n.pssParams&&(n.pssParams={}),void 0===n.pssParams.saltLength&&"rsassaPss"===n.signature&&(n.pssParams.saltLength=20),void 0===n.pssParams.hash&&"rsassaPss"===n.signature&&(n.pssParams.hash="SHA-1"),void 0===n.pssParams.explicit&&"rsassaPss"===n.signature&&(n.pssParams.explicit=!0),i=0,[4,p.default.getRandomBytes(20)];case 1:return o=a.sent(),s=new v(o),u={algorithm:c.signatureAlgorithms[n.signature].oid},"rsassaPss"===n.signature?u.parameters=f.encodeRsassaPssParams(n.pssParams):u.parameters=b.from(c.ans1null),m={type:"rdnSequence",value:g(n.issuer)},w=Date.now()/1e3*1e3,S={notBefore:{type:"utcTime",value:w},notAfter:{type:"utcTime",value:w+86400*n.days*1e3}},A={type:"rdnSequence",value:g(n.subject)},_=new y.Key("jwk",e),x=(k=b).from,[4,_.export("der",{compact:!1,outputPublic:!0})];case 2:return M=x.apply(k,[a.sent()]),E=h.default.SubjectPublicKeyInfo.decode(M,"der"),O=(B={version:i,serialNumber:s,signature:u,issuer:m,validity:S,subject:A,subjectPublicKeyInfo:E}).signature,j=h.default.TBSCertificate.encode(B,"der"),"EC"!==t.kty?[3,4]:[4,l.getAsn1Signature(j,t,n.signature)];case 3:case 5:return I=a.sent(),[3,7];case 4:return"RSA"!==t.kty?[3,6]:[4,f.getSignature(j,t,n.signature,n.pssParams)];case 6:throw new Error("UnsupportedKeyType");case 7:if(P=h.default.Certificate.encode({tbsCertificate:B,signatureAlgorithm:O,signature:I},"der"),"pem"===r)return[2,d.default.formatter.binToPem(P,"certificate")];if("der"===r)return[2,P];throw new Error("InvalidFormatSpecification")}}))}))},t.toJwk=function(e,t){return void 0===t&&(t="pem"),s(void 0,void 0,void 0,(function(){var r,n,i,o;return a(this,(function(s){switch(s.label){case 0:if("pem"===t)r=d.default.formatter.pemToBin(e);else{if("der"!==t)throw new Error("InvalidFormatSpecification");r=e}return n=b.from(r),i=h.default.Certificate.decode(n,"der"),o=h.default.SubjectPublicKeyInfo.encode(i.tbsCertificate.subjectPublicKeyInfo,"der"),[4,new y.Key("der",o).export("jwk",{outputPublic:!0})];case 1:return[2,s.sent()]}}))}))},t.parse=function(e,r){void 0===r&&(r="pem");var n=(0,t.info)(e,r),i=n.signatureAlgorithm.algorithm,o=n.signatureAlgorithm.parameters,s=Object.keys(c.signatureAlgorithms).filter((function(e){return c.signatureAlgorithms[e].oid.toString()===i.toString()}));if(s.length<=0)throw new Error("UnsupportedSignatureAlgorithm");var a={algorithm:s[0]};"rsassaPss"===s[0]?a.parameters=f.decodeRsassaPssParams(o):a.parameters={hash:c.signatureAlgorithms[a.algorithm].hash};var u=h.default.TBSCertificate.encode(n.tbsCertificate,"der");return{tbsCertificate:new Uint8Array(u),signatureValue:new Uint8Array(n.signature.data),signatureAlgorithm:a}},t.info=function(e,t){var r;if(void 0===t&&(t="pem"),"pem"===t)r=d.default.formatter.pemToBin(e);else{if("der"!==t)throw new Error("InvalidFormatSpecification");r=e}var n=b.from(r);return h.default.Certificate.decode(n,"der")};var g=function(e){return[Object.keys(e).map((function(t){if(Object.keys(m).indexOf(t)<0)throw new Error("InvalidOptionSpecification");var r,n=m[t];if(["dnQualifier, countryName, serialNumber"].indexOf(t)>=0){if("countryName"===t&&2!==e[t].length)throw new Error("InvalidCountryNameCode");r=h.default.DirectoryString.encode({type:"printableString",value:e[t]},"der")}else r=h.default.DirectoryString.encode({type:"utf8String",value:e[t]},"der");return{type:n,value:r}}))]},m={name:[2,5,4,41],surname:[2,5,4,4],givenName:[2,5,4,42],initials:[2,5,4,43],generationQualifier:[2,5,4,44],commonName:[2,5,4,3],localityName:[2,5,4,7],stateOrProvinceName:[2,5,4,8],organizationName:[2,5,4,10],organizationalUnitName:[2,5,4,11],title:[2,5,4,12],dnQualifier:[2,5,4,46],countryName:[2,5,4,6],serialNumber:[2,5,4,5],pseudonym:[2,5,4,65],domainComponent:[0,9,2342,19200300,100,1,25]}},2323:(e,t,r)=>{e=r.nmd(e);var n="__lodash_hash_undefined__",i=9007199254740991,o="[object Arguments]",s="[object Boolean]",a="[object Date]",u="[object Function]",c="[object GeneratorFunction]",f="[object Map]",l="[object Number]",h="[object Object]",d="[object Promise]",p="[object RegExp]",y="[object Set]",b="[object String]",v="[object Symbol]",g="[object WeakMap]",m="[object ArrayBuffer]",w="[object DataView]",S="[object Float32Array]",A="[object Float64Array]",_="[object Int8Array]",M="[object Int16Array]",k="[object Int32Array]",x="[object Uint8Array]",E="[object Uint8ClampedArray]",B="[object Uint16Array]",O="[object Uint32Array]",j=/\w*$/,I=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,C={};C[o]=C["[object Array]"]=C[m]=C[w]=C[s]=C[a]=C[S]=C[A]=C[_]=C[M]=C[k]=C[f]=C[l]=C[h]=C[p]=C[y]=C[b]=C[v]=C[x]=C[E]=C[B]=C[O]=!0,C["[object Error]"]=C[u]=C[g]=!1;var N="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,U="object"==typeof self&&self&&self.Object===Object&&self,T=N||U||Function("return this")(),R=t&&!t.nodeType&&t,D=R&&e&&!e.nodeType&&e,K=D&&D.exports===R;function L(e,t){return e.set(t[0],t[1]),e}function z(e,t){return e.add(t),e}function H(e,t,r,n){var i=-1,o=e?e.length:0;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function q(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function F(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function V(e,t){return function(r){return e(t(r))}}function $(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var J,W=Array.prototype,G=Function.prototype,Z=Object.prototype,Y=T["__core-js_shared__"],X=(J=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+J:"",Q=G.toString,ee=Z.hasOwnProperty,te=Z.toString,re=RegExp("^"+Q.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ne=K?T.Buffer:void 0,ie=T.Symbol,oe=T.Uint8Array,se=V(Object.getPrototypeOf,Object),ae=Object.create,ue=Z.propertyIsEnumerable,ce=W.splice,fe=Object.getOwnPropertySymbols,le=ne?ne.isBuffer:void 0,he=V(Object.keys,Object),de=Te(T,"DataView"),pe=Te(T,"Map"),ye=Te(T,"Promise"),be=Te(T,"Set"),ve=Te(T,"WeakMap"),ge=Te(Object,"create"),me=ze(de),we=ze(pe),Se=ze(ye),Ae=ze(be),_e=ze(ve),Me=ie?ie.prototype:void 0,ke=Me?Me.valueOf:void 0;function xe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ee(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Be(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Oe(e){this.__data__=new Ee(e)}function je(e,t,r){var n=e[t];ee.call(e,t)&&He(n,r)&&(void 0!==r||t in e)||(e[t]=r)}function Ie(e,t){for(var r=e.length;r--;)if(He(e[r][0],t))return r;return-1}function Pe(e,t,r,n,i,d,g){var I;if(n&&(I=d?n(e,i,d,g):n(e)),void 0!==I)return I;if(!Je(e))return e;var P=qe(e);if(P){if(I=function(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&ee.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!t)return function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(e,I)}else{var N=De(e),U=N==u||N==c;if(Ve(e))return function(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}(e,t);if(N==h||N==o||U&&!d){if(q(e))return d?e:{};if(I=function(e){return"function"!=typeof e.constructor||Le(e)?{}:Je(t=se(e))?ae(t):{};var t}(U?{}:e),!t)return function(e,t){return Ne(e,Re(e),t)}(e,function(e,t){return e&&Ne(t,We(t),e)}(I,e))}else{if(!C[N])return d?e:{};I=function(e,t,r,n){var i,o=e.constructor;switch(t){case m:return Ce(e);case s:case a:return new o(+e);case w:return function(e,t){var r=t?Ce(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,n);case S:case A:case _:case M:case k:case x:case E:case B:case O:return function(e,t){var r=t?Ce(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,n);case f:return function(e,t,r){return H(t?r(F(e),!0):F(e),L,new e.constructor)}(e,n,r);case l:case b:return new o(e);case p:return function(e){var t=new e.constructor(e.source,j.exec(e));return t.lastIndex=e.lastIndex,t}(e);case y:return function(e,t,r){return H(t?r($(e),!0):$(e),z,new e.constructor)}(e,n,r);case v:return i=e,ke?Object(ke.call(i)):{}}}(e,N,Pe,t)}}g||(g=new Oe);var T=g.get(e);if(T)return T;if(g.set(e,I),!P)var R=r?function(e){return function(e,t,r){var n=t(e);return qe(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,We,Re)}(e):We(e);return function(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r););}(R||e,(function(i,o){R&&(i=e[o=i]),je(I,o,Pe(i,t,r,n,o,e,g))})),I}function Ce(e){var t=new e.constructor(e.byteLength);return new oe(t).set(new oe(e)),t}function Ne(e,t,r,n){r||(r={});for(var i=-1,o=t.length;++i<o;){var s=t[i],a=n?n(r[s],e[s],s,r,e):void 0;je(r,s,void 0===a?e[s]:a)}return r}function Ue(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Te(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!Je(e)||(t=e,X&&X in t))&&($e(e)||q(e)?re:I).test(ze(e));var t}(r)?r:void 0}xe.prototype.clear=function(){this.__data__=ge?ge(null):{}},xe.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},xe.prototype.get=function(e){var t=this.__data__;if(ge){var r=t[e];return r===n?void 0:r}return ee.call(t,e)?t[e]:void 0},xe.prototype.has=function(e){var t=this.__data__;return ge?void 0!==t[e]:ee.call(t,e)},xe.prototype.set=function(e,t){return this.__data__[e]=ge&&void 0===t?n:t,this},Ee.prototype.clear=function(){this.__data__=[]},Ee.prototype.delete=function(e){var t=this.__data__,r=Ie(t,e);return!(r<0||(r==t.length-1?t.pop():ce.call(t,r,1),0))},Ee.prototype.get=function(e){var t=this.__data__,r=Ie(t,e);return r<0?void 0:t[r][1]},Ee.prototype.has=function(e){return Ie(this.__data__,e)>-1},Ee.prototype.set=function(e,t){var r=this.__data__,n=Ie(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},Be.prototype.clear=function(){this.__data__={hash:new xe,map:new(pe||Ee),string:new xe}},Be.prototype.delete=function(e){return Ue(this,e).delete(e)},Be.prototype.get=function(e){return Ue(this,e).get(e)},Be.prototype.has=function(e){return Ue(this,e).has(e)},Be.prototype.set=function(e,t){return Ue(this,e).set(e,t),this},Oe.prototype.clear=function(){this.__data__=new Ee},Oe.prototype.delete=function(e){return this.__data__.delete(e)},Oe.prototype.get=function(e){return this.__data__.get(e)},Oe.prototype.has=function(e){return this.__data__.has(e)},Oe.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Ee){var n=r.__data__;if(!pe||n.length<199)return n.push([e,t]),this;r=this.__data__=new Be(n)}return r.set(e,t),this};var Re=fe?V(fe,Object):function(){return[]},De=function(e){return te.call(e)};function Ke(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||P.test(e))&&e>-1&&e%1==0&&e<t}function Le(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Z)}function ze(e){if(null!=e){try{return Q.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function He(e,t){return e===t||e!=e&&t!=t}(de&&De(new de(new ArrayBuffer(1)))!=w||pe&&De(new pe)!=f||ye&&De(ye.resolve())!=d||be&&De(new be)!=y||ve&&De(new ve)!=g)&&(De=function(e){var t=te.call(e),r=t==h?e.constructor:void 0,n=r?ze(r):void 0;if(n)switch(n){case me:return w;case we:return f;case Se:return d;case Ae:return y;case _e:return g}return t});var qe=Array.isArray;function Fe(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}(e.length)&&!$e(e)}var Ve=le||function(){return!1};function $e(e){var t=Je(e)?te.call(e):"";return t==u||t==c}function Je(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function We(e){return Fe(e)?function(e,t){var r=qe(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&Fe(e)}(e)&&ee.call(e,"callee")&&(!ue.call(e,"callee")||te.call(e)==o)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var s in e)!t&&!ee.call(e,s)||i&&("length"==s||Ke(s,n))||r.push(s);return r}(e):function(e){if(!Le(e))return he(e);var t=[];for(var r in Object(e))ee.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}e.exports=function(e){return Pe(e,!0,!0)}},6706:(e,t,r)=>{var n,i,o,s,a;n=r(1048),i=r(6636).utf8,o=r(3149),s=r(6636).bin,(a=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?s.stringToBytes(e):i.stringToBytes(e):o(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var r=n.bytesToWords(e),u=8*e.length,c=1732584193,f=-271733879,l=-1732584194,h=271733878,d=0;d<r.length;d++)r[d]=16711935&(r[d]<<8|r[d]>>>24)|4278255360&(r[d]<<24|r[d]>>>8);r[u>>>5]|=128<<u%32,r[14+(u+64>>>9<<4)]=u;var p=a._ff,y=a._gg,b=a._hh,v=a._ii;for(d=0;d<r.length;d+=16){var g=c,m=f,w=l,S=h;c=p(c,f,l,h,r[d+0],7,-680876936),h=p(h,c,f,l,r[d+1],12,-389564586),l=p(l,h,c,f,r[d+2],17,606105819),f=p(f,l,h,c,r[d+3],22,-1044525330),c=p(c,f,l,h,r[d+4],7,-176418897),h=p(h,c,f,l,r[d+5],12,1200080426),l=p(l,h,c,f,r[d+6],17,-1473231341),f=p(f,l,h,c,r[d+7],22,-45705983),c=p(c,f,l,h,r[d+8],7,1770035416),h=p(h,c,f,l,r[d+9],12,-1958414417),l=p(l,h,c,f,r[d+10],17,-42063),f=p(f,l,h,c,r[d+11],22,-1990404162),c=p(c,f,l,h,r[d+12],7,1804603682),h=p(h,c,f,l,r[d+13],12,-40341101),l=p(l,h,c,f,r[d+14],17,-1502002290),c=y(c,f=p(f,l,h,c,r[d+15],22,1236535329),l,h,r[d+1],5,-165796510),h=y(h,c,f,l,r[d+6],9,-1069501632),l=y(l,h,c,f,r[d+11],14,643717713),f=y(f,l,h,c,r[d+0],20,-373897302),c=y(c,f,l,h,r[d+5],5,-701558691),h=y(h,c,f,l,r[d+10],9,38016083),l=y(l,h,c,f,r[d+15],14,-660478335),f=y(f,l,h,c,r[d+4],20,-405537848),c=y(c,f,l,h,r[d+9],5,568446438),h=y(h,c,f,l,r[d+14],9,-1019803690),l=y(l,h,c,f,r[d+3],14,-187363961),f=y(f,l,h,c,r[d+8],20,1163531501),c=y(c,f,l,h,r[d+13],5,-1444681467),h=y(h,c,f,l,r[d+2],9,-51403784),l=y(l,h,c,f,r[d+7],14,1735328473),c=b(c,f=y(f,l,h,c,r[d+12],20,-1926607734),l,h,r[d+5],4,-378558),h=b(h,c,f,l,r[d+8],11,-2022574463),l=b(l,h,c,f,r[d+11],16,1839030562),f=b(f,l,h,c,r[d+14],23,-35309556),c=b(c,f,l,h,r[d+1],4,-1530992060),h=b(h,c,f,l,r[d+4],11,1272893353),l=b(l,h,c,f,r[d+7],16,-155497632),f=b(f,l,h,c,r[d+10],23,-1094730640),c=b(c,f,l,h,r[d+13],4,681279174),h=b(h,c,f,l,r[d+0],11,-358537222),l=b(l,h,c,f,r[d+3],16,-722521979),f=b(f,l,h,c,r[d+6],23,76029189),c=b(c,f,l,h,r[d+9],4,-640364487),h=b(h,c,f,l,r[d+12],11,-421815835),l=b(l,h,c,f,r[d+15],16,530742520),c=v(c,f=b(f,l,h,c,r[d+2],23,-995338651),l,h,r[d+0],6,-198630844),h=v(h,c,f,l,r[d+7],10,1126891415),l=v(l,h,c,f,r[d+14],15,-1416354905),f=v(f,l,h,c,r[d+5],21,-57434055),c=v(c,f,l,h,r[d+12],6,1700485571),h=v(h,c,f,l,r[d+3],10,-1894986606),l=v(l,h,c,f,r[d+10],15,-1051523),f=v(f,l,h,c,r[d+1],21,-2054922799),c=v(c,f,l,h,r[d+8],6,1873313359),h=v(h,c,f,l,r[d+15],10,-30611744),l=v(l,h,c,f,r[d+6],15,-1560198380),f=v(f,l,h,c,r[d+13],21,1309151649),c=v(c,f,l,h,r[d+4],6,-145523070),h=v(h,c,f,l,r[d+11],10,-1120210379),l=v(l,h,c,f,r[d+2],15,718787259),f=v(f,l,h,c,r[d+9],21,-343485551),c=c+g>>>0,f=f+m>>>0,l=l+w>>>0,h=h+S>>>0}return n.endian([c,f,l,h])})._ff=function(e,t,r,n,i,o,s){var a=e+(t&r|~t&n)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._gg=function(e,t,r,n,i,o,s){var a=e+(t&n|r&~n)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._hh=function(e,t,r,n,i,o,s){var a=e+(t^r^n)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._ii=function(e,t,r,n,i,o,s){var a=e+(r^(t|~n))+(i>>>0)+s;return(a<<o|a>>>32-o)+t},a._blocksize=16,a._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var r=n.wordsToBytes(a(e,t));return t&&t.asBytes?r:t&&t.asString?s.bytesToString(r):n.bytesToHex(r)}},6111:e=>{function t(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,r){if(e!=t)throw new Error(r||"Assertion failed: "+e+" != "+t)}},179:(e,t)=>{"use strict";var r=t;function n(e){return 1===e.length?"0"+e:e}function i(e){for(var t="",r=0;r<e.length;r++)t+=n(e[r].toString(16));return t}r.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"!=typeof e){for(var n=0;n<e.length;n++)r[n]=0|e[n];return r}if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),n=0;n<e.length;n+=2)r.push(parseInt(e[n]+e[n+1],16));else for(n=0;n<e.length;n++){var i=e.charCodeAt(n),o=i>>8,s=255&i;o?r.push(o,s):r.push(s)}return r},r.zero2=n,r.toHex=i,r.encode=function(e,t){return"hex"===t?i(e):e}},7172:(e,t)=>{"use strict";class r{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const n=r.toUint8Array(e),i=r.toUint8Array(t);if(n.length!==i.byteLength)return!1;for(let e=0;e<n.length;e++)if(n[e]!==i[e])return!1;return!0}static concat(...e){let t;t=!Array.isArray(e[0])||e[1]instanceof Function?Array.isArray(e[0])&&e[1]instanceof Function?e[0]:e[e.length-1]instanceof Function?e.slice(0,e.length-1):e:e[0];let r=0;for(const e of t)r+=e.byteLength;const n=new Uint8Array(r);let i=0;for(const e of t){const t=this.toUint8Array(e);n.set(t,i),i+=t.length}return e[e.length-1]instanceof Function?this.toView(n,e[e.length-1]):n.buffer}}const n="string",i=/^[0-9a-f]+$/i,o=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,s=/^[a-zA-Z0-9-_]+$/;class a{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){const t=r.toUint8Array(e);let n="";for(let e=0;e<t.length;e++)n+=String.fromCharCode(t[e]);return decodeURIComponent(escape(n))}}class u{static toString(e,t=!1){const n=r.toArrayBuffer(e),i=new DataView(n);let o="";for(let e=0;e<n.byteLength;e+=2){const r=i.getUint16(e,t);o+=String.fromCharCode(r)}return o}static fromString(e,t=!1){const r=new ArrayBuffer(2*e.length),n=new DataView(r);for(let r=0;r<e.length;r++)n.setUint16(2*r,e.charCodeAt(r),t);return r}}class c{static isHex(e){return typeof e===n&&i.test(e)}static isBase64(e){return typeof e===n&&o.test(e)}static isBase64Url(e){return typeof e===n&&s.test(e)}static ToString(e,t="utf8"){const n=r.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(n);case"binary":return this.ToBinary(n);case"hex":return this.ToHex(n);case"base64":return this.ToBase64(n);case"base64url":return this.ToBase64Url(n);case"utf16le":return u.toString(n,!0);case"utf16":case"utf16be":return u.toString(n);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return u.fromString(e,!0);case"utf16":case"utf16be":return u.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=r.toUint8Array(e);if("undefined"!=typeof btoa){const e=this.ToString(t,"binary");return btoa(e)}return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!c.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!c.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=c.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return a.fromString(e);case"utf16":case"utf16be":return u.fromString(e);case"utf16le":case"usc2":return u.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=c.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return a.toString(e);case"utf16":case"utf16be":return u.toString(e);case"utf16le":case"usc2":return u.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r.buffer}static ToBinary(e){const t=r.toUint8Array(e);let n="";for(let e=0;e<t.length;e++)n+=String.fromCharCode(t[e]);return n}static ToHex(e){const t=r.toUint8Array(e);let n="";const i=t.length;for(let e=0;e<i;e++){const r=t[e];r<16&&(n+="0"),n+=r.toString(16)}return n}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!c.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){const n=t.slice(e,e+2);r[e/2]=parseInt(n,16)}return r.buffer}static ToUtf16String(e,t=!1){return u.toString(e,t)}static FromUtf16String(e,t=!1){return u.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}c.DEFAULT_UTF8_ENCODING="utf8",t.vJ=r,t.ep=c,t.$e=function(...e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),r=new Uint8Array(t);let n=0;return e.map((e=>new Uint8Array(e))).forEach((e=>{for(const t of e)r[n++]=t})),r.buffer},t.Xy=function(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==n[t])return!1;return!0}},5446:(e,t,r)=>{"use strict";var n,i=r(5872),o=i.Buffer,s={};for(n in i)i.hasOwnProperty(n)&&"SlowBuffer"!==n&&"Buffer"!==n&&(s[n]=i[n]);var a=s.Buffer={};for(n in o)o.hasOwnProperty(n)&&"allocUnsafe"!==n&&"allocUnsafeSlow"!==n&&(a[n]=o[n]);if(s.Buffer.prototype=o.prototype,a.from&&a.from!==Uint8Array.from||(a.from=function(e,t,r){if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&void 0===e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return o(e,t,r)}),a.alloc||(a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var n=o(e);return t&&0!==t.length?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n}),!s.kStringMaxLength)try{s.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}s.constants||(s.constants={MAX_LENGTH:s.kMaxLength},s.kStringMaxLength&&(s.constants.MAX_STRING_LENGTH=s.kStringMaxLength)),e.exports=s},8423:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.SHAKE=t.SHA3Hash=t.SHA3=t.Keccak=void 0;var n,i=r(5872),o=(n=r(6692))&&n.__esModule?n:{default:n},s=function(e){var t=e.allowedSizes,r=e.defaultSize,n=e.padding;return function e(){var s=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;if(!this||this.constructor!==e)return new e(a);if(t&&!t.includes(a))throw new Error("Unsupported hash length");var u=new o.default({capacity:a});return this.update=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";if(i.Buffer.isBuffer(e))return u.absorb(e),s;if("string"==typeof e)return s.update(i.Buffer.from(e,t));throw new TypeError("Not a string or buffer")},this.digest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"binary",t="string"==typeof e?{format:e}:e,r=u.squeeze({buffer:t.buffer,padding:t.padding||n});return t.format&&"binary"!==t.format?r.toString(t.format):r},this.reset=function(){return u.reset(),s},this}},a=s({allowedSizes:[224,256,384,512],defaultSize:512,padding:1});t.Keccak=a;var u=s({allowedSizes:[224,256,384,512],defaultSize:512,padding:6});t.SHA3=u;var c=s({allowedSizes:[128,256],defaultSize:256,padding:31});t.SHAKE=c;var f=a;t.SHA3Hash=f,u.SHA3Hash=f;var l=u;t.default=l},6692:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(5872),o=(n=r(9209))&&n.__esModule?n:{default:n},s=function(e,t){for(var r=0;r<e.length;r+=8){var n=r/4;t[n]^=e[r+7]<<24|e[r+6]<<16|e[r+5]<<8|e[r+4],t[n+1]^=e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]}return t},a=function(e,t){for(var r=0;r<t.length;r+=8){var n=r/4;t[r]=e[n+1],t[r+1]=e[n+1]>>>8,t[r+2]=e[n+1]>>>16,t[r+3]=e[n+1]>>>24,t[r+4]=e[n],t[r+5]=e[n]>>>8,t[r+6]=e[n]>>>16,t[r+7]=e[n]>>>24}return t};t.default=function(e){var t=this,r=e.capacity,n=e.padding,u=(0,o.default)(),c=r/8,f=200-r/4,l=0,h=new Uint32Array(50),d=i.Buffer.allocUnsafe(f);return this.absorb=function(e){for(var r=0;r<e.length;r++)d[l]=e[r],(l+=1)>=f&&(s(d,h),u(h),l=0);return t},this.squeeze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={buffer:e.buffer||i.Buffer.allocUnsafe(c),padding:e.padding||n,queue:i.Buffer.allocUnsafe(d.length),state:new Uint32Array(h.length)};d.copy(t.queue);for(var r=0;r<h.length;r++)t.state[r]=h[r];t.queue.fill(0,l),t.queue[l]|=t.padding,t.queue[f-1]|=128,s(t.queue,t.state);for(var o=0;o<t.buffer.length;o+=f)u(t.state),a(t.state,t.buffer.slice(o,o+f));return t.buffer},this.reset=function(){return d.fill(0),h.fill(0),l=0,t},this}},2770:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(6485))&&n.__esModule?n:{default:n};t.default=function(e){for(var t=e.A,r=e.C,n=0;n<25;n+=5){for(var o=0;o<5;o++)(0,i.default)(t,n+o)(r,o);for(var s=0;s<5;s++){var a=2*(n+s),u=(s+1)%5*2,c=(s+2)%5*2;t[a]^=~r[u]&r[c],t[a+1]^=~r[u+1]&r[c+1]}}}},6485:e=>{"use strict";e.exports=function(e,t){return function(r,n){var i=2*n,o=2*t;r[i]=e[o],r[i+1]=e[o+1]}}},9209:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(2770)),i=a(r(9896)),o=a(r(4753)),s=a(r(8224));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=new Uint32Array(10),t=new Uint32Array(10),r=new Uint32Array(2);return function(a){for(var u=0;u<24;u++)(0,s.default)({A:a,C:e,D:t,W:r}),(0,o.default)({A:a,C:e,W:r}),(0,n.default)({A:a,C:e}),(0,i.default)({A:a,roundIndex:u});e.fill(0),t.fill(0),r.fill(0)}}},9896:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(8858))&&n.__esModule?n:{default:n};t.default=function(e){var t=e.A,r=2*e.roundIndex;t[0]^=i.default[r],t[1]^=i.default[r+1]}},8858:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=new Uint32Array([0,1,0,32898,2147483648,32906,2147483648,2147516416,0,32907,0,2147483649,2147483648,2147516545,2147483648,32777,0,138,0,136,0,2147516425,0,2147483658,0,2147516555,2147483648,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,0,32778,2147483648,2147483658,2147483648,2147516545,2147483648,32896,0,2147483649,2147483648,2147516424]);t.default=r},4753:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(305)),i=s(r(3295)),o=s(r(6485));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.A,r=e.C,s=e.W;(0,o.default)(t,1)(s,0);for(var a=0,u=0,c=0,f=32,l=0;l<24;l++){var h=n.default[l],d=i.default[l];(0,o.default)(t,h)(r,0),a=s[0],u=s[1],f=32-d,s[c=d<32?0:1]=a<<d|u>>>f,s[(c+1)%2]=u<<d|a>>>f,(0,o.default)(s,0)(t,h),(0,o.default)(r,0)(s,0)}}},305:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=[10,7,11,17,18,3,5,16,8,21,24,4,15,23,19,13,12,2,20,14,22,9,6,1]},3295:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=[1,3,6,10,15,21,28,36,45,55,2,14,27,41,56,8,25,43,62,18,39,61,20,44]},8224:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(6485))&&n.__esModule?n:{default:n};t.default=function(e){for(var t=e.A,r=e.C,n=e.D,o=e.W,s=0,a=0,u=0;u<5;u++){var c=2*u,f=2*(u+5),l=2*(u+10),h=2*(u+15),d=2*(u+20);r[c]=t[c]^t[f]^t[l]^t[h]^t[d],r[c+1]=t[c+1]^t[f+1]^t[l+1]^t[h+1]^t[d+1]}for(var p=0;p<5;p++){(0,i.default)(r,(p+1)%5)(o,0),s=o[0],a=o[1],o[0]=s<<1|a>>>31,o[1]=a<<1|s>>>31,n[2*p]=r[(p+4)%5*2]^o[0],n[2*p+1]=r[(p+4)%5*2+1]^o[1];for(var y=0;y<25;y+=5)t[2*(y+p)]^=n[2*p],t[2*(y+p)+1]^=n[2*p+1]}}},6100:t=>{"use strict";t.exports=e},1314:()=>{},9391:()=>{},9736:(e,t,r)=>{var n;!function(e){!function(t){var n="object"==typeof globalThis?globalThis:"object"==typeof r.g?r.g:"object"==typeof self?self:"object"==typeof this?this:function(){try{return Function("return this;")()}catch(e){}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch(e){}}(),i=o(e);function o(e,t){return function(r,n){Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}void 0!==n.Reflect&&(i=o(n.Reflect,i)),function(e,t){var r=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,a={__proto__:[]}instanceof Array,u=!s&&!a,c={create:s?function(){return H(Object.create(null))}:a?function(){return H({__proto__:null})}:function(){return H({})},has:u?function(e,t){return r.call(e,t)}:function(e,t){return t in e},get:u?function(e,t){return r.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},f=Object.getPrototypeOf(Function),l="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:function(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,N(t,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,i)},t.prototype.entries=function(){return new r(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){if(!N(this._cacheKey,e)){this._cacheIndex=-1;for(var r=0;r<this._keys.length;r++)if(N(this._keys[r],e)){this._cacheIndex=r;break}}return this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function i(e,t){return t}function s(e,t){return[e,t]}}(),h="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:function(){function e(){this._map=new l}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}(),d="function"==typeof WeakMap?WeakMap:function(){var e=16,t=c.create(),n=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+a()}while(c.has(t,e));return t[e]=!0,e}function o(e,t){if(!r.call(e,n)){if(!t)return;Object.defineProperty(e,n,{value:c.create()})}return e[n]}function s(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(){var t=function(e){if("function"==typeof Uint8Array){var t=new Uint8Array(e);return"undefined"!=typeof crypto?crypto.getRandomValues(t):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(t):s(t,e),t}return s(new Array(e),e)}(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var i=t[n];4!==n&&6!==n&&8!==n||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}(),p=n?Symbol.for("@reflect-metadata:registry"):void 0,y=function(){var e;return!k(p)&&E(t.Reflect)&&Object.isExtensible(t.Reflect)&&(e=t.Reflect[p]),k(e)&&(e=function(){var e,r,n,i;k(p)||void 0===t.Reflect||p in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(e=function(e){var t=e.defineMetadata,r=e.hasOwnMetadata,n=e.getOwnMetadata,i=e.getOwnMetadataKeys,o=e.deleteMetadata,s=new d;return{isProviderFor:function(e,t){var r=s.get(e);return!(k(r)||!r.has(t))||!!i(e,t).length&&(k(r)&&(r=new h,s.set(e,r)),r.add(t),!0)},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:r,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:i,OrdinaryDeleteMetadata:o}}(t.Reflect));var o=new d,s={registerProvider:a,getProvider:c,setProvider:y};return s;function a(t){if(!Object.isExtensible(s))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===t:break;case k(r):r=t;break;case r===t:break;case k(n):n=t;break;case n===t:break;default:void 0===i&&(i=new h),i.add(t)}}function u(t,o){if(!k(r)){if(r.isProviderFor(t,o))return r;if(!k(n)){if(n.isProviderFor(t,o))return r;if(!k(i))for(var s=T(i);;){var a=D(s);if(!a)return;var u=R(a);if(u.isProviderFor(t,o))return K(s),u}}}if(!k(e)&&e.isProviderFor(t,o))return e}function c(e,t){var r,n=o.get(e);return k(n)||(r=n.get(t)),k(r)?(k(r=u(e,t))||(k(n)&&(n=new l,o.set(e,n)),n.set(t,r)),r):r}function f(e){if(k(e))throw new TypeError;return r===e||n===e||!k(i)&&i.has(e)}function y(e,t,r){if(!f(r))throw new Error("Metadata provider not registered.");var n=c(e,t);if(n!==r){if(!k(n))return!1;var i=o.get(e);k(i)&&(i=new l,o.set(e,i)),i.set(t,r)}return!0}}()),!k(p)&&E(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,p,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}(),b=function(e){var t=new d,r={isProviderFor:function(e,r){var n=t.get(e);return!k(n)&&n.has(r)},OrdinaryDefineOwnMetadata:function(e,t,r,i){n(r,i,!0).set(e,t)},OrdinaryHasOwnMetadata:function(e,t,r){var i=n(t,r,!1);return!k(i)&&O(i.has(e))},OrdinaryGetOwnMetadata:function(e,t,r){var i=n(t,r,!1);if(!k(i))return i.get(e)},OrdinaryOwnMetadataKeys:function(e,t){var r=[],i=n(e,t,!1);if(k(i))return r;for(var o=T(i.keys()),s=0;;){var a=D(o);if(!a)return r.length=s,r;var u=R(a);try{r[s]=u}catch(e){try{K(o)}finally{throw e}}s++}},OrdinaryDeleteMetadata:function(e,r,i){var o=n(r,i,!1);if(k(o))return!1;if(!o.delete(e))return!1;if(0===o.size){var s=t.get(r);k(s)||(s.delete(i),0===s.size&&t.delete(s))}return!0}};return y.registerProvider(r),r;function n(n,i,o){var s=t.get(n),a=!1;if(k(s)){if(!o)return;s=new l,t.set(n,s),a=!0}var u=s.get(i);if(k(u)){if(!o)return;if(u=new l,s.set(i,u),!e.setProvider(n,i,r))throw s.delete(i),a&&t.delete(n),new Error("Wrong provider for target.")}return u}}(y);function v(e,t,r){if(g(e,t,r))return!0;var n=L(t);return!x(n)&&v(e,n,r)}function g(e,t,r){var n=z(t,r,!1);return!k(n)&&O(n.OrdinaryHasOwnMetadata(e,t,r))}function m(e,t,r){if(g(e,t,r))return w(e,t,r);var n=L(t);return x(n)?void 0:m(e,n,r)}function w(e,t,r){var n=z(t,r,!1);if(!k(n))return n.OrdinaryGetOwnMetadata(e,t,r)}function S(e,t,r,n){z(r,n,!0).OrdinaryDefineOwnMetadata(e,t,r,n)}function A(e,t){var r=_(e,t),n=L(e);if(null===n)return r;var i=A(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var o=new h,s=[],a=0,u=r;a<u.length;a++){var c=u[a];o.has(c)||(o.add(c),s.push(c))}for(var f=0,l=i;f<l.length;f++)c=l[f],o.has(c)||(o.add(c),s.push(c));return s}function _(e,t){var r=z(e,t,!1);return r?r.OrdinaryOwnMetadataKeys(e,t):[]}function M(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function k(e){return void 0===e}function x(e){return null===e}function E(e){return"object"==typeof e?null!==e:"function"==typeof e}function B(e,t){switch(M(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",n=U(e,i);if(void 0!==n){var o=n.call(e,r);if(E(o))throw new TypeError;return o}return function(e,t){if("string"===t){var r=e.toString;if(P(r)&&!E(i=r.call(e)))return i;if(P(n=e.valueOf)&&!E(i=n.call(e)))return i}else{var n;if(P(n=e.valueOf)&&!E(i=n.call(e)))return i;var i,o=e.toString;if(P(o)&&!E(i=o.call(e)))return i}throw new TypeError}(e,"default"===r?"number":r)}function O(e){return!!e}function j(e){var t=B(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function I(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function P(e){return"function"==typeof e}function C(e){return"function"==typeof e}function N(e,t){return e===t||e!=e&&t!=t}function U(e,t){var r=e[t];if(null!=r){if(!P(r))throw new TypeError;return r}}function T(e){var t=U(e,o);if(!P(t))throw new TypeError;var r=t.call(e);if(!E(r))throw new TypeError;return r}function R(e){return e.value}function D(e){var t=e.next();return!t.done&&t}function K(e){var t=e.return;t&&t.call(e)}function L(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===f)return t;if(t!==f)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function z(e,t,r){var n=y.getProvider(e,t);if(!k(n))return n;if(r){if(y.setProvider(e,t,b))return b;throw new Error("Illegal state.")}}function H(e){return e.__=void 0,delete e.__,e}e("decorate",(function(e,t,r,n){if(k(r)){if(!I(e))throw new TypeError;if(!C(t))throw new TypeError;return function(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!k(n)&&!x(n)){if(!C(n))throw new TypeError;t=n}}return t}(e,t)}if(!I(e))throw new TypeError;if(!E(t))throw new TypeError;if(!E(n)&&!k(n)&&!x(n))throw new TypeError;return x(n)&&(n=void 0),function(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,r,n);if(!k(o)&&!x(o)){if(!E(o))throw new TypeError;n=o}}return n}(e,t,r=j(r),n)})),e("metadata",(function(e,t){return function(r,n){if(!E(r))throw new TypeError;if(!k(n)&&!function(e){switch(M(e)){case 3:case 4:return!0;default:return!1}}(n))throw new TypeError;S(e,t,r,n)}})),e("defineMetadata",(function(e,t,r,n){if(!E(r))throw new TypeError;return k(n)||(n=j(n)),S(e,t,r,n)})),e("hasMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return k(r)||(r=j(r)),v(e,t,r)})),e("hasOwnMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return k(r)||(r=j(r)),g(e,t,r)})),e("getMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return k(r)||(r=j(r)),m(e,t,r)})),e("getOwnMetadata",(function(e,t,r){if(!E(t))throw new TypeError;return k(r)||(r=j(r)),w(e,t,r)})),e("getMetadataKeys",(function(e,t){if(!E(e))throw new TypeError;return k(t)||(t=j(t)),A(e,t)})),e("getOwnMetadataKeys",(function(e,t){if(!E(e))throw new TypeError;return k(t)||(t=j(t)),_(e,t)})),e("deleteMetadata",(function(e,t,r){if(!E(t))throw new TypeError;if(k(r)||(r=j(r)),!E(t))throw new TypeError;k(r)||(r=j(r));var n=z(t,r,!1);return!k(n)&&n.OrdinaryDeleteMetadata(e,t,r)}))}(i,n),void 0===n.Reflect&&(n.Reflect=e)}()}(n||(n={}))},6573:e=>{"use strict";e.exports={i8:"6.5.5"}}},r={};function n(e){var i=r[e];if(void 0!==i)return i.exports;var o=r[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var i={};return(()=>{"use strict";n.r(i),n.d(i,{default:()=>ul,getPublicKeyIdFromAssertion:()=>al,parseAuthenticatorResponse:()=>il,verifyAssertion:()=>sl,verifyAttestation:()=>ol});var e={};let t,r,o;n.r(e),n.d(e,{Any:()=>jr,BaseBlock:()=>Ve,BaseStringBlock:()=>Je,BitString:()=>Ft,BmpString:()=>lr,Boolean:()=>Lt,CharacterString:()=>Ar,Choice:()=>Ir,Constructed:()=>Ut,DATE:()=>kr,DateTime:()=>Er,Duration:()=>Br,EndOfContent:()=>Rt,Enumerated:()=>Zt,GeneralString:()=>Sr,GeneralizedTime:()=>Mr,GraphicString:()=>mr,HexBlock:()=>Ke,IA5String:()=>gr,Integer:()=>Gt,Null:()=>Dt,NumericString:()=>pr,ObjectIdentifier:()=>Qt,OctetString:()=>Ht,Primitive:()=>It,PrintableString:()=>yr,RawData:()=>Cr,RelativeObjectIdentifier:()=>rr,Repeated:()=>Pr,Sequence:()=>nr,Set:()=>ir,TIME:()=>Or,TeletexString:()=>br,TimeOfDay:()=>xr,UTCTime:()=>_r,UniversalString:()=>dr,Utf8String:()=>cr,ValueBlock:()=>ze,VideotexString:()=>vr,ViewWriter:()=>we,VisibleString:()=>wr,compareSchema:()=>Nr,fromBER:()=>Ct,verifySchema:()=>Ur});try{t=new TextDecoder}catch(e){}let s=0;const a=[],u=57342,c=57343,f=57337,l={};let h,d,p,y,b,v,g,m=a,w=0,S={},A=0,_=0,M=[],k=[],x={useRecords:!1,mapsAsObjects:!0},E=!1,B=2;try{new Function("")}catch(e){B=1/0}class O{constructor(e){if(e&&(!e.keyMap&&!e._keyMap||e.useRecords||(e.useRecords=!1,e.mapsAsObjects=!0),!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[t,r]of Object.entries(e.keyMap))this.mapKey.set(r,t)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let t=new Map;for(let[r,n]of Object.entries(e))t.set(this._keyMap.hasOwnProperty(r)?this._keyMap[r]:r,n);return t}decodeKeys(e){if(!this._keyMap||"Map"!=e.constructor.name)return e;if(!this._mapKey){this._mapKey=new Map;for(let[e,t]of Object.entries(this._keyMap))this._mapKey.set(t,e)}let t={};return e.forEach(((e,r)=>t[N(this._mapKey.has(r)?this._mapKey.get(r):r)]=e)),t}mapDecode(e,t){let r=this.decode(e);return this._keyMap&&"Array"===r.constructor.name?r.map((e=>this.decodeKeys(e))):r}decode(e,t){if(r)return Q((()=>(ee(),this?this.decode(e,t):O.prototype.decode.call(x,e,t))));o=t>-1?t:e.length,s=0,w=0,_=0,d=null,m=a,p=null,r=e;try{v=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(t){if(r=null,e instanceof Uint8Array)throw t;throw new Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}if(this instanceof O){if(S=this,b=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return h=this.structures,j();(!h||h.length>0)&&(h=[])}else S=x,(!h||h.length>0)&&(h=[]),b=null;return j()}decodeMultiple(e,t){let r,n=0;try{let i=e.length;E=!0;let o=this?this.decode(e,i):re.decode(e,i);if(!t){for(r=[o];s<i;)n=s,r.push(j());return r}if(!1===t(o))return;for(;s<i;)if(n=s,!1===t(j()))return}catch(e){throw e.lastPosition=n,e.values=r,e}finally{E=!1,ee()}}}function j(){try{let e=I();if(p){if(s>=p.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}s=p.postBundlePosition,p=null}if(s==o)h=null,r=null,y&&(y=null);else{if(s>o){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}if(!E)throw new Error("Data read, but end of buffer not reached")}return e}catch(e){throw ee(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function I(){let e=r[s++],t=e>>5;if(e&=31,e>23)switch(e){case 24:e=r[s++];break;case 25:if(7==t)return function(){let e=r[s++],t=r[s++],n=(127&e)>>2;if(31===n)return t||3&e?NaN:128&e?-1/0:1/0;if(0===n){let r=((3&e)<<8|t)/(1<<24);return 128&e?-r:r}return L[3]=128&e|56+(n>>1),L[2]=(7&e)<<5|t>>3,L[1]=t<<5,L[0]=0,K[0]}();e=v.getUint16(s),s+=2;break;case 26:if(7==t){let e=v.getFloat32(s);if(S.useFloat32>2){let t=te[(127&r[s])<<1|r[s+1]>>7];return s+=4,(t*e+(e>0?.5:-.5)|0)/t}return s+=4,e}e=v.getUint32(s),s+=4;break;case 27:if(7==t){let e=v.getFloat64(s);return s+=8,e}if(t>1){if(v.getUint32(s)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");e=v.getUint32(s+4)}else S.int64AsNumber?(e=4294967296*v.getUint32(s),e+=v.getUint32(s+4)):e=v.getBigUint64(s);s+=8;break;case 31:switch(t){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let e,r=[],n=0;for(;(e=I())!=l;)r[n++]=e;return 4==t?r:3==t?r.join(""):Buffer.concat(r);case 5:let i;if(S.mapsAsObjects){let e={};if(S.keyMap)for(;(i=I())!=l;)e[N(S.decodeKey(i))]=I();else for(;(i=I())!=l;)e[N(i)]=I();return e}{g&&(S.mapsAsObjects=!0,g=!1);let e=new Map;if(S.keyMap)for(;(i=I())!=l;)e.set(S.decodeKey(i),I());else for(;(i=I())!=l;)e.set(i,I());return e}case 7:return l;default:throw new Error("Invalid major type for indefinite length "+t)}default:throw new Error("Unknown token "+e)}switch(t){case 0:return e;case 1:return~e;case 2:return n=e,S.copyBuffers?Uint8Array.prototype.slice.call(r,s,s+=n):r.subarray(s,s+=n);case 3:if(_>=s)return d.slice(s-A,(s+=e)-A);if(0==_&&o<140&&e<32){let t=e<16?D(e):function(e){let t=s,n=new Array(e);for(let i=0;i<e;i++){const e=r[s++];if((128&e)>0)return void(s=t);n[i]=e}return R.apply(String,n)}(e);if(null!=t)return t}return U(e);case 4:let t=new Array(e);for(let r=0;r<e;r++)t[r]=I();return t;case 5:if(S.mapsAsObjects){let t={};if(S.keyMap)for(let r=0;r<e;r++)t[N(S.decodeKey(I()))]=I();else for(let r=0;r<e;r++)t[N(I())]=I();return t}{g&&(S.mapsAsObjects=!0,g=!1);let t=new Map;if(S.keyMap)for(let r=0;r<e;r++)t.set(S.decodeKey(I()),I());else for(let r=0;r<e;r++)t.set(I(),I());return t}case 6:if(e>=f){let t=h[8191&e];if(t)return t.read||(t.read=C(t)),t.read();if(e<65536){if(e==c){let e=Y(),t=I(),r=I();H(t,r);let n={};if(S.keyMap)for(let t=2;t<e;t++)n[N(S.decodeKey(r[t-2]))]=I();else for(let t=2;t<e;t++)n[N(r[t-2])]=I();return n}if(e==u){let e=Y(),t=I();for(let r=2;r<e;r++)H(t++,I());return I()}if(e==f)return function(){let e=Y(),t=s+I();for(let t=2;t<e;t++){let e=Y();s+=e}let r=s;return s=t,p=[T(Y()),T(Y())],p.position0=0,p.position1=0,p.postBundlePosition=s,s=r,I()}();if(S.getShared&&(X(),t=h[8191&e],t))return t.read||(t.read=C(t)),t.read()}}let i=M[e];if(i)return i.handlesRead?i(I):i(I());{let t=I();for(let r=0;r<k.length;r++){let n=k[r](e,t);if(void 0!==n)return n}return new z(t,e)}case 7:switch(e){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;default:let t=(b||$())[e];if(void 0!==t)return t;throw new Error("Unknown token "+e)}default:if(isNaN(e)){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}throw new Error("Unknown CBOR token "+e)}var n}const P=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function C(e){return e.slowReads=0,function(){let e=r[s++];if(e&=31,e>23)switch(e){case 24:e=r[s++];break;case 25:e=v.getUint16(s),s+=2;break;case 26:e=v.getUint32(s),s+=4;break;default:throw new Error("Expected array header, but got "+r[s-1])}let t=this.compiledReader;for(;t;){if(t.propertyCount===e)return t(I);t=t.next}if(this.slowReads++>=B){let r=this.length==e?this:this.slice(0,e);return t=S.keyMap?new Function("r","return {"+r.map((e=>S.decodeKey(e))).map((e=>P.test(e)?N(e)+":r()":"["+JSON.stringify(e)+"]:r()")).join(",")+"}"):new Function("r","return {"+r.map((e=>P.test(e)?N(e)+":r()":"["+JSON.stringify(e)+"]:r()")).join(",")+"}"),this.compiledReader&&(t.next=this.compiledReader),t.propertyCount=e,this.compiledReader=t,t(I)}let n={};if(S.keyMap)for(let t=0;t<e;t++)n[N(S.decodeKey(this[t]))]=I();else for(let t=0;t<e;t++)n[N(this[t])]=I();return n}}function N(e){if("string"==typeof e)return"__proto__"===e?"__proto_":e;if("number"==typeof e||"boolean"==typeof e||"bigint"==typeof e)return e.toString();if(null==e)return e+"";throw new Error("Invalid property name type "+typeof e)}let U=T;function T(e){let n;if(e<16&&(n=D(e)))return n;if(e>64&&t)return t.decode(r.subarray(s,s+=e));const i=s+e,o=[];for(n="";s<i;){const e=r[s++];if(128&e)if(192==(224&e)){const t=63&r[s++];o.push((31&e)<<6|t)}else if(224==(240&e)){const t=63&r[s++],n=63&r[s++];o.push((31&e)<<12|t<<6|n)}else if(240==(248&e)){let t=(7&e)<<18|(63&r[s++])<<12|(63&r[s++])<<6|63&r[s++];t>65535&&(t-=65536,o.push(t>>>10&1023|55296),t=56320|1023&t),o.push(t)}else o.push(e);else o.push(e);o.length>=4096&&(n+=R.apply(String,o),o.length=0)}return o.length>0&&(n+=R.apply(String,o)),n}let R=String.fromCharCode;function D(e){if(e<4){if(e<2){if(0===e)return"";{let e=r[s++];return(128&e)>1?void(s-=1):R(e)}}{let t=r[s++],n=r[s++];if((128&t)>0||(128&n)>0)return void(s-=2);if(e<3)return R(t,n);let i=r[s++];return(128&i)>0?void(s-=3):R(t,n,i)}}{let t=r[s++],n=r[s++],i=r[s++],o=r[s++];if((128&t)>0||(128&n)>0||(128&i)>0||(128&o)>0)return void(s-=4);if(e<6){if(4===e)return R(t,n,i,o);{let e=r[s++];return(128&e)>0?void(s-=5):R(t,n,i,o,e)}}if(e<8){let a=r[s++],u=r[s++];if((128&a)>0||(128&u)>0)return void(s-=6);if(e<7)return R(t,n,i,o,a,u);let c=r[s++];return(128&c)>0?void(s-=7):R(t,n,i,o,a,u,c)}{let a=r[s++],u=r[s++],c=r[s++],f=r[s++];if((128&a)>0||(128&u)>0||(128&c)>0||(128&f)>0)return void(s-=8);if(e<10){if(8===e)return R(t,n,i,o,a,u,c,f);{let e=r[s++];return(128&e)>0?void(s-=9):R(t,n,i,o,a,u,c,f,e)}}if(e<12){let l=r[s++],h=r[s++];if((128&l)>0||(128&h)>0)return void(s-=10);if(e<11)return R(t,n,i,o,a,u,c,f,l,h);let d=r[s++];return(128&d)>0?void(s-=11):R(t,n,i,o,a,u,c,f,l,h,d)}{let l=r[s++],h=r[s++],d=r[s++],p=r[s++];if((128&l)>0||(128&h)>0||(128&d)>0||(128&p)>0)return void(s-=12);if(e<14){if(12===e)return R(t,n,i,o,a,u,c,f,l,h,d,p);{let e=r[s++];return(128&e)>0?void(s-=13):R(t,n,i,o,a,u,c,f,l,h,d,p,e)}}{let y=r[s++],b=r[s++];if((128&y)>0||(128&b)>0)return void(s-=14);if(e<15)return R(t,n,i,o,a,u,c,f,l,h,d,p,y,b);let v=r[s++];return(128&v)>0?void(s-=15):R(t,n,i,o,a,u,c,f,l,h,d,p,y,b,v)}}}}}let K=new Float32Array(1),L=new Uint8Array(K.buffer,0,4);new Array(4096);class z{constructor(e,t){this.value=e,this.tag=t}}M[0]=e=>new Date(e),M[1]=e=>new Date(Math.round(1e3*e)),M[2]=e=>{let t=BigInt(0);for(let r=0,n=e.byteLength;r<n;r++)t=BigInt(e[r])+t<<BigInt(8);return t},M[3]=e=>BigInt(-1)-M[2](e),M[4]=e=>+(e[1]+"e"+e[0]),M[5]=e=>e[1]*Math.exp(e[0]*Math.log(2));const H=(e,t)=>{let r=h[e-=57344];r&&r.isShared&&((h.restoreStructures||(h.restoreStructures=[]))[e]=r),h[e]=t,t.read=C(t)};M[105]=e=>{let t=e.length,r=e[1];H(e[0],r);let n={};for(let i=2;i<t;i++)n[N(r[i-2])]=e[i];return n},M[14]=e=>p?p[0].slice(p.position0,p.position0+=e):new z(e,14),M[15]=e=>p?p[1].slice(p.position1,p.position1+=e):new z(e,15);let q={Error,RegExp};M[27]=e=>(q[e[0]]||Error)(e[1],e[2]);const F=e=>{if(132!=r[s++]){let e=new Error("Packed values structure must be followed by a 4 element array");throw r.length<s&&(e.incomplete=!0),e}let t=e();if(!t||!t.length){let e=new Error("Packed values structure must be followed by a 4 element array");throw e.incomplete=!0,e}return b=b?t.concat(b.slice(t.length)):t,b.prefixes=e(),b.suffixes=e(),e()};function V(e,t){return"string"==typeof e?e+t:e instanceof Array?e.concat(t):Object.assign({},e,t)}function $(){if(!b){if(!S.getShared)throw new Error("No packed values available");X()}return b}F.handlesRead=!0,M[51]=F,M[6]=e=>{if(!b){if(!S.getShared)return new z(e,6);X()}if("number"==typeof e)return b[16+(e>=0?2*e:-2*e-1)];let t=new Error("No support for non-integer packed references yet");throw void 0===e&&(t.incomplete=!0),t},M[28]=e=>{y||(y=new Map,y.id=0);let t,n=y.id++,i=s;t=r[s]>>5==4?[]:{};let o={target:t};y.set(n,o);let a=e();return o.used?(Object.getPrototypeOf(t)!==Object.getPrototypeOf(a)&&(s=i,t=a,y.set(n,{target:t}),a=e()),Object.assign(t,a)):(o.target=a,a)},M[28].handlesRead=!0,M[29]=e=>{let t=y.get(e);return t.used=!0,t.target},M[258]=e=>new Set(e),(M[259]=e=>(S.mapsAsObjects&&(S.mapsAsObjects=!1,g=!0),e())).handlesRead=!0,k.push(((e,t)=>e>=225&&e<=255?V($().prefixes[e-224],t):e>=28704&&e<=32767?V($().prefixes[e-28672],t):e>=1879052288&&e<=2147483647?V($().prefixes[e-1879048192],t):e>=216&&e<=223?V(t,$().suffixes[e-216]):e>=27647&&e<=28671?V(t,$().suffixes[e-27639]):e>=1811940352&&e<=1879048191?V(t,$().suffixes[e-1811939328]):1399353956==e?{packedValues:b,structures:h.slice(0),version:t}:55799==e?t:void 0));const J=1==new Uint8Array(new Uint16Array([1]).buffer)[0],W=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,"undefined"==typeof BigUint64Array?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,"undefined"==typeof BigInt64Array?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],G=[64,68,69,70,71,72,77,78,79,85,86];for(let e=0;e<W.length;e++)Z(W[e],G[e]);function Z(e,t){let r,n="get"+e.name.slice(0,-5);"function"==typeof e?r=e.BYTES_PER_ELEMENT:e=null;for(let i=0;i<2;i++){if(!i&&1==r)continue;let o=2==r?1:4==r?2:8==r?3:0;M[i?t:t-4]=1==r||i==J?n=>{if(!e)throw new Error("Could not find typed array for code "+t);return S.copyBuffers||1!==r&&(2!==r||1&n.byteOffset)&&(4!==r||3&n.byteOffset)&&(8!==r||7&n.byteOffset)?new e(Uint8Array.prototype.slice.call(n,0).buffer):new e(n.buffer,n.byteOffset,n.byteLength>>o)}:r=>{if(!e)throw new Error("Could not find typed array for code "+t);let s=new DataView(r.buffer,r.byteOffset,r.byteLength),a=r.length>>o,u=new e(a),c=s[n];for(let e=0;e<a;e++)u[e]=c.call(s,e<<o,i);return u}}}function Y(){let e=31&r[s++];if(e>23)switch(e){case 24:e=r[s++];break;case 25:e=v.getUint16(s),s+=2;break;case 26:e=v.getUint32(s),s+=4}return e}function X(){if(S.getShared){let e=Q((()=>(r=null,S.getShared())))||{},t=e.structures||[];S.sharedVersion=e.version,b=S.sharedValues=e.packedValues,!0===h?S.structures=h=t:h.splice.apply(h,[0,t.length].concat(t))}}function Q(e){let t=o,n=s,i=w,a=A,u=_,c=d,f=m,l=y,b=p,g=new Uint8Array(r.slice(0,o)),M=h,k=S,x=E,B=e();return o=t,s=n,w=i,A=a,_=u,d=c,m=f,y=l,p=b,r=g,E=x,h=M,S=k,v=new DataView(r.buffer,r.byteOffset,r.byteLength),B}function ee(){r=null,y=null,h=null}const te=new Array(147);for(let e=0;e<256;e++)te[e]=+("1e"+Math.floor(45.15-.30103*e));let re=new O({useRecords:!1});const ne=re.decode;re.decodeMultiple;var ie=n(4471),oe=n.n(ie),se=function(){return"undefined"!=typeof window&&void 0!==window.jscu?window.jscu:n(5893)},ae=n(5872);window.Buffer=window.Buffer||ae.Buffer;var ue=function(e){return e.id===oe().encoder.encodeBase64Url(new Uint8Array(e.rawId))},ce=function(e,t,r,n){return i=void 0,o=void 0,a=function(){var i,o,s,a;return function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}(this,(function(u){switch(u.label){case 0:return i=se(),e.type!==r?[2,{valid:!1,msg:"InvalidType"}]:oe().encoder.encodeBase64Url(n)!==e.challenge?[2,{valid:!1,msg:"InvalidChallenge"}]:(o=new URL(e.origin).hostname,[4,i.hash.compute(oe().encoder.stringToArrayBuffer(o),"SHA-256")]);case 1:return s=u.sent(),oe().encoder.encodeBase64(t.slice(0,32))!==oe().encoder.encodeBase64(s)?[2,{valid:!1,msg:"InvalidRpIdHash"}]:1&~(a=new Uint8Array([t[32]]))[0]||"webauthn.create"===r&&64&~a[0]?[2,{valid:!1,msg:"InvalidFlag"}]:[2,{valid:!0,msg:"ok"}]}}))},new((s=Promise)||(s=Promise))((function(e,t){function r(e){try{u(a.next(e))}catch(e){t(e)}}function n(e){try{u(a.throw(e))}catch(e){t(e)}}function u(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(r,n)}u((a=a.apply(i,o||[])).next())}));var i,o,s,a},fe=function(e){var t=Object.prototype.toString.call(e).slice(8,-1),r=JSON.parse(oe().encoder.arrayBufferToString(new Uint8Array(e.clientDataJSON)));return"AuthenticatorAttestationResponse"===t?{clientDataJSON:r,attestationObject:ne(ae.Buffer.from(e.attestationObject))}:{clientDataJSON:r,authenticatorData:new Uint8Array(e.authenticatorData),signature:new Uint8Array(e.signature),userHandle:e.userHandle}},le=(n(9736),n(7172));function he(e,t){let r=0;if(1===e.length)return e[0];for(let n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function de(e,t,r=-1){const n=r;let i=e,o=0,s=Math.pow(2,t);for(let r=1;r<8;r++){if(e<s){let e;if(n<0)e=new ArrayBuffer(r),o=r;else{if(n<r)return new ArrayBuffer(0);e=new ArrayBuffer(n),o=n}const s=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);s[o-e-1]=Math.floor(i/r),i-=s[o-e-1]*r}return e}s*=Math.pow(2,t)}return new ArrayBuffer(0)}function pe(...e){let t=0,r=0;for(const r of e)t+=r.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(t,r),r+=t.length;return i}function ye(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&!(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const n=he(r,8),i=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(i);for(let t=0;t<this.valueHex.byteLength;t++)o[t]=e[t];return o[0]&=127,he(o,8)-n}function be(e,t){const r=e.toString(10);if(t<r.length)return"";const n=t-r.length,i=new Array(n);for(let e=0;e<n;e++)i[e]="0";return i.join("").concat(r)}function ve(){if("undefined"==typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function ge(e){let t=0,r=0;for(let r=0;r<e.length;r++)t+=e[r].byteLength;const n=new Uint8Array(t);for(let t=0;t<e.length;t++){const i=e[t];n.set(new Uint8Array(i),r),r+=i.byteLength}return n.buffer}function me(e,t,r,n){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0&&(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",1)):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}Math.log(2);class we{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return ge(this.items)}}const Se=[new Uint8Array([1])],Ae="0123456789",_e="name",Me="valueHexView",ke="isHexOnly",xe="idBlock",Ee="tagClass",Be="tagNumber",Oe="isConstructed",je="fromBER",Ie="toBER",Pe="local",Ce="",Ne=new ArrayBuffer(0),Ue=new Uint8Array(0),Te="EndOfContent",Re="OCTET STRING",De="BIT STRING";function Ke(e){var t;return(t=class extends e{constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!==(t=r.isHexOnly)&&void 0!==t&&t,this.valueHexView=r.valueHex?le.vJ.toUint8Array(r.valueHex):Ue}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}fromBER(e,t,r){const n=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!me(this,n,t,r))return-1;const i=t+r;return this.valueHexView=n.subarray(t,i),this.valueHexView.length?(this.blockLength=r,i):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Ne)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:le.ep.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class Le{constructor({blockLength:e=0,error:t=Ce,warnings:r=[],valueBeforeDecode:n=Ue}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=le.vJ.toUint8Array(n)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:le.ep.ToHex(this.valueBeforeDecodeView)}}}Le.NAME="baseBlock";class ze extends Le{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}ze.NAME="valueBlock";class He extends(Ke(Le)){constructor({idBlock:e={}}={}){var t,r,n,i;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?le.vJ.toUint8Array(e.valueHex):Ue,this.tagClass=null!==(r=e.tagClass)&&void 0!==r?r:-1,this.tagNumber=null!==(n=e.tagNumber)&&void 0!==n?n:-1,this.isConstructed=null!==(i=e.isConstructed)&&void 0!==i&&i):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",Ne}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){const r=de(this.tagNumber,7),n=new Uint8Array(r),i=r.byteLength,o=new Uint8Array(i+1);if(o[0]=31|t,!e){for(let e=0;e<i-1;e++)o[e+1]=128|n[e];o[i]=n[i-1]}return o.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){const e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){const n=le.vJ.toUint8Array(e);if(!me(this,n,t,r))return-1;const i=n.subarray(t,t+r);if(0===i.length)return this.error="Zero buffer length",-1;switch(192&i[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=!(32&~i[0]),this.isHexOnly=!1;const o=31&i[0];if(31!==o)this.tagNumber=o,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&i[e];){if(t[e-1]=127&i[e],e++,e>=i.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){r+=255;const e=new Uint8Array(r);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&i[e];const n=new Uint8Array(e);for(let r=0;r<e;r++)n[r]=t[r];t=this.valueHexView=new Uint8Array(e),t.set(n),this.blockLength<=9?this.tagNumber=he(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}He.NAME="identificationBlock";class qe extends Le{constructor({lenBlock:e={}}={}){var t,r,n;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(r=e.longFormUsed)&&void 0!==r&&r,this.length=null!==(n=e.length)&&void 0!==n?n:0}fromBER(e,t,r){const n=le.vJ.toUint8Array(e);if(!me(this,n,t,r))return-1;const i=n.subarray(t,t+r);if(0===i.length)return this.error="Zero buffer length",-1;if(255===i[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===i[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&i[0]),!1===this.longFormUsed)return this.length=i[0],this.blockLength=1,t+this.blockLength;const o=127&i[0];if(o>8)return this.error="Too big integer",-1;if(o+1>i.length)return this.error="End of input reached before message was fully decoded",-1;const s=t+1,a=n.subarray(s,s+o);return 0===a[o-1]&&this.warnings.push("Needlessly long encoded length"),this.length=he(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const n=de(this.length,8);if(n.byteLength>127)return this.error="Too big length",Ne;if(t=new ArrayBuffer(n.byteLength+1),e)return t;const i=new Uint8Array(n);r=new Uint8Array(t),r[0]=128|n.byteLength;for(let e=0;e<n.byteLength;e++)r[e+1]=i[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}qe.NAME="lengthBlock";const Fe={};class Ve extends Le{constructor({name:e=Ce,optional:t=!1,primitiveSchema:r,...n}={},i){super(n),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new He(n),this.lenBlock=new qe(n),this.valueBlock=i?new i(n):new ze(n)}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e,t){const r=t||new we;t||$e(this);const n=this.idBlock.toBER(e);if(r.write(n),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;const n=this.lenBlock.toBER(e);r.write(n),r.write(t)}return t?Ne:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():le.ep.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${le.ep.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){return this===e||e instanceof this.constructor&&function(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}(this.toBER(),e.toBER())}}function $e(e){if(e instanceof Fe.Constructed)for(const t of e.valueBlock.value)$e(t)&&(e.lenBlock.isIndefiniteForm=!0);return!!e.lenBlock.isIndefiniteForm}Ve.NAME="BaseBlock";class Je extends Ve{constructor({value:e=Ce,...t}={},r){super(t,r),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}Je.NAME="BaseStringBlock";class We extends(Ke(ze)){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}var Ge,Ze,Ye,Xe,Qe,et,tt,rt,nt,it,ot,st,at,ut,ct,ft,lt,ht,dt,pt,yt,bt,vt,gt,mt,wt,St,At,_t,Mt,kt,xt,Et,Bt,Ot,jt;We.NAME="PrimitiveValueBlock";class It extends Ve{constructor(e={}){super(e,We),this.idBlock.isConstructed=!1}}function Pt(e,t=0,r=e.length){const n=t;let i=new Ve({},ze);const o=new Le;if(!me(o,e,t,r))return i.error=o.error,{offset:-1,result:i};if(!e.subarray(t,t+r).length)return i.error="Zero buffer length",{offset:-1,result:i};let s=i.idBlock.fromBER(e,t,r);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),-1===s)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=s,r-=i.idBlock.blockLength,s=i.lenBlock.fromBER(e,t,r),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),-1===s)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=s,r-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let a=Ve;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};a=Fe.EndOfContent;break;case 1:a=Fe.Boolean;break;case 2:a=Fe.Integer;break;case 3:a=Fe.BitString;break;case 4:a=Fe.OctetString;break;case 5:a=Fe.Null;break;case 6:a=Fe.ObjectIdentifier;break;case 10:a=Fe.Enumerated;break;case 12:a=Fe.Utf8String;break;case 13:a=Fe.RelativeObjectIdentifier;break;case 14:a=Fe.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:a=Fe.Sequence;break;case 17:a=Fe.Set;break;case 18:a=Fe.NumericString;break;case 19:a=Fe.PrintableString;break;case 20:a=Fe.TeletexString;break;case 21:a=Fe.VideotexString;break;case 22:a=Fe.IA5String;break;case 23:a=Fe.UTCTime;break;case 24:a=Fe.GeneralizedTime;break;case 25:a=Fe.GraphicString;break;case 26:a=Fe.VisibleString;break;case 27:a=Fe.GeneralString;break;case 28:a=Fe.UniversalString;break;case 29:a=Fe.CharacterString;break;case 30:a=Fe.BmpString;break;case 31:a=Fe.DATE;break;case 32:a=Fe.TimeOfDay;break;case 33:a=Fe.DateTime;break;case 34:a=Fe.Duration;break;default:{const e=i.idBlock.isConstructed?new Fe.Constructed:new Fe.Primitive;e.idBlock=i.idBlock,e.lenBlock=i.lenBlock,e.warnings=i.warnings,i=e}}}else a=i.idBlock.isConstructed?Fe.Constructed:Fe.Primitive;return i=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(i,a),s=i.fromBER(e,t,i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecodeView=e.subarray(n,n+i.blockLength),{offset:s,result:i}}function Ct(e){if(!e.byteLength){const e=new Ve({},ze);return e.error="Input buffer has zero length",{offset:-1,result:e}}return Pt(le.vJ.toUint8Array(e).slice(),0,e.byteLength)}Ge=It,Fe.Primitive=Ge,It.NAME="PRIMITIVE";class Nt extends ze{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const n=le.vJ.toUint8Array(e);if(!me(this,n,t,r))return-1;if(this.valueBeforeDecodeView=n.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let i=t;for(;(this.isIndefiniteForm?1:r)>0;){const e=Pt(n,i,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(i=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===Te)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Te?this.value.pop():this.warnings.push("No EndOfContent block encoded")),i}toBER(e,t){const r=t||new we;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?Ne:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}Nt.NAME="ConstructedValueBlock";class Ut extends Ve{constructor(e={}){super(e,Nt),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){const e=[];for(const t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map((e=>`  ${e}`)).join("\n"));const t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :\n${e.join("\n")}`:`${t} :`}}Ze=Ut,Fe.Constructed=Ze,Ut.NAME="CONSTRUCTED";class Tt extends ze{fromBER(e,t,r){return t}toBER(e){return Ne}}Tt.override="EndOfContentValueBlock";class Rt extends Ve{constructor(e={}){super(e,Tt),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}Ye=Rt,Fe.EndOfContent=Ye,Rt.NAME=Te;class Dt extends Ve{constructor(e={}){super(e,ze),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){const r=new ArrayBuffer(2);if(!e){const e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}Xe=Dt,Fe.Null=Xe,Dt.NAME="NULL";class Kt extends(Ke(ze)){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=le.vJ.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,r){const n=le.vJ.toUint8Array(e);return me(this,n,t,r)?(this.valueHexView=n.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,ye.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}Kt.NAME="BooleanValueBlock";class Lt extends Ve{constructor(e={}){super(e,Kt),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}Qe=Lt,Fe.Boolean=Qe,Lt.NAME="BOOLEAN";class zt extends(Ke(Nt)){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,n=Nt.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.NAME;if(t===Te){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==Re)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e,t){return this.isConstructed?Nt.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}zt.NAME="OctetStringValueBlock";class Ht extends Ve{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},zt),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(n.byteLength){const e=Pt(n,0,n.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch(e){}}return super.fromBER(e,t,r)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?Ut.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${le.ep.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof Ht&&e.push(t.valueBlock.valueHexView);return le.vJ.concat(e)}}et=Ht,Fe.OctetString=et,Ht.NAME=Re;class qt extends(Ke(Nt)){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let n=-1;if(this.isConstructed){if(n=Nt.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(const e of this.value){const t=e.constructor.NAME;if(t===Te){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==De)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return n}const i=le.vJ.toUint8Array(e);if(!me(this,i,t,r))return-1;const o=i.subarray(t,t+r);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const e=o.subarray(1);try{if(e.byteLength){const t=Pt(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch(e){}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,t+r}toBER(e,t){if(this.isConstructed)return Nt.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Ne;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}qt.NAME="BitStringValueBlock";class Ft extends Ve{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},qt),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return Ut.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const r of t)e.push(r.toString(2).padStart(8,"0"));const r=e.join("");return`${this.constructor.NAME} : ${r.substring(0,r.length-this.valueBlock.unusedBits)}`}}}function Vt(e,t){const r=new Uint8Array([0]),n=new Uint8Array(e),i=new Uint8Array(t);let o=n.slice(0);const s=o.length-1,a=i.slice(0),u=a.length-1;let c=0,f=0;for(let e=u<s?s:u;e>=0;e--,f++)c=1==f<a.length?o[s-f]+a[u-f]+r[0]:o[s-f]+r[0],r[0]=c/10,1==f>=o.length?o=pe(new Uint8Array([c%10]),o):o[s-f]=c%10;return r[0]>0&&(o=pe(r,o)),o}function $t(e){if(e>=Se.length)for(let t=Se.length;t<=e;t++){const e=new Uint8Array([0]);let r=Se[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const n=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=n[0]/10,r[t]=n[0]%10}e[0]>0&&(r=pe(e,r)),Se.push(r)}return Se[e]}function Jt(e,t){let r=0;const n=new Uint8Array(e),i=new Uint8Array(t),o=n.slice(0),s=o.length-1,a=i.slice(0),u=a.length-1;let c,f=0;for(let e=u;e>=0;e--,f++)c=o[s-f]-a[u-f]-r,1==c<0?(r=1,o[s-f]=c+10):(r=0,o[s-f]=c);if(r>0)for(let e=s-u+1;e>=0;e--,f++){if(c=o[s-f]-r,!(c<0)){r=0,o[s-f]=c;break}r=1,o[s-f]=c+10}return o.slice()}tt=Ft,Fe.BitString=tt,Ft.NAME=De;class Wt extends(Ke(ze)){constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=ye.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){const t=e<0?-1*e:e;let r=128;for(let n=1;n<8;n++){if(t<=r){if(e<0){const e=de(r-t,8,n);return new Uint8Array(e)[0]|=128,e}let i=de(t,8,n),o=new Uint8Array(i);if(128&o[0]){const e=i.slice(0),t=new Uint8Array(e);i=new ArrayBuffer(i.byteLength+1),o=new Uint8Array(i);for(let r=0;r<e.byteLength;r++)o[r+1]=t[r];o[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const i=this.fromBER(e,t,r);if(-1===i)return i;const o=this.valueHexView;return 0===o[0]&&128&o[1]?this.valueHexView=o.subarray(1):0!==n&&o.length<n&&(n-o.length>1&&(n=o.length+1),this.valueHexView=o.subarray(n-o.length)),i}toDER(e=!1){const t=this.valueHexView;switch(!0){case!!(128&t[0]):{const e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&!(128&t[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return-1===n||this.setValueHex(),n}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=8*this.valueHexView.length-1;let t,r=new Uint8Array(8*this.valueHexView.length/3),n=0;const i=this.valueHexView;let o="",s=!1;for(let s=i.byteLength-1;s>=0;s--){t=i[s];for(let i=0;i<8;i++)1&~t||(n===e?(r=Jt($t(n),r),o="-"):r=Vt(r,$t(n))),n++,t>>=1}for(let e=0;e<r.length;e++)r[e]&&(s=!0),s&&(o+=Ae.charAt(r[e]));return!1===s&&(o+=Ae.charAt(0)),o}}rt=Wt,Wt.NAME="IntegerValueBlock",Object.defineProperty(rt.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class Gt extends Ve{constructor(e={}){super(e,Wt),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return ve(),BigInt(this.valueBlock.toString())}static fromBigInt(e){ve();const t=BigInt(e),r=new we,n=t.toString(16).replace(/^-/,""),i=new Uint8Array(le.ep.FromHex(n));if(t<0){const e=new Uint8Array(i.length+(128&i[0]?1:0));e[0]|=128;const n=BigInt(`0x${le.ep.ToHex(e)}`)+t,o=le.vJ.toUint8Array(le.ep.FromHex(n.toString(16)));o[0]|=128,r.write(o)}else 128&i[0]&&r.write(new Uint8Array([0])),r.write(i);return new Gt({valueHex:r.final()})}convertToDER(){const e=new Gt({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new Gt({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}nt=Gt,Fe.Integer=nt,Gt.NAME="INTEGER";class Zt extends Gt{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}it=Zt,Fe.Enumerated=it,Zt.NAME="ENUMERATED";class Yt extends(Ke(ze)){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const n=le.vJ.toUint8Array(e);if(!me(this,n,t,r))return-1;const i=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&i[e],this.blockLength++,128&i[e]);e++);const o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return this.valueHexView=o,128&i[this.blockLength-1]?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=he(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){ve();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+(e+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=de(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Ne;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r}toString(){let e="";if(this.isHexOnly)e=le.ep.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}Yt.NAME="sidBlock";class Xt extends ze{constructor({value:e=Ce,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new Yt;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,Ne;t.push(n)}return ge(t)}fromString(e){this.value=[];let t=0,r=0,n="",i=!1;do{if(r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return void(this.value=[])}const r=parseInt(n,10);if(isNaN(r))return;e.valueDec=r+t,i=!1}else{const e=new Yt;if(n>Number.MAX_SAFE_INTEGER){ve();const t=BigInt(n);e.valueBigInt=t}else if(e.valueDec=parseInt(n,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Xt.NAME="ObjectIdentifierValueBlock";class Qt extends Ve{constructor(e={}){super(e,Xt),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}ot=Qt,Fe.ObjectIdentifier=ot,Qt.NAME="OBJECT IDENTIFIER";class er extends(Ke(Le)){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;const n=le.vJ.toUint8Array(e);if(!me(this,n,t,r))return-1;const i=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&i[e],this.blockLength++,128&i[e]);e++);const o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return this.valueHexView=o,128&i[this.blockLength-1]?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=he(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=de(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Ne;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r.buffer}toString(){let e="";return e=this.isHexOnly?le.ep.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}er.NAME="relativeSidBlock";class tr extends ze{constructor({value:e=Ce,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new er;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e,t){const r=[];for(let t=0;t<this.value.length;t++){const n=this.value[t].toBER(e);if(0===n.byteLength)return this.error=this.value[t].error,Ne;r.push(n)}return ge(r)}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1;const i=new er;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}tr.NAME="RelativeObjectIdentifierValueBlock";class rr extends Ve{constructor(e={}){super(e,tr),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}st=rr,Fe.RelativeObjectIdentifier=st,rr.NAME="RelativeObjectIdentifier";class nr extends Ut{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}at=nr,Fe.Sequence=at,nr.NAME="SEQUENCE";class ir extends Ut{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}ut=ir,Fe.Set=ut,ir.NAME="SET";class or extends(Ke(ze)){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=Ce}toJSON(){return{...super.toJSON(),value:this.value}}}or.NAME="StringValueBlock";class sr extends or{}sr.NAME="SimpleStringValueBlock";class ar extends Je{constructor({...e}={}){super(e,sr)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,le.vJ.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}ar.NAME="SIMPLE STRING";class ur extends ar{fromBuffer(e){this.valueBlock.valueHexView=le.vJ.toUint8Array(e);try{this.valueBlock.value=le.ep.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=le.ep.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(le.ep.FromUtf8String(e)),this.valueBlock.value=e}}ur.NAME="Utf8StringValueBlock";class cr extends ur{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}ct=cr,Fe.Utf8String=ct,cr.NAME="UTF8String";class fr extends ar{fromBuffer(e){this.valueBlock.value=le.ep.ToUtf16String(e),this.valueBlock.valueHexView=le.vJ.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(le.ep.FromUtf16String(e))}}fr.NAME="BmpStringValueBlock";class lr extends fr{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}ft=lr,Fe.BmpString=ft,lr.NAME="BMPString";class hr extends ar{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let n=0;n<t;n++){const t=de(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>4)continue;const o=4-i.length;for(let e=i.length-1;e>=0;e--)r[4*n+e+o]=i[e]}this.valueBlock.value=e}}hr.NAME="UniversalStringValueBlock";class dr extends hr{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}lt=dr,Fe.UniversalString=lt,dr.NAME="UniversalString";class pr extends ar{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}ht=pr,Fe.NumericString=ht,pr.NAME="NumericString";class yr extends ar{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}dt=yr,Fe.PrintableString=dt,yr.NAME="PrintableString";class br extends ar{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}pt=br,Fe.TeletexString=pt,br.NAME="TeletexString";class vr extends ar{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}yt=vr,Fe.VideotexString=yt,vr.NAME="VideotexString";class gr extends ar{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}bt=gr,Fe.IA5String=bt,gr.NAME="IA5String";class mr extends ar{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}vt=mr,Fe.GraphicString=vt,mr.NAME="GraphicString";class wr extends ar{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}gt=wr,Fe.VisibleString=gt,wr.NAME="VisibleString";class Sr extends ar{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}mt=Sr,Fe.GeneralString=mt,Sr.NAME="GeneralString";class Ar extends ar{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}wt=Ar,Fe.CharacterString=wt,Ar.NAME="CharacterString";class _r extends wr{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,le.vJ.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for conversion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){const e=new Array(7);return e[0]=be(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=be(this.month,2),e[2]=be(this.day,2),e[3]=be(this.hour,2),e[4]=be(this.minute,2),e[5]=be(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}St=_r,Fe.UTCTime=St,_r.NAME="UTCTime";class Mr extends _r{constructor(e={}){var t;super(e),null!==(t=this.millisecond)&&void 0!==t||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,n="",i="",o=0,s=0,a=0;if("Z"===e[e.length-1])n=e.substring(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let e=1,t=n.indexOf("+"),r="";if(-1===t&&(t=n.indexOf("-"),e=-1),-1!==t){if(r=n.substring(t+1),n=n.substring(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for conversion");let i=parseInt(r.substring(0,2),10);if(isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");if(s=e*i,4===r.length){if(i=parseInt(r.substring(2,4),10),isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");a=e*i}}}let u=n.indexOf(".");if(-1===u&&(u=n.indexOf(",")),-1!==u){const e=new Number(`0${n.substring(u)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");o=e.valueOf(),i=n.substring(0,u)}else i=n;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==u)throw new Error("Wrong input string for conversion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==u){let e=60*o;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==u){let e=60*o;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==u){const e=1e3*o;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for conversion")}const c=t.exec(i);if(null===c)throw new Error("Wrong input string for conversion");for(let e=1;e<c.length;e++)switch(e){case 1:this.year=parseInt(c[e],10);break;case 2:this.month=parseInt(c[e],10);break;case 3:this.day=parseInt(c[e],10);break;case 4:this.hour=parseInt(c[e],10)+s;break;case 5:this.minute=parseInt(c[e],10)+a;break;case 6:this.second=parseInt(c[e],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){const e=[];return e.push(be(this.year,4)),e.push(be(this.month,2)),e.push(be(this.day,2)),e.push(be(this.hour,2)),e.push(be(this.minute,2)),e.push(be(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(be(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}At=Mr,Fe.GeneralizedTime=At,Mr.NAME="GeneralizedTime";class kr extends cr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}_t=kr,Fe.DATE=_t,kr.NAME="DATE";class xr extends cr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}Mt=xr,Fe.TimeOfDay=Mt,xr.NAME="TimeOfDay";class Er extends cr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}kt=Er,Fe.DateTime=kt,Er.NAME="DateTime";class Br extends cr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}xt=Br,Fe.Duration=xt,Br.NAME="Duration";class Or extends cr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}Et=Or,Fe.TIME=Et,Or.NAME="TIME";class jr{constructor({name:e=Ce,optional:t=!1}={}){this.name=e,this.optional=t}}class Ir extends jr{constructor({value:e=[],...t}={}){super(t),this.value=e}}class Pr extends jr{constructor({value:e=new jr,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class Cr{constructor({data:e=Ue}={}){this.dataView=le.vJ.toUint8Array(e)}get data(){return this.dataView.slice().buffer}set data(e){this.dataView=le.vJ.toUint8Array(e)}fromBER(e,t,r){const n=t+r;return this.dataView=le.vJ.toUint8Array(e).subarray(t,n),n}toBER(e){return this.dataView.slice().buffer}}function Nr(e,t,r){if(r instanceof Ir){for(let n=0;n<r.value.length;n++)if(Nr(e,t,r.value[n]).verified)return{verified:!0,result:e};{const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(_e)&&(e.name=r.name),e}}if(r instanceof jr)return r.hasOwnProperty(_e)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==0)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(xe in r==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(je in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(Ie in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.toBER(!1);if(0===n.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(n,0,n.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty(Ee))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty(Be))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty(Oe))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!(ke in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(Me in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.valueHexView,i=t.idBlock.valueHexView;if(n.length!==i.length)return{verified:!1,result:e};for(let t=0;t<n.length;t++)if(n[t]!==i[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ce),r.name&&(e[r.name]=t)),r instanceof Fe.Constructed){let n=0,i={verified:!1,result:{error:"Unknown error"}},o=r.valueBlock.value.length;if(o>0&&r.valueBlock.value[0]instanceof Pr&&(o=t.valueBlock.value.length),0===o)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ce),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let s=0;s<o;s++)if(s-n>=t.valueBlock.value.length){if(!1===r.valueBlock.value[s].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ce),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof Pr){if(i=Nr(e,t.valueBlock.value[s],r.valueBlock.value[0].value),!1===i.verified){if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ce),r.name&&delete e[r.name]),i;n++}if(_e in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let n={};n=Pe in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e,void 0===n[r.valueBlock.value[0].name]&&(n[r.valueBlock.value[0].name]=[]),n[r.valueBlock.value[0].name].push(t.valueBlock.value[s])}}else if(i=Nr(e,t.valueBlock.value[s-n],r.valueBlock.value[s]),!1===i.verified){if(!r.valueBlock.value[s].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ce),r.name&&delete e[r.name]),i;n++}if(!1===i.verified){const t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ce),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&Me in t.valueBlock){const n=Pt(t.valueBlock.valueHexView);if(-1===n.offset){const t={verified:!1,result:n.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Ce),r.name&&(delete e[r.name],t.name=r.name)),t}return Nr(e,n.result,r.primitiveSchema)}return{verified:!0,result:e}}function Ur(e,t){if(t instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const r=Pt(le.vJ.toUint8Array(e));return-1===r.offset?{verified:!1,result:r.result}:Nr(r.result,r.result,t)}(jt=Bt||(Bt={}))[jt.Sequence=0]="Sequence",jt[jt.Set=1]="Set",jt[jt.Choice=2]="Choice",function(e){e[e.Any=1]="Any",e[e.Boolean=2]="Boolean",e[e.OctetString=3]="OctetString",e[e.BitString=4]="BitString",e[e.Integer=5]="Integer",e[e.Enumerated=6]="Enumerated",e[e.ObjectIdentifier=7]="ObjectIdentifier",e[e.Utf8String=8]="Utf8String",e[e.BmpString=9]="BmpString",e[e.UniversalString=10]="UniversalString",e[e.NumericString=11]="NumericString",e[e.PrintableString=12]="PrintableString",e[e.TeletexString=13]="TeletexString",e[e.VideotexString=14]="VideotexString",e[e.IA5String=15]="IA5String",e[e.GraphicString=16]="GraphicString",e[e.VisibleString=17]="VisibleString",e[e.GeneralString=18]="GeneralString",e[e.CharacterString=19]="CharacterString",e[e.UTCTime=20]="UTCTime",e[e.GeneralizedTime=21]="GeneralizedTime",e[e.DATE=22]="DATE",e[e.TimeOfDay=23]="TimeOfDay",e[e.DateTime=24]="DateTime",e[e.Duration=25]="Duration",e[e.TIME=26]="TIME",e[e.Null=27]="Null"}(Ot||(Ot={}));class Tr{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else{if(!le.vJ.isBufferSource(e))throw TypeError("Unsupported type of 'params' argument for BitString");this.unusedBits=t,this.value=le.vJ.toArrayBuffer(e)}}fromASN(e){if(!(e instanceof Ft))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new Ft({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new Ft({name:e})}toNumber(){let e="";const t=new Uint8Array(this.value);for(const r of t)e+=r.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2);const r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;const n=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let i=0;for(;i<r;)n[i]=parseInt(t.slice(i<<3,8+(i<<3)),2),i++;this.value=n.buffer}}class Rr{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):le.vJ.isBufferSource(e)?this.buffer=le.vJ.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}fromASN(e){if(!(e instanceof Ht))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new Ht({valueHex:this.buffer})}toSchema(e){return new Ht({name:e})}}const Dr={fromASN:e=>e instanceof Dt?null:e.valueBeforeDecodeView,toASN:e=>{if(null===e)return new Dt;const t=Ct(e);if(t.result.error)throw new Error(t.result.error);return t.result}},Kr={fromASN:e=>e.valueBlock.valueHexView.byteLength>=4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new Gt({value:+e})},Lr={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new Zt({value:e})},zr={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new Gt({valueHex:e})},Hr={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new Ft({valueHex:e})},qr={fromASN:e=>e.valueBlock.toString(),toASN:e=>new Qt({value:e})},Fr={fromASN:e=>e.valueBlock.value,toASN:e=>new Lt({value:e})},Vr={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new Ht({valueHex:e})},$r={fromASN:e=>new Rr(e.getValue()),toASN:e=>e.toASN()};function Jr(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}const Wr=Jr(cr),Gr=Jr(lr),Zr=Jr(dr),Yr=Jr(pr),Xr=Jr(yr),Qr=Jr(br),en=Jr(vr),tn=Jr(gr),rn=Jr(mr),nn=Jr(wr),on=Jr(Sr),sn=Jr(Ar),an={fromASN:e=>e.toDate(),toASN:e=>new _r({valueDate:e})},un={fromASN:e=>e.toDate(),toASN:e=>new Mr({valueDate:e})},cn={fromASN:()=>null,toASN:()=>new Dt};function fn(e){switch(e){case Ot.Any:return Dr;case Ot.BitString:return Hr;case Ot.BmpString:return Gr;case Ot.Boolean:return Fr;case Ot.CharacterString:return sn;case Ot.Enumerated:return Lr;case Ot.GeneralString:return on;case Ot.GeneralizedTime:return un;case Ot.GraphicString:return rn;case Ot.IA5String:return tn;case Ot.Integer:return Kr;case Ot.Null:return cn;case Ot.NumericString:return Yr;case Ot.ObjectIdentifier:return qr;case Ot.OctetString:return Vr;case Ot.PrintableString:return Xr;case Ot.TeletexString:return Qr;case Ot.UTCTime:return an;case Ot.UniversalString:return Zr;case Ot.Utf8String:return Wr;case Ot.VideotexString:return en;case Ot.VisibleString:return nn;default:return null}}function ln(e){return"function"==typeof e&&e.prototype?!(!e.prototype.toASN||!e.prototype.fromASN)||ln(e.prototype):!!(e&&"object"==typeof e&&"toASN"in e&&"fromASN"in e)}function hn(e){var t;if(e){const r=Object.getPrototypeOf(e);return(null===(t=null==r?void 0:r.prototype)||void 0===t?void 0:t.constructor)===Array||hn(r)}return!1}function dn(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==n[t])return!1;return!0}const pn=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){const r=this.items.get(e);if(!r)throw new Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!r.schema)throw new Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return r}cache(e){const t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){const t={type:Bt.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(t,r){const n=this.items.get(t)||this.createDefault(t),i=[];for(const t in n.items){const o=n.items[t],s=r?t:"";let a;if("number"==typeof o.type){const t=Ot[o.type],r=e[t];if(!r)throw new Error(`Cannot get ASN1 class by name '${t}'`);a=new r({name:s})}else ln(o.type)?a=(new o.type).toSchema(s):o.optional?this.get(o.type).type===Bt.Choice?a=new jr({name:s}):(a=this.create(o.type,!1),a.name=s):a=new jr({name:s});const u=!!o.optional||void 0!==o.defaultValue;if(o.repeated&&(a.name="",a=new("set"===o.repeated?ir:nr)({name:"",value:[new Pr({name:s,value:a})]})),null!==o.context&&void 0!==o.context)if(o.implicit)if("number"==typeof o.type||ln(o.type)){const e=o.repeated?Ut:It;i.push(new e({name:s,optional:u,idBlock:{tagClass:3,tagNumber:o.context}}))}else{this.cache(o.type);const e=!!o.repeated;let t=e?a:this.get(o.type,!0).schema;t="valueBlock"in t?t.valueBlock.value:t.value,i.push(new Ut({name:e?"":s,optional:u,idBlock:{tagClass:3,tagNumber:o.context},value:t}))}else i.push(new Ut({optional:u,idBlock:{tagClass:3,tagNumber:o.context},value:[a]}));else a.optional=u,i.push(a)}switch(n.type){case Bt.Sequence:return new nr({value:i,name:""});case Bt.Set:return new ir({value:i,name:""});case Bt.Choice:return new Ir({value:i,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=Object.getPrototypeOf(e);return t?this.items.get(t)||this.findParentSchema(t):null}},yn=e=>t=>{let r;pn.has(t)?r=pn.get(t):(r=pn.createDefault(t),pn.set(t,r)),Object.assign(r,e)},bn=e=>(t,r)=>{let n;pn.has(t.constructor)?n=pn.get(t.constructor):(n=pn.createDefault(t.constructor),pn.set(t.constructor,n));const i=Object.assign({},e);if("number"==typeof i.type&&!i.converter){const n=fn(e.type);if(!n)throw new Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);i.converter=n}n.items[r]=i};class vn extends Error{constructor(){super(...arguments),this.schemas=[]}}class gn{static parse(e,t){const r=Ct(e);if(r.result.error)throw new Error(r.result.error);return this.fromASN(r.result,t)}static fromASN(t,r){var n;try{if(ln(r))return(new r).fromASN(t);const i=pn.get(r);pn.cache(r);let o=i.schema;if(t.constructor===Ut&&i.type!==Bt.Choice){o=new Ut({idBlock:{tagClass:3,tagNumber:t.idBlock.tagNumber},value:i.schema.valueBlock.value});for(const e in i.items)delete t[e]}const s=Nr({},t,o);if(!s.verified)throw new vn(`Data does not match to ${r.name} ASN1 schema. ${s.result.error}`);const a=new r;if(hn(r)){if(!("value"in t.valueBlock)||!Array.isArray(t.valueBlock.value))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const e=i.itemType;if("number"==typeof e){const n=fn(e);if(!n)throw new Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);return r.from(t.valueBlock.value,(e=>n.fromASN(e)))}return r.from(t.valueBlock.value,(t=>this.fromASN(t,e)))}for(const t in i.items){const r=s.result[t];if(!r)continue;const o=i.items[t],u=o.type;if("number"==typeof u||ln(u)){const i=null!==(n=o.converter)&&void 0!==n?n:ln(u)?new u:null;if(!i)throw new Error("Converter is empty");if(o.repeated)if(o.implicit){const e=new("sequence"===o.repeated?nr:ir);e.valueBlock=r.valueBlock;const n=Ct(e.toBER(!1));if(-1===n.offset)throw new Error(`Cannot parse the child item. ${n.result.error}`);if(!("value"in n.result.valueBlock)||!Array.isArray(n.result.valueBlock.value))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const s=n.result.valueBlock.value;a[t]=Array.from(s,(e=>i.fromASN(e)))}else a[t]=Array.from(r,(e=>i.fromASN(e)));else{let n=r;if(o.implicit){let t;if(ln(u))t=(new u).toSchema("");else{const r=Ot[u],n=e[r];if(!n)throw new Error(`Cannot get '${r}' class from asn1js module`);t=new n}t.valueBlock=n.valueBlock,n=Ct(t.toBER(!1)).result}a[t]=i.fromASN(n)}}else if(o.repeated){if(!Array.isArray(r))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");a[t]=Array.from(r,(e=>this.fromASN(e,u)))}else a[t]=this.fromASN(r,u)}return a}catch(e){throw e instanceof vn&&e.schemas.push(r.name),e}}}class mn{static serialize(e){return e instanceof Ve?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){if(e&&"object"==typeof e&&ln(e))return e.toASN();if(!e||"object"!=typeof e)throw new TypeError("Parameter 1 should be type of Object.");const t=e.constructor,r=pn.get(t);pn.cache(t);let n,i=[];if(r.itemType){if(!Array.isArray(e))throw new TypeError("Parameter 1 should be type of Array.");if("number"==typeof r.itemType){const n=fn(r.itemType);if(!n)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);i=e.map((e=>n.toASN(e)))}else i=e.map((e=>this.toAsnItem({type:r.itemType},"[]",t,e)))}else for(const n in r.items){const o=r.items[n],s=e[n];if(void 0===s||o.defaultValue===s||"object"==typeof o.defaultValue&&"object"==typeof s&&dn(this.serialize(o.defaultValue),this.serialize(s)))continue;const a=mn.toAsnItem(o,n,t,s);if("number"==typeof o.context)if(o.implicit)if(o.repeated||"number"!=typeof o.type&&!ln(o.type))i.push(new Ut({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:a.valueBlock.value}));else{const e={};e.valueHex=a instanceof Dt?a.valueBeforeDecodeView:a.valueBlock.toBER(),i.push(new It({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},...e}))}else i.push(new Ut({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:[a]}));else o.repeated?i=i.concat(a):i.push(a)}switch(r.type){case Bt.Sequence:n=new nr({value:i});break;case Bt.Set:n=new ir({value:i});break;case Bt.Choice:if(!i[0])throw new Error(`Schema '${t.name}' has wrong data. Choice cannot be empty.`);n=i[0]}return n}static toAsnItem(e,t,r,n){let i;if("number"==typeof e.type){const o=e.converter;if(!o)throw new Error(`Property '${t}' doesn't have converter for type ${Ot[e.type]} in schema '${r.name}'`);if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const t=Array.from(n,(e=>o.toASN(e)));i=new("sequence"===e.repeated?nr:ir)({value:t})}else i=o.toASN(n)}else if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const t=Array.from(n,(e=>this.toASN(e)));i=new("sequence"===e.repeated?nr:ir)({value:t})}else i=this.toASN(n);return i}}class wn extends Array{constructor(e=[]){if("number"==typeof e)super(e);else{super();for(const t of e)this.push(t)}}}class Sn{static serialize(e){return mn.serialize(e)}static parse(e,t){return gn.parse(e,t)}static toString(e){const t=Ct(le.vJ.isBufferSource(e)?le.vJ.toArrayBuffer(e):Sn.serialize(e));if(-1===t.offset)throw new Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}function An(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var _n,Mn,kn,xn=n(6842);class En{static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;const t=parseInt(e.slice(8),16).toString(2).split("").reduce(((e,t)=>e+ +t),0);let r=e.slice(0,8).replace(/(.{2})/g,(e=>`${parseInt(e,16)}.`));return r=r.slice(0,-1),`${r}/${t}`}static toString(e){if(4===e.byteLength||16===e.byteLength){const t=new Uint8Array(e);return xn.fromByteArray(Array.from(t)).toString()}return this.decodeIP(le.ep.ToHex(e))}static fromString(e){const t=xn.parse(e);return new Uint8Array(t.toByteArray()).buffer}}let Bn=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};An([bn({type:Ot.TeletexString})],Bn.prototype,"teletexString",void 0),An([bn({type:Ot.PrintableString})],Bn.prototype,"printableString",void 0),An([bn({type:Ot.UniversalString})],Bn.prototype,"universalString",void 0),An([bn({type:Ot.Utf8String})],Bn.prototype,"utf8String",void 0),An([bn({type:Ot.BmpString})],Bn.prototype,"bmpString",void 0),Bn=An([yn({type:Bt.Choice})],Bn);let On=class extends Bn{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?le.ep.ToHex(this.anyValue):super.toString())}};An([bn({type:Ot.IA5String})],On.prototype,"ia5String",void 0),An([bn({type:Ot.Any})],On.prototype,"anyValue",void 0),On=An([yn({type:Bt.Choice})],On);class jn{constructor(e={}){this.type="",this.value=new On,Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],jn.prototype,"type",void 0),An([bn({type:On})],jn.prototype,"value",void 0);let In=_n=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,_n.prototype)}};In=_n=An([yn({type:Bt.Set,itemType:jn})],In);let Pn=Mn=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Mn.prototype)}};Pn=Mn=An([yn({type:Bt.Sequence,itemType:In})],Pn);let Cn=kn=class extends Pn{constructor(e){super(e),Object.setPrototypeOf(this,kn.prototype)}};Cn=kn=An([yn({type:Bt.Sequence})],Cn);const Nn={fromASN:e=>En.toString(Vr.fromASN(e)),toASN:e=>Vr.toASN(En.fromString(e))};class Un{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],Un.prototype,"typeId",void 0),An([bn({type:Ot.Any,context:0})],Un.prototype,"value",void 0);class Tn{constructor(e={}){this.partyName=new Bn,Object.assign(this,e)}}An([bn({type:Bn,optional:!0,context:0,implicit:!0})],Tn.prototype,"nameAssigner",void 0),An([bn({type:Bn,context:1,implicit:!0})],Tn.prototype,"partyName",void 0);let Rn=class{constructor(e={}){Object.assign(this,e)}};var Dn;An([bn({type:Un,context:0,implicit:!0})],Rn.prototype,"otherName",void 0),An([bn({type:Ot.IA5String,context:1,implicit:!0})],Rn.prototype,"rfc822Name",void 0),An([bn({type:Ot.IA5String,context:2,implicit:!0})],Rn.prototype,"dNSName",void 0),An([bn({type:Ot.Any,context:3,implicit:!0})],Rn.prototype,"x400Address",void 0),An([bn({type:Cn,context:4,implicit:!1})],Rn.prototype,"directoryName",void 0),An([bn({type:Tn,context:5})],Rn.prototype,"ediPartyName",void 0),An([bn({type:Ot.IA5String,context:6,implicit:!0})],Rn.prototype,"uniformResourceIdentifier",void 0),An([bn({type:Ot.OctetString,context:7,implicit:!0,converter:Nn})],Rn.prototype,"iPAddress",void 0),An([bn({type:Ot.ObjectIdentifier,context:8,implicit:!0})],Rn.prototype,"registeredID",void 0),Rn=An([yn({type:Bt.Choice})],Rn);class Kn{constructor(e={}){this.accessMethod="",this.accessLocation=new Rn,Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],Kn.prototype,"accessMethod",void 0),An([bn({type:Rn})],Kn.prototype,"accessLocation",void 0);let Ln=Dn=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Dn.prototype)}};Ln=Dn=An([yn({type:Bt.Sequence,itemType:Kn})],Ln);const zn="1.3.6.1.5.5.7.3",Hn="2.5.29",qn=`${Hn}.35`;class Fn extends Rr{}class Vn{constructor(e={}){e&&Object.assign(this,e)}}An([bn({type:Fn,context:0,optional:!0,implicit:!0})],Vn.prototype,"keyIdentifier",void 0),An([bn({type:Rn,context:1,optional:!0,implicit:!0,repeated:"sequence"})],Vn.prototype,"authorityCertIssuer",void 0),An([bn({type:Ot.Integer,context:2,optional:!0,implicit:!0,converter:zr})],Vn.prototype,"authorityCertSerialNumber",void 0);const $n=`${Hn}.19`;class Jn{constructor(e={}){this.cA=!1,Object.assign(this,e)}}var Wn;An([bn({type:Ot.Boolean,defaultValue:!1})],Jn.prototype,"cA",void 0),An([bn({type:Ot.Integer,optional:!0})],Jn.prototype,"pathLenConstraint",void 0);let Gn=Wn=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Wn.prototype)}};var Zn;Gn=Wn=An([yn({type:Bt.Sequence,itemType:Rn})],Gn);let Yn=Zn=class extends Gn{constructor(e){super(e),Object.setPrototypeOf(this,Zn.prototype)}};var Xn;Yn=Zn=An([yn({type:Bt.Sequence})],Yn);const Qn=`${Hn}.32`;let ei=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};An([bn({type:Ot.IA5String})],ei.prototype,"ia5String",void 0),An([bn({type:Ot.VisibleString})],ei.prototype,"visibleString",void 0),An([bn({type:Ot.BmpString})],ei.prototype,"bmpString",void 0),An([bn({type:Ot.Utf8String})],ei.prototype,"utf8String",void 0),ei=An([yn({type:Bt.Choice})],ei);class ti{constructor(e={}){this.organization=new ei,this.noticeNumbers=[],Object.assign(this,e)}}An([bn({type:ei})],ti.prototype,"organization",void 0),An([bn({type:Ot.Integer,repeated:"sequence"})],ti.prototype,"noticeNumbers",void 0);class ri{constructor(e={}){Object.assign(this,e)}}An([bn({type:ti,optional:!0})],ri.prototype,"noticeRef",void 0),An([bn({type:ei,optional:!0})],ri.prototype,"explicitText",void 0);let ni=class{constructor(e={}){Object.assign(this,e)}};An([bn({type:Ot.IA5String})],ni.prototype,"cPSuri",void 0),An([bn({type:ri})],ni.prototype,"userNotice",void 0),ni=An([yn({type:Bt.Choice})],ni);class ii{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],ii.prototype,"policyQualifierId",void 0),An([bn({type:Ot.Any})],ii.prototype,"qualifier",void 0);class oi{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],oi.prototype,"policyIdentifier",void 0),An([bn({type:ii,repeated:"sequence",optional:!0})],oi.prototype,"policyQualifiers",void 0);let si=Xn=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Xn.prototype)}};si=Xn=An([yn({type:Bt.Sequence,itemType:oi})],si);let ai=class{constructor(e=0){this.value=e}};An([bn({type:Ot.Integer})],ai.prototype,"value",void 0),ai=An([yn({type:Bt.Choice})],ai);let ui=class extends ai{};var ci,fi;ui=An([yn({type:Bt.Choice})],ui),function(e){e[e.unused=1]="unused",e[e.keyCompromise=2]="keyCompromise",e[e.cACompromise=4]="cACompromise",e[e.affiliationChanged=8]="affiliationChanged",e[e.superseded=16]="superseded",e[e.cessationOfOperation=32]="cessationOfOperation",e[e.certificateHold=64]="certificateHold",e[e.privilegeWithdrawn=128]="privilegeWithdrawn",e[e.aACompromise=256]="aACompromise"}(fi||(fi={}));class li extends Tr{toJSON(){const e=[],t=this.toNumber();return t&fi.aACompromise&&e.push("aACompromise"),t&fi.affiliationChanged&&e.push("affiliationChanged"),t&fi.cACompromise&&e.push("cACompromise"),t&fi.certificateHold&&e.push("certificateHold"),t&fi.cessationOfOperation&&e.push("cessationOfOperation"),t&fi.keyCompromise&&e.push("keyCompromise"),t&fi.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&fi.superseded&&e.push("superseded"),t&fi.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let hi=class{constructor(e={}){Object.assign(this,e)}};An([bn({type:Rn,context:0,repeated:"sequence",implicit:!0})],hi.prototype,"fullName",void 0),An([bn({type:In,context:1,implicit:!0})],hi.prototype,"nameRelativeToCRLIssuer",void 0),hi=An([yn({type:Bt.Choice})],hi);class di{constructor(e={}){Object.assign(this,e)}}An([bn({type:hi,context:0,optional:!0})],di.prototype,"distributionPoint",void 0),An([bn({type:li,context:1,optional:!0,implicit:!0})],di.prototype,"reasons",void 0),An([bn({type:Rn,context:2,optional:!0,repeated:"sequence",implicit:!0})],di.prototype,"cRLIssuer",void 0);let pi=ci=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,ci.prototype)}};var yi;pi=ci=An([yn({type:Bt.Sequence,itemType:di})],pi);let bi=yi=class extends pi{constructor(e){super(e),Object.setPrototypeOf(this,yi.prototype)}};bi=yi=An([yn({type:Bt.Sequence,itemType:di})],bi);class vi{constructor(e={}){this.onlyContainsUserCerts=vi.ONLY,this.onlyContainsCACerts=vi.ONLY,this.indirectCRL=vi.ONLY,this.onlyContainsAttributeCerts=vi.ONLY,Object.assign(this,e)}}var gi;vi.ONLY=!1,An([bn({type:hi,context:0,optional:!0})],vi.prototype,"distributionPoint",void 0),An([bn({type:Ot.Boolean,context:1,defaultValue:vi.ONLY,implicit:!0})],vi.prototype,"onlyContainsUserCerts",void 0),An([bn({type:Ot.Boolean,context:2,defaultValue:vi.ONLY,implicit:!0})],vi.prototype,"onlyContainsCACerts",void 0),An([bn({type:li,context:3,optional:!0,implicit:!0})],vi.prototype,"onlySomeReasons",void 0),An([bn({type:Ot.Boolean,context:4,defaultValue:vi.ONLY,implicit:!0})],vi.prototype,"indirectCRL",void 0),An([bn({type:Ot.Boolean,context:5,defaultValue:vi.ONLY,implicit:!0})],vi.prototype,"onlyContainsAttributeCerts",void 0),function(e){e[e.unspecified=0]="unspecified",e[e.keyCompromise=1]="keyCompromise",e[e.cACompromise=2]="cACompromise",e[e.affiliationChanged=3]="affiliationChanged",e[e.superseded=4]="superseded",e[e.cessationOfOperation=5]="cessationOfOperation",e[e.certificateHold=6]="certificateHold",e[e.removeFromCRL=8]="removeFromCRL",e[e.privilegeWithdrawn=9]="privilegeWithdrawn",e[e.aACompromise=10]="aACompromise"}(gi||(gi={}));let mi=class{constructor(e=gi.unspecified){this.reason=gi.unspecified,this.reason=e}toJSON(){return gi[this.reason]}toString(){return this.toJSON()}};var wi;An([bn({type:Ot.Enumerated})],mi.prototype,"reason",void 0),mi=An([yn({type:Bt.Choice})],mi);const Si=`${Hn}.37`;let Ai=wi=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,wi.prototype)}};Ai=wi=An([yn({type:Bt.Sequence,itemType:Ot.ObjectIdentifier})],Ai);const _i=`${zn}.1`,Mi=`${zn}.2`,ki=`${zn}.3`,xi=`${zn}.4`,Ei=`${zn}.8`,Bi=`${zn}.9`;let Oi=class{constructor(e=new ArrayBuffer(0)){this.value=e}};An([bn({type:Ot.Integer,converter:zr})],Oi.prototype,"value",void 0),Oi=An([yn({type:Bt.Choice})],Oi);let ji=class{constructor(e){this.value=new Date,e&&(this.value=e)}};var Ii;An([bn({type:Ot.GeneralizedTime})],ji.prototype,"value",void 0),ji=An([yn({type:Bt.Choice})],ji);let Pi=Ii=class extends Gn{constructor(e){super(e),Object.setPrototypeOf(this,Ii.prototype)}};Pi=Ii=An([yn({type:Bt.Sequence})],Pi);const Ci=`${Hn}.15`;var Ni,Ui;!function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(Ni||(Ni={}));class Ti extends Tr{toJSON(){const e=this.toNumber(),t=[];return e&Ni.cRLSign&&t.push("crlSign"),e&Ni.dataEncipherment&&t.push("dataEncipherment"),e&Ni.decipherOnly&&t.push("decipherOnly"),e&Ni.digitalSignature&&t.push("digitalSignature"),e&Ni.encipherOnly&&t.push("encipherOnly"),e&Ni.keyAgreement&&t.push("keyAgreement"),e&Ni.keyCertSign&&t.push("keyCertSign"),e&Ni.keyEncipherment&&t.push("keyEncipherment"),e&Ni.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class Ri{constructor(e={}){this.base=new Rn,this.minimum=0,Object.assign(this,e)}}An([bn({type:Rn})],Ri.prototype,"base",void 0),An([bn({type:Ot.Integer,context:0,defaultValue:0,implicit:!0})],Ri.prototype,"minimum",void 0),An([bn({type:Ot.Integer,context:1,optional:!0,implicit:!0})],Ri.prototype,"maximum",void 0);let Di=Ui=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Ui.prototype)}};Di=Ui=An([yn({type:Bt.Sequence,itemType:Ri})],Di);class Ki{constructor(e={}){Object.assign(this,e)}}An([bn({type:Di,context:0,optional:!0,implicit:!0})],Ki.prototype,"permittedSubtrees",void 0),An([bn({type:Di,context:1,optional:!0,implicit:!0})],Ki.prototype,"excludedSubtrees",void 0);class Li{constructor(e={}){Object.assign(this,e)}}var zi;An([bn({type:Ot.Integer,context:0,implicit:!0,optional:!0,converter:zr})],Li.prototype,"requireExplicitPolicy",void 0),An([bn({type:Ot.Integer,context:1,implicit:!0,optional:!0,converter:zr})],Li.prototype,"inhibitPolicyMapping",void 0);class Hi{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],Hi.prototype,"issuerDomainPolicy",void 0),An([bn({type:Ot.ObjectIdentifier})],Hi.prototype,"subjectDomainPolicy",void 0);let qi=zi=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,zi.prototype)}};var Fi;qi=zi=An([yn({type:Bt.Sequence,itemType:Hi})],qi);const Vi=`${Hn}.17`;let $i=Fi=class extends Gn{constructor(e){super(e),Object.setPrototypeOf(this,Fi.prototype)}};$i=Fi=An([yn({type:Bt.Sequence})],$i);class Ji{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}var Wi;An([bn({type:Ot.ObjectIdentifier})],Ji.prototype,"type",void 0),An([bn({type:Ot.Any,repeated:"set"})],Ji.prototype,"values",void 0);let Gi=Wi=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Wi.prototype)}};Gi=Wi=An([yn({type:Bt.Sequence,itemType:Ji})],Gi);const Zi=`${Hn}.14`;class Yi extends Fn{}class Xi{constructor(e={}){Object.assign(this,e)}}var Qi,eo;An([bn({type:Ot.GeneralizedTime,context:0,implicit:!0,optional:!0})],Xi.prototype,"notBefore",void 0),An([bn({type:Ot.GeneralizedTime,context:1,implicit:!0,optional:!0})],Xi.prototype,"notAfter",void 0),function(e){e[e.keyUpdateAllowed=1]="keyUpdateAllowed",e[e.newExtensions=2]="newExtensions",e[e.pKIXCertificate=4]="pKIXCertificate"}(Qi||(Qi={}));class to extends Tr{toJSON(){const e=[],t=this.toNumber();return t&Qi.pKIXCertificate&&e.push("pKIXCertificate"),t&Qi.newExtensions&&e.push("newExtensions"),t&Qi.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class ro{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new to,Object.assign(this,e)}}An([bn({type:Ot.GeneralString})],ro.prototype,"entrustVers",void 0),An([bn({type:to})],ro.prototype,"entrustInfoFlags",void 0);let no=eo=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,eo.prototype)}};no=eo=An([yn({type:Bt.Sequence,itemType:Kn})],no);class io{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof io&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&le.Xy(e.parameters,this.parameters)||e.parameters===this.parameters)}}An([bn({type:Ot.ObjectIdentifier})],io.prototype,"algorithm",void 0),An([bn({type:Ot.Any,optional:!0})],io.prototype,"parameters",void 0);class oo{constructor(e={}){this.algorithm=new io,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:io})],oo.prototype,"algorithm",void 0),An([bn({type:Ot.BitString})],oo.prototype,"subjectPublicKey",void 0);let so=class{constructor(e){if(e)if("string"==typeof e||"number"==typeof e||e instanceof Date){const t=new Date(e);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,e)}getTime(){const e=this.utcTime||this.generalTime;if(!e)throw new Error("Cannot get time from CHOICE object");return e}};An([bn({type:Ot.UTCTime})],so.prototype,"utcTime",void 0),An([bn({type:Ot.GeneralizedTime})],so.prototype,"generalTime",void 0),so=An([yn({type:Bt.Choice})],so);class ao{constructor(e){this.notBefore=new so(new Date),this.notAfter=new so(new Date),e&&(this.notBefore=new so(e.notBefore),this.notAfter=new so(e.notAfter))}}var uo;An([bn({type:so})],ao.prototype,"notBefore",void 0),An([bn({type:so})],ao.prototype,"notAfter",void 0);class co{constructor(e={}){this.extnID="",this.critical=co.CRITICAL,this.extnValue=new Rr,Object.assign(this,e)}}co.CRITICAL=!1,An([bn({type:Ot.ObjectIdentifier})],co.prototype,"extnID",void 0),An([bn({type:Ot.Boolean,defaultValue:co.CRITICAL})],co.prototype,"critical",void 0),An([bn({type:Rr})],co.prototype,"extnValue",void 0);let fo=uo=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,uo.prototype)}};var lo;fo=uo=An([yn({type:Bt.Sequence,itemType:co})],fo),function(e){e[e.v1=0]="v1",e[e.v2=1]="v2",e[e.v3=2]="v3"}(lo||(lo={}));class ho{constructor(e={}){this.version=lo.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new io,this.issuer=new Cn,this.validity=new ao,this.subject=new Cn,this.subjectPublicKeyInfo=new oo,Object.assign(this,e)}}An([bn({type:Ot.Integer,context:0,defaultValue:lo.v1})],ho.prototype,"version",void 0),An([bn({type:Ot.Integer,converter:zr})],ho.prototype,"serialNumber",void 0),An([bn({type:io})],ho.prototype,"signature",void 0),An([bn({type:Cn})],ho.prototype,"issuer",void 0),An([bn({type:ao})],ho.prototype,"validity",void 0),An([bn({type:Cn})],ho.prototype,"subject",void 0),An([bn({type:oo})],ho.prototype,"subjectPublicKeyInfo",void 0),An([bn({type:Ot.BitString,context:1,implicit:!0,optional:!0})],ho.prototype,"issuerUniqueID",void 0),An([bn({type:Ot.BitString,context:2,implicit:!0,optional:!0})],ho.prototype,"subjectUniqueID",void 0),An([bn({type:fo,context:3,optional:!0})],ho.prototype,"extensions",void 0);class po{constructor(e={}){this.tbsCertificate=new ho,this.signatureAlgorithm=new io,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:ho})],po.prototype,"tbsCertificate",void 0),An([bn({type:io})],po.prototype,"signatureAlgorithm",void 0),An([bn({type:Ot.BitString})],po.prototype,"signatureValue",void 0);class yo{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new so,Object.assign(this,e)}}An([bn({type:Ot.Integer,converter:zr})],yo.prototype,"userCertificate",void 0),An([bn({type:so})],yo.prototype,"revocationDate",void 0),An([bn({type:co,optional:!0,repeated:"sequence"})],yo.prototype,"crlEntryExtensions",void 0);class bo{constructor(e={}){this.signature=new io,this.issuer=new Cn,this.thisUpdate=new so,Object.assign(this,e)}}An([bn({type:Ot.Integer,optional:!0})],bo.prototype,"version",void 0),An([bn({type:io})],bo.prototype,"signature",void 0),An([bn({type:Cn})],bo.prototype,"issuer",void 0),An([bn({type:so})],bo.prototype,"thisUpdate",void 0),An([bn({type:so,optional:!0})],bo.prototype,"nextUpdate",void 0),An([bn({type:yo,repeated:"sequence",optional:!0})],bo.prototype,"revokedCertificates",void 0),An([bn({type:co,optional:!0,context:0,repeated:"sequence"})],bo.prototype,"crlExtensions",void 0);class vo{constructor(e={}){this.tbsCertList=new bo,this.signatureAlgorithm=new io,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:bo})],vo.prototype,"tbsCertList",void 0),An([bn({type:io})],vo.prototype,"signatureAlgorithm",void 0),An([bn({type:Ot.BitString})],vo.prototype,"signature",void 0);class go{constructor(e={}){this.issuer=new Cn,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Cn})],go.prototype,"issuer",void 0),An([bn({type:Ot.Integer,converter:zr})],go.prototype,"serialNumber",void 0);let mo=class{constructor(e={}){Object.assign(this,e)}};var wo;An([bn({type:Yi,context:0,implicit:!0})],mo.prototype,"subjectKeyIdentifier",void 0),An([bn({type:go})],mo.prototype,"issuerAndSerialNumber",void 0),mo=An([yn({type:Bt.Choice})],mo),function(e){e[e.v0=0]="v0",e[e.v1=1]="v1",e[e.v2=2]="v2",e[e.v3=3]="v3",e[e.v4=4]="v4",e[e.v5=5]="v5"}(wo||(wo={}));let So=class extends io{};So=An([yn({type:Bt.Sequence})],So);let Ao=class extends io{};Ao=An([yn({type:Bt.Sequence})],Ao);let _o=class extends io{};_o=An([yn({type:Bt.Sequence})],_o);let Mo=class extends io{};Mo=An([yn({type:Bt.Sequence})],Mo);let ko=class extends io{};ko=An([yn({type:Bt.Sequence})],ko);let xo=class extends io{};xo=An([yn({type:Bt.Sequence})],xo);class Eo{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}var Bo;An([bn({type:Ot.ObjectIdentifier})],Eo.prototype,"attrType",void 0),An([bn({type:Ot.Any,repeated:"set"})],Eo.prototype,"attrValues",void 0);class Oo{constructor(e={}){this.version=wo.v0,this.sid=new mo,this.digestAlgorithm=new So,this.signatureAlgorithm=new Ao,this.signature=new Rr,Object.assign(this,e)}}An([bn({type:Ot.Integer})],Oo.prototype,"version",void 0),An([bn({type:mo})],Oo.prototype,"sid",void 0),An([bn({type:So})],Oo.prototype,"digestAlgorithm",void 0),An([bn({type:Eo,repeated:"set",context:0,implicit:!0,optional:!0})],Oo.prototype,"signedAttrs",void 0),An([bn({type:Ao})],Oo.prototype,"signatureAlgorithm",void 0),An([bn({type:Rr})],Oo.prototype,"signature",void 0),An([bn({type:Eo,repeated:"set",context:1,implicit:!0,optional:!0})],Oo.prototype,"unsignedAttrs",void 0);let jo=Bo=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Bo.prototype)}};jo=Bo=An([yn({type:Bt.Set,itemType:Oo})],jo);let Io=class extends so{};Io=An([yn({type:Bt.Choice})],Io);let Po=class extends Oo{};Po=An([yn({type:Bt.Sequence})],Po);class Co{constructor(e={}){this.acIssuer=new Rn,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}var No;An([bn({type:Rn})],Co.prototype,"acIssuer",void 0),An([bn({type:Ot.Integer})],Co.prototype,"acSerial",void 0),An([bn({type:Ji,repeated:"sequence"})],Co.prototype,"attrs",void 0);let Uo=No=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,No.prototype)}};Uo=No=An([yn({type:Bt.Sequence,itemType:Ot.ObjectIdentifier})],Uo);class To{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}An([bn({type:Ot.Integer,optional:!0})],To.prototype,"pathLenConstraint",void 0),An([bn({type:Uo,implicit:!0,context:0,optional:!0})],To.prototype,"permittedAttrs",void 0),An([bn({type:Uo,implicit:!0,context:1,optional:!0})],To.prototype,"excludedAttrs",void 0),An([bn({type:Ot.Boolean,defaultValue:!0})],To.prototype,"permitUnSpecified",void 0);class Ro{constructor(e={}){this.issuer=new Gn,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}var Do;An([bn({type:Gn})],Ro.prototype,"issuer",void 0),An([bn({type:Ot.Integer,converter:zr})],Ro.prototype,"serial",void 0),An([bn({type:Ot.BitString,optional:!0})],Ro.prototype,"issuerUID",void 0),function(e){e[e.publicKey=0]="publicKey",e[e.publicKeyCert=1]="publicKeyCert",e[e.otherObjectTypes=2]="otherObjectTypes"}(Do||(Do={}));class Ko{constructor(e={}){this.digestedObjectType=Do.publicKey,this.digestAlgorithm=new io,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.Enumerated})],Ko.prototype,"digestedObjectType",void 0),An([bn({type:Ot.ObjectIdentifier,optional:!0})],Ko.prototype,"otherObjectTypeID",void 0),An([bn({type:io})],Ko.prototype,"digestAlgorithm",void 0),An([bn({type:Ot.BitString})],Ko.prototype,"objectDigest",void 0);class Lo{constructor(e={}){Object.assign(this,e)}}An([bn({type:Gn,optional:!0})],Lo.prototype,"issuerName",void 0),An([bn({type:Ro,context:0,implicit:!0,optional:!0})],Lo.prototype,"baseCertificateID",void 0),An([bn({type:Ko,context:1,implicit:!0,optional:!0})],Lo.prototype,"objectDigestInfo",void 0);let zo=class{constructor(e={}){Object.assign(this,e)}};An([bn({type:Rn,repeated:"sequence"})],zo.prototype,"v1Form",void 0),An([bn({type:Lo,context:0,implicit:!0})],zo.prototype,"v2Form",void 0),zo=An([yn({type:Bt.Choice})],zo);class Ho{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}An([bn({type:Ot.GeneralizedTime})],Ho.prototype,"notBeforeTime",void 0),An([bn({type:Ot.GeneralizedTime})],Ho.prototype,"notAfterTime",void 0);class qo{constructor(e={}){Object.assign(this,e)}}var Fo,Vo,$o;An([bn({type:Ro,implicit:!0,context:0,optional:!0})],qo.prototype,"baseCertificateID",void 0),An([bn({type:Gn,implicit:!0,context:1,optional:!0})],qo.prototype,"entityName",void 0),An([bn({type:Ko,implicit:!0,context:2,optional:!0})],qo.prototype,"objectDigestInfo",void 0),function(e){e[e.v2=1]="v2"}(Fo||(Fo={}));class Jo{constructor(e={}){this.version=Fo.v2,this.holder=new qo,this.issuer=new zo,this.signature=new io,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new Ho,this.attributes=[],Object.assign(this,e)}}An([bn({type:Ot.Integer})],Jo.prototype,"version",void 0),An([bn({type:qo})],Jo.prototype,"holder",void 0),An([bn({type:zo})],Jo.prototype,"issuer",void 0),An([bn({type:io})],Jo.prototype,"signature",void 0),An([bn({type:Ot.Integer,converter:zr})],Jo.prototype,"serialNumber",void 0),An([bn({type:Ho})],Jo.prototype,"attrCertValidityPeriod",void 0),An([bn({type:Ji,repeated:"sequence"})],Jo.prototype,"attributes",void 0),An([bn({type:Ot.BitString,optional:!0})],Jo.prototype,"issuerUniqueID",void 0),An([bn({type:fo,optional:!0})],Jo.prototype,"extensions",void 0);class Wo{constructor(e={}){this.acinfo=new Jo,this.signatureAlgorithm=new io,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Jo})],Wo.prototype,"acinfo",void 0),An([bn({type:io})],Wo.prototype,"signatureAlgorithm",void 0),An([bn({type:Ot.BitString})],Wo.prototype,"signatureValue",void 0),function(e){e[e.unmarked=1]="unmarked",e[e.unclassified=2]="unclassified",e[e.restricted=4]="restricted",e[e.confidential=8]="confidential",e[e.secret=16]="secret",e[e.topSecret=32]="topSecret"}(Vo||(Vo={}));class Go extends Tr{}class Zo{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier,implicit:!0,context:0})],Zo.prototype,"type",void 0),An([bn({type:Ot.Any,implicit:!0,context:1})],Zo.prototype,"value",void 0);class Yo{constructor(e={}){this.policyId="",this.classList=new Go(Vo.unclassified),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],Yo.prototype,"policyId",void 0),An([bn({type:Go,defaultValue:new Go(Vo.unclassified)})],Yo.prototype,"classList",void 0),An([bn({type:Zo,repeated:"set"})],Yo.prototype,"securityCategories",void 0);class Xo{constructor(e={}){Object.assign(this,e)}}An([bn({type:Rr})],Xo.prototype,"cotets",void 0),An([bn({type:Ot.ObjectIdentifier})],Xo.prototype,"oid",void 0),An([bn({type:Ot.Utf8String})],Xo.prototype,"string",void 0);class Qo{constructor(e={}){this.values=[],Object.assign(this,e)}}An([bn({type:Gn,implicit:!0,context:0,optional:!0})],Qo.prototype,"policyAuthority",void 0),An([bn({type:Xo,repeated:"sequence"})],Qo.prototype,"values",void 0);class es{constructor(e={}){this.targetCertificate=new Ro,Object.assign(this,e)}}An([bn({type:Ro})],es.prototype,"targetCertificate",void 0),An([bn({type:Rn,optional:!0})],es.prototype,"targetName",void 0),An([bn({type:Ko,optional:!0})],es.prototype,"certDigestInfo",void 0);let ts=class{constructor(e={}){Object.assign(this,e)}};An([bn({type:Rn,context:0,implicit:!0})],ts.prototype,"targetName",void 0),An([bn({type:Rn,context:1,implicit:!0})],ts.prototype,"targetGroup",void 0),An([bn({type:es,context:2,implicit:!0})],ts.prototype,"targetCert",void 0),ts=An([yn({type:Bt.Choice})],ts);let rs=$o=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,$o.prototype)}};var ns;rs=$o=An([yn({type:Bt.Sequence,itemType:ts})],rs);let is=ns=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,ns.prototype)}};is=ns=An([yn({type:Bt.Sequence,itemType:rs})],is);class os{constructor(e={}){Object.assign(this,e)}}An([bn({type:Gn,implicit:!0,context:0,optional:!0})],os.prototype,"roleAuthority",void 0),An([bn({type:Rn,implicit:!0,context:1})],os.prototype,"roleName",void 0);class ss{constructor(e={}){this.service=new Rn,this.ident=new Rn,Object.assign(this,e)}}var as;An([bn({type:Rn})],ss.prototype,"service",void 0),An([bn({type:Rn})],ss.prototype,"ident",void 0),An([bn({type:Rr,optional:!0})],ss.prototype,"authInfo",void 0);class us{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],us.prototype,"otherCertFormat",void 0),An([bn({type:Ot.Any})],us.prototype,"otherCert",void 0);let cs=class{constructor(e={}){Object.assign(this,e)}};An([bn({type:po})],cs.prototype,"certificate",void 0),An([bn({type:Wo,context:2,implicit:!0})],cs.prototype,"v2AttrCert",void 0),An([bn({type:us,context:3,implicit:!0})],cs.prototype,"other",void 0),cs=An([yn({type:Bt.Choice})],cs);let fs=as=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,as.prototype)}};fs=as=An([yn({type:Bt.Set,itemType:cs})],fs);class ls{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],ls.prototype,"contentType",void 0),An([bn({type:Ot.Any,context:0})],ls.prototype,"content",void 0);let hs=class{constructor(e={}){Object.assign(this,e)}};An([bn({type:Rr})],hs.prototype,"single",void 0),An([bn({type:Ot.Any})],hs.prototype,"any",void 0),hs=An([yn({type:Bt.Choice})],hs);class ds{constructor(e={}){this.eContentType="",Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],ds.prototype,"eContentType",void 0),An([bn({type:hs,context:0,optional:!0})],ds.prototype,"eContent",void 0);let ps=class{constructor(e={}){Object.assign(this,e)}};An([bn({type:Rr,context:0,implicit:!0,optional:!0})],ps.prototype,"value",void 0),An([bn({type:Rr,converter:$r,context:0,implicit:!0,optional:!0,repeated:"sequence"})],ps.prototype,"constructedValue",void 0),ps=An([yn({type:Bt.Choice})],ps);class ys{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new Mo,Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],ys.prototype,"contentType",void 0),An([bn({type:Mo})],ys.prototype,"contentEncryptionAlgorithm",void 0),An([bn({type:ps,optional:!0})],ys.prototype,"encryptedContent",void 0);class bs{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}}var vs;An([bn({type:Ot.ObjectIdentifier})],bs.prototype,"keyAttrId",void 0),An([bn({type:Ot.Any,optional:!0})],bs.prototype,"keyAttr",void 0);class gs{constructor(e={}){this.subjectKeyIdentifier=new Yi,Object.assign(this,e)}}An([bn({type:Yi})],gs.prototype,"subjectKeyIdentifier",void 0),An([bn({type:Ot.GeneralizedTime,optional:!0})],gs.prototype,"date",void 0),An([bn({type:bs,optional:!0})],gs.prototype,"other",void 0);let ms=class{constructor(e={}){Object.assign(this,e)}};An([bn({type:gs,context:0,implicit:!0,optional:!0})],ms.prototype,"rKeyId",void 0),An([bn({type:go,optional:!0})],ms.prototype,"issuerAndSerialNumber",void 0),ms=An([yn({type:Bt.Choice})],ms);class ws{constructor(e={}){this.rid=new ms,this.encryptedKey=new Rr,Object.assign(this,e)}}An([bn({type:ms})],ws.prototype,"rid",void 0),An([bn({type:Rr})],ws.prototype,"encryptedKey",void 0);let Ss=vs=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,vs.prototype)}};Ss=vs=An([yn({type:Bt.Sequence,itemType:ws})],Ss);class As{constructor(e={}){this.algorithm=new io,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:io})],As.prototype,"algorithm",void 0),An([bn({type:Ot.BitString})],As.prototype,"publicKey",void 0);let _s=class{constructor(e={}){Object.assign(this,e)}};An([bn({type:Yi,context:0,implicit:!0,optional:!0})],_s.prototype,"subjectKeyIdentifier",void 0),An([bn({type:As,context:1,implicit:!0,optional:!0})],_s.prototype,"originatorKey",void 0),An([bn({type:go,optional:!0})],_s.prototype,"issuerAndSerialNumber",void 0),_s=An([yn({type:Bt.Choice})],_s);class Ms{constructor(e={}){this.version=wo.v3,this.originator=new _s,this.keyEncryptionAlgorithm=new _o,this.recipientEncryptedKeys=new Ss,Object.assign(this,e)}}An([bn({type:Ot.Integer})],Ms.prototype,"version",void 0),An([bn({type:_s,context:0})],Ms.prototype,"originator",void 0),An([bn({type:Rr,context:1,optional:!0})],Ms.prototype,"ukm",void 0),An([bn({type:_o})],Ms.prototype,"keyEncryptionAlgorithm",void 0),An([bn({type:Ss})],Ms.prototype,"recipientEncryptedKeys",void 0);let ks=class{constructor(e={}){Object.assign(this,e)}};An([bn({type:Yi,context:0,implicit:!0})],ks.prototype,"subjectKeyIdentifier",void 0),An([bn({type:go})],ks.prototype,"issuerAndSerialNumber",void 0),ks=An([yn({type:Bt.Choice})],ks);class xs{constructor(e={}){this.version=wo.v0,this.rid=new ks,this.keyEncryptionAlgorithm=new _o,this.encryptedKey=new Rr,Object.assign(this,e)}}An([bn({type:Ot.Integer})],xs.prototype,"version",void 0),An([bn({type:ks})],xs.prototype,"rid",void 0),An([bn({type:_o})],xs.prototype,"keyEncryptionAlgorithm",void 0),An([bn({type:Rr})],xs.prototype,"encryptedKey",void 0);class Es{constructor(e={}){this.keyIdentifier=new Rr,Object.assign(this,e)}}An([bn({type:Rr})],Es.prototype,"keyIdentifier",void 0),An([bn({type:Ot.GeneralizedTime,optional:!0})],Es.prototype,"date",void 0),An([bn({type:bs,optional:!0})],Es.prototype,"other",void 0);class Bs{constructor(e={}){this.version=wo.v4,this.kekid=new Es,this.keyEncryptionAlgorithm=new _o,this.encryptedKey=new Rr,Object.assign(this,e)}}An([bn({type:Ot.Integer})],Bs.prototype,"version",void 0),An([bn({type:Es})],Bs.prototype,"kekid",void 0),An([bn({type:_o})],Bs.prototype,"keyEncryptionAlgorithm",void 0),An([bn({type:Rr})],Bs.prototype,"encryptedKey",void 0);class Os{constructor(e={}){this.version=wo.v0,this.keyEncryptionAlgorithm=new _o,this.encryptedKey=new Rr,Object.assign(this,e)}}An([bn({type:Ot.Integer})],Os.prototype,"version",void 0),An([bn({type:xo,context:0,optional:!0})],Os.prototype,"keyDerivationAlgorithm",void 0),An([bn({type:_o})],Os.prototype,"keyEncryptionAlgorithm",void 0),An([bn({type:Rr})],Os.prototype,"encryptedKey",void 0);class js{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],js.prototype,"oriType",void 0),An([bn({type:Ot.Any})],js.prototype,"oriValue",void 0);let Is=class{constructor(e={}){Object.assign(this,e)}};var Ps;An([bn({type:xs,optional:!0})],Is.prototype,"ktri",void 0),An([bn({type:Ms,context:1,implicit:!0,optional:!0})],Is.prototype,"kari",void 0),An([bn({type:Bs,context:2,implicit:!0,optional:!0})],Is.prototype,"kekri",void 0),An([bn({type:Os,context:3,implicit:!0,optional:!0})],Is.prototype,"pwri",void 0),An([bn({type:js,context:4,implicit:!0,optional:!0})],Is.prototype,"ori",void 0),Is=An([yn({type:Bt.Choice})],Is);let Cs=Ps=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Ps.prototype)}};var Ns;Cs=Ps=An([yn({type:Bt.Set,itemType:Is})],Cs);class Us{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],Us.prototype,"otherRevInfoFormat",void 0),An([bn({type:Ot.Any})],Us.prototype,"otherRevInfo",void 0);let Ts=class{constructor(e={}){this.other=new Us,Object.assign(this,e)}};An([bn({type:Us,context:1,implicit:!0})],Ts.prototype,"other",void 0),Ts=An([yn({type:Bt.Choice})],Ts);let Rs=Ns=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Ns.prototype)}};Rs=Ns=An([yn({type:Bt.Set,itemType:Ts})],Rs);class Ds{constructor(e={}){Object.assign(this,e)}}var Ks;An([bn({type:fs,context:0,implicit:!0,optional:!0})],Ds.prototype,"certs",void 0),An([bn({type:Rs,context:1,implicit:!0,optional:!0})],Ds.prototype,"crls",void 0);let Ls=Ks=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Ks.prototype)}};Ls=Ks=An([yn({type:Bt.Set,itemType:Eo})],Ls);class zs{constructor(e={}){this.version=wo.v0,this.recipientInfos=new Cs,this.encryptedContentInfo=new ys,Object.assign(this,e)}}An([bn({type:Ot.Integer})],zs.prototype,"version",void 0),An([bn({type:Ds,context:0,implicit:!0,optional:!0})],zs.prototype,"originatorInfo",void 0),An([bn({type:Cs})],zs.prototype,"recipientInfos",void 0),An([bn({type:ys})],zs.prototype,"encryptedContentInfo",void 0),An([bn({type:Ls,context:1,implicit:!0,optional:!0})],zs.prototype,"unprotectedAttrs",void 0);const Hs="1.2.840.113549.1.7.2";var qs;let Fs=qs=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,qs.prototype)}};Fs=qs=An([yn({type:Bt.Set,itemType:So})],Fs);class Vs{constructor(e={}){this.version=wo.v0,this.digestAlgorithms=new Fs,this.encapContentInfo=new ds,this.signerInfos=new jo,Object.assign(this,e)}}An([bn({type:Ot.Integer})],Vs.prototype,"version",void 0),An([bn({type:Fs})],Vs.prototype,"digestAlgorithms",void 0),An([bn({type:ds})],Vs.prototype,"encapContentInfo",void 0),An([bn({type:fs,context:0,implicit:!0,optional:!0})],Vs.prototype,"certificates",void 0),An([bn({type:Ts,context:1,implicit:!0,optional:!0})],Vs.prototype,"crls",void 0),An([bn({type:jo})],Vs.prototype,"signerInfos",void 0);const $s="1.2.840.10045.2.1",Js="1.2.840.10045.4.1",Ws="1.2.840.10045.4.3.1",Gs="1.2.840.10045.4.3.2",Zs="1.2.840.10045.4.3.3",Ys="1.2.840.10045.4.3.4",Xs="1.2.840.10045.3.1.7",Qs="1.3.132.0.34",ea="1.3.132.0.35";function ta(e){return new io({algorithm:e})}const ra=ta(Js),na=(ta(Ws),ta(Gs)),ia=ta(Zs),oa=ta(Ys);let sa=class{constructor(e={}){Object.assign(this,e)}};An([bn({type:Ot.ObjectIdentifier})],sa.prototype,"namedCurve",void 0),sa=An([yn({type:Bt.Choice})],sa);class aa{constructor(e={}){this.version=1,this.privateKey=new Rr,Object.assign(this,e)}}An([bn({type:Ot.Integer})],aa.prototype,"version",void 0),An([bn({type:Rr})],aa.prototype,"privateKey",void 0),An([bn({type:sa,context:0,optional:!0})],aa.prototype,"parameters",void 0),An([bn({type:Ot.BitString,context:1,optional:!0})],aa.prototype,"publicKey",void 0);class ua{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.Integer,converter:zr})],ua.prototype,"r",void 0),An([bn({type:Ot.Integer,converter:zr})],ua.prototype,"s",void 0);const ca="1.2.840.113549.1.1",fa=`${ca}.1`,la=`${ca}.7`,ha=`${ca}.9`,da=`${ca}.10`,pa=`${ca}.2`,ya=`${ca}.4`,ba=`${ca}.5`,va=`${ca}.14`,ga=`${ca}.11`,ma=`${ca}.12`,wa=`${ca}.13`,Sa=`${ca}.15`,Aa=`${ca}.16`,_a="1.3.14.3.2.26",Ma="2.16.840.1.101.3.4.2.4",ka="2.16.840.1.101.3.4.2.1",xa="2.16.840.1.101.3.4.2.2",Ea="2.16.840.1.101.3.4.2.3",Ba=`${ca}.8`;function Oa(e){return new io({algorithm:e,parameters:null})}Oa("1.2.840.113549.2.2"),Oa("1.2.840.113549.2.5");const ja=Oa(_a),Ia=(Oa(Ma),Oa(ka),Oa(xa),Oa(Ea),Oa("2.16.840.1.101.3.4.2.5"),Oa("2.16.840.1.101.3.4.2.6"),new io({algorithm:Ba,parameters:Sn.serialize(ja)})),Pa=new io({algorithm:ha,parameters:Sn.serialize(Vr.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});Oa(fa),Oa(pa),Oa(ya),Oa(ba),Oa(Sa),Oa(Aa),Oa(ma),Oa(wa),Oa(Sa),Oa(Aa);class Ca{constructor(e={}){this.hashAlgorithm=new io(ja),this.maskGenAlgorithm=new io({algorithm:Ba,parameters:Sn.serialize(ja)}),this.pSourceAlgorithm=new io(Pa),Object.assign(this,e)}}An([bn({type:io,context:0,defaultValue:ja})],Ca.prototype,"hashAlgorithm",void 0),An([bn({type:io,context:1,defaultValue:Ia})],Ca.prototype,"maskGenAlgorithm",void 0),An([bn({type:io,context:2,defaultValue:Pa})],Ca.prototype,"pSourceAlgorithm",void 0),new io({algorithm:la,parameters:Sn.serialize(new Ca)});class Na{constructor(e={}){this.hashAlgorithm=new io(ja),this.maskGenAlgorithm=new io({algorithm:Ba,parameters:Sn.serialize(ja)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}An([bn({type:io,context:0,defaultValue:ja})],Na.prototype,"hashAlgorithm",void 0),An([bn({type:io,context:1,defaultValue:Ia})],Na.prototype,"maskGenAlgorithm",void 0),An([bn({type:Ot.Integer,context:2,defaultValue:20})],Na.prototype,"saltLength",void 0),An([bn({type:Ot.Integer,context:3,defaultValue:1})],Na.prototype,"trailerField",void 0),new io({algorithm:da,parameters:Sn.serialize(new Na)});class Ua{constructor(e={}){this.digestAlgorithm=new io,this.digest=new Rr,Object.assign(this,e)}}var Ta;An([bn({type:io})],Ua.prototype,"digestAlgorithm",void 0),An([bn({type:Rr})],Ua.prototype,"digest",void 0);class Ra{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.Integer,converter:zr})],Ra.prototype,"prime",void 0),An([bn({type:Ot.Integer,converter:zr})],Ra.prototype,"exponent",void 0),An([bn({type:Ot.Integer,converter:zr})],Ra.prototype,"coefficient",void 0);let Da=Ta=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Ta.prototype)}};Da=Ta=An([yn({type:Bt.Sequence,itemType:Ra})],Da);class Ka{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.Integer})],Ka.prototype,"version",void 0),An([bn({type:Ot.Integer,converter:zr})],Ka.prototype,"modulus",void 0),An([bn({type:Ot.Integer,converter:zr})],Ka.prototype,"publicExponent",void 0),An([bn({type:Ot.Integer,converter:zr})],Ka.prototype,"privateExponent",void 0),An([bn({type:Ot.Integer,converter:zr})],Ka.prototype,"prime1",void 0),An([bn({type:Ot.Integer,converter:zr})],Ka.prototype,"prime2",void 0),An([bn({type:Ot.Integer,converter:zr})],Ka.prototype,"exponent1",void 0),An([bn({type:Ot.Integer,converter:zr})],Ka.prototype,"exponent2",void 0),An([bn({type:Ot.Integer,converter:zr})],Ka.prototype,"coefficient",void 0),An([bn({type:Da,optional:!0})],Ka.prototype,"otherPrimeInfos",void 0);class La{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}var za;An([bn({type:Ot.Integer,converter:zr})],La.prototype,"modulus",void 0),An([bn({type:Ot.Integer,converter:zr})],La.prototype,"publicExponent",void 0),function(e){e[e.Transient=0]="Transient",e[e.Singleton=1]="Singleton",e[e.ResolutionScoped=2]="ResolutionScoped",e[e.ContainerScoped=3]="ContainerScoped"}(za||(za={}));const Ha=za;var qa=function(e,t){return qa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},qa(e,t)};function Fa(e,t){function r(){this.constructor=e}qa(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function Va(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function $a(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function Ja(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat($a(arguments[t]));return e}function Wa(e){return!!e.useClass}function Ga(e){return!!e.useFactory}var Za=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,r=this,n=!1;return new Proxy({},this.createHandler((function(){return n||(t=e(r.wrap()),n=!0),t})))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach((function(r){t[r]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t[0]=e(),Reflect[r].apply(void 0,Ja(t))}})),t},e}();function Ya(e){return"string"==typeof e||"symbol"==typeof e}function Xa(e){return"object"==typeof e&&"token"in e&&"transform"in e}function Qa(e){return!!e.useToken}function eu(e){return null!=e.useValue}const tu=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),ru=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fa(t,e),t}(tu),nu=function(){this.scopedResolutions=new Map};var iu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fa(t,e),t}(tu),ou=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fa(t,e),t}(tu);const su=function(){this.preResolution=new iu,this.postResolution=new ou};var au=new Map,uu=function(){function e(e){this.parent=e,this._registry=new ru,this.interceptors=new su,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,r){var n;if(void 0===r&&(r={lifecycle:Ha.Transient}),this.ensureNotDisposed(),n=function(e){return Wa(e)||eu(e)||Qa(e)||Ga(e)}(t)?t:{useClass:t},Qa(n))for(var i=[e],o=n;null!=o;){var s=o.useToken;if(i.includes(s))throw new Error("Token registration cycle detected! "+Ja(i,[s]).join(" -> "));i.push(s);var a=this._registry.get(s);o=a&&Qa(a.provider)?a.provider:null}if((r.lifecycle===Ha.Singleton||r.lifecycle==Ha.ContainerScoped||r.lifecycle==Ha.ResolutionScoped)&&(eu(n)||Ga(n)))throw new Error('Cannot use lifecycle "'+Ha[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:n,options:r}),this},e.prototype.registerType=function(e,t){return this.ensureNotDisposed(),Ya(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),Ya(e)){if(Ya(t))return this.register(e,{useToken:t},{lifecycle:Ha.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:Ha.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!Ya(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:Ha.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new nu),this.ensureNotDisposed();var r=this.getRegistration(e);if(!r&&Ya(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),r){var n=this.resolveRegistration(r,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if(function(e){return"function"==typeof e||e instanceof Za}(e))return n=this.construct(e,t),this.executePostResolutionInterceptor(e,n,"Single"),n;throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,n;if(this.interceptors.preResolution.has(e)){var i=[];try{for(var o=Va(this.interceptors.preResolution.getAll(e)),s=o.next();!s.done;s=o.next()){var a=s.value;"Once"!=a.options.frequency&&i.push(a),a.callback(e,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,i)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var n,i;if(this.interceptors.postResolution.has(e)){var o=[];try{for(var s=Va(this.interceptors.postResolution.getAll(e)),a=s.next();!a.done;a=s.next()){var u=a.value;"Once"!=u.options.frequency&&o.push(u),u.callback(e,t,r)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,o)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===Ha.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,n=e.options.lifecycle===Ha.Singleton,i=e.options.lifecycle===Ha.ContainerScoped,o=n||i;return r=eu(e.provider)?e.provider.useValue:Qa(e.provider)?o?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):Wa(e.provider)?o?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):Ga(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===Ha.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t){var r=this;void 0===t&&(t=new nu),this.ensureNotDisposed();var n=this.getAllRegistrations(e);if(!n&&Ya(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),n){var i=n.map((function(e){return r.resolveRegistration(e,t)}));return this.executePostResolutionInterceptor(e,i,"All"),i}var o=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,o,"All"),o},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var r=Va(this._registry.entries()),n=r.next();!n.done;n=r.next()){var i=$a(n.value,2),o=i[0],s=i[1];this._registry.setAll(o,s.filter((function(e){return!eu(e.provider)})).map((function(e){return e.instance=void 0,e})))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,r;this.ensureNotDisposed();var n=new e(this);try{for(var i=Va(this._registry.entries()),o=i.next();!o.done;o=i.next()){var s=$a(o.value,2),a=s[0],u=s[1];u.some((function(e){return e.options.lifecycle===Ha.ContainerScoped}))&&n._registry.setAll(a,u.map((function(e){return e.options.lifecycle===Ha.ContainerScoped?{provider:e.provider,options:e.options}:e})))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.dispose=function(){return e=this,t=void 0,n=function(){var e;return function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach((function(t){var r=t.dispose();r&&e.push(r)})),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))},new((r=void 0)||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}));var e,t,r,n},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof Za)return e.createProxy((function(e){return r.resolve(e,t)}));var n,i=function(){var n=au.get(e);if(!n||0===n.length){if(0===e.length)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var i=n.map(r.resolveParams(t,e));return new(e.bind.apply(e,Ja([void 0],i)))}();return"function"!=typeof(n=i).dispose||n.dispose.length>0||this.disposables.add(i),i},e.prototype.resolveParams=function(e,t){var r=this;return function(n,i){var o,s,a,u;try{return"object"==typeof(u=n)&&"token"in u&&"multiple"in u?Xa(n)?n.multiple?(o=r.resolve(n.transform)).transform.apply(o,Ja([r.resolveAll(n.token)],n.transformArgs)):(s=r.resolve(n.transform)).transform.apply(s,Ja([r.resolve(n.token,e)],n.transformArgs)):n.multiple?r.resolveAll(n.token):r.resolve(n.token,e):Xa(n)?(a=r.resolve(n.transform,e)).transform.apply(a,Ja([r.resolve(n.token,e)],n.transformArgs)):r.resolve(n,e)}catch(e){throw new Error(function(e,t,r){var n,i,o,s,a=$a(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1];return n="Cannot inject the dependency "+(s=t,(null===(o=void 0===a?null:a)?"at position #"+s:'"'+o.split(",")[s].trim()+'" at position #'+s)+' of "')+e.name+'" constructor. Reason:',void 0===i&&(i="    "),Ja([n],r.message.split("\n").map((function(e){return i+e}))).join("\n")}(t,i,e))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},e}(),cu=new uu;const fu=function(){return function(e){au.set(e,function(e){var t=Reflect.getMetadata("design:paramtypes",e)||[],r=Reflect.getOwnMetadata("injectionTokens",e)||{};return Object.keys(r).forEach((function(e){t[+e]=r[e]})),t}(e))}};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");var lu;class hu{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}An([bn({type:Ot.ObjectIdentifier})],hu.prototype,"attrId",void 0),An([bn({type:Ot.Any,repeated:"set"})],hu.prototype,"attrValues",void 0);let du=lu=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,lu.prototype)}};var pu;du=lu=An([yn({type:Bt.Sequence,itemType:hu})],du);let yu=pu=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,pu.prototype)}};yu=pu=An([yn({type:Bt.Sequence,itemType:ls})],yu);class bu{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],bu.prototype,"certId",void 0),An([bn({type:Ot.Any,context:0})],bu.prototype,"certValue",void 0);class vu{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],vu.prototype,"crlId",void 0),An([bn({type:Ot.Any,context:0})],vu.prototype,"crltValue",void 0);class gu extends Rr{}class mu{constructor(e={}){this.encryptionAlgorithm=new io,this.encryptedData=new gu,Object.assign(this,e)}}var wu,Su;An([bn({type:io})],mu.prototype,"encryptionAlgorithm",void 0),An([bn({type:gu})],mu.prototype,"encryptedData",void 0),function(e){e[e.v1=0]="v1"}(Su||(Su={}));class Au extends Rr{}let _u=wu=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,wu.prototype)}};_u=wu=An([yn({type:Bt.Sequence,itemType:Ji})],_u);class Mu{constructor(e={}){this.version=Su.v1,this.privateKeyAlgorithm=new io,this.privateKey=new Au,Object.assign(this,e)}}An([bn({type:Ot.Integer})],Mu.prototype,"version",void 0),An([bn({type:io})],Mu.prototype,"privateKeyAlgorithm",void 0),An([bn({type:Au})],Mu.prototype,"privateKey",void 0),An([bn({type:_u,implicit:!0,context:0,optional:!0})],Mu.prototype,"attributes",void 0);let ku=class extends Mu{};ku=An([yn({type:Bt.Sequence})],ku);let xu=class extends mu{};xu=An([yn({type:Bt.Sequence})],xu);class Eu{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],Eu.prototype,"secretTypeId",void 0),An([bn({type:Ot.Any,context:0})],Eu.prototype,"secretValue",void 0);class Bu{constructor(e={}){this.mac=new Ua,this.macSalt=new Rr,this.iterations=1,Object.assign(this,e)}}An([bn({type:Ua})],Bu.prototype,"mac",void 0),An([bn({type:Rr})],Bu.prototype,"macSalt",void 0),An([bn({type:Ot.Integer,defaultValue:1})],Bu.prototype,"iterations",void 0);class Ou{constructor(e={}){this.version=3,this.authSafe=new ls,this.macData=new Bu,Object.assign(this,e)}}var ju;An([bn({type:Ot.Integer})],Ou.prototype,"version",void 0),An([bn({type:ls})],Ou.prototype,"authSafe",void 0),An([bn({type:Bu,optional:!0})],Ou.prototype,"macData",void 0);class Iu{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:Ot.ObjectIdentifier})],Iu.prototype,"bagId",void 0),An([bn({type:Ot.Any,context:0})],Iu.prototype,"bagValue",void 0),An([bn({type:hu,repeated:"set",optional:!0})],Iu.prototype,"bagAttributes",void 0);let Pu=ju=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,ju.prototype)}};var Cu,Nu,Uu;Pu=ju=An([yn({type:Bt.Sequence,itemType:Iu})],Pu);const Tu="1.2.840.113549.1.9",Ru=`${Tu}.7`,Du=`${Tu}.14`;let Ku=class extends Bn{constructor(e={}){super(e)}toString(){return{}.toString(),this.ia5String||super.toString()}};An([bn({type:Ot.IA5String})],Ku.prototype,"ia5String",void 0),Ku=An([yn({type:Bt.Choice})],Ku);let Lu=class extends ls{};Lu=An([yn({type:Bt.Sequence})],Lu);let zu=class extends Ou{};zu=An([yn({type:Bt.Sequence})],zu);let Hu=class extends mu{};Hu=An([yn({type:Bt.Sequence})],Hu);let qu=class{constructor(e=""){this.value=e}toString(){return this.value}};An([bn({type:Ot.IA5String})],qu.prototype,"value",void 0),qu=An([yn({type:Bt.Choice})],qu);let Fu=class extends Ku{};Fu=An([yn({type:Bt.Choice})],Fu);let Vu=class extends Bn{};Vu=An([yn({type:Bt.Choice})],Vu);let $u=class{constructor(e=new Date){this.value=e}};An([bn({type:Ot.GeneralizedTime})],$u.prototype,"value",void 0),$u=An([yn({type:Bt.Choice})],$u);let Ju=class extends Bn{};Ju=An([yn({type:Bt.Choice})],Ju);let Wu=class{constructor(e="M"){this.value=e}toString(){return this.value}};An([bn({type:Ot.PrintableString})],Wu.prototype,"value",void 0),Wu=An([yn({type:Bt.Choice})],Wu);let Gu=class{constructor(e=""){this.value=e}toString(){return this.value}};An([bn({type:Ot.PrintableString})],Gu.prototype,"value",void 0),Gu=An([yn({type:Bt.Choice})],Gu);let Zu=class extends Gu{};Zu=An([yn({type:Bt.Choice})],Zu);let Yu=class extends Bn{};Yu=An([yn({type:Bt.Choice})],Yu);let Xu=class{constructor(e=""){this.value=e}toString(){return this.value}};An([bn({type:Ot.ObjectIdentifier})],Xu.prototype,"value",void 0),Xu=An([yn({type:Bt.Choice})],Xu);let Qu=class extends so{};Qu=An([yn({type:Bt.Choice})],Qu);let ec=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};An([bn({type:Ot.Integer})],ec.prototype,"value",void 0),ec=An([yn({type:Bt.Choice})],ec);let tc=class extends Oo{};tc=An([yn({type:Bt.Sequence})],tc);let rc=class extends Bn{};rc=An([yn({type:Bt.Choice})],rc);let nc=Cu=class extends fo{constructor(e){super(e),Object.setPrototypeOf(this,Cu.prototype)}};nc=Cu=An([yn({type:Bt.Sequence})],nc);let ic=Nu=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Nu.prototype)}};ic=Nu=An([yn({type:Bt.Set,itemType:Eo})],ic);let oc=class{constructor(e=""){this.value=e}toString(){return this.value}};An([bn({type:Ot.BmpString})],oc.prototype,"value",void 0),oc=An([yn({type:Bt.Choice})],oc);let sc=class extends io{};sc=An([yn({type:Bt.Sequence})],sc);let ac=Uu=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,Uu.prototype)}};var uc;ac=Uu=An([yn({type:Bt.Sequence,itemType:sc})],ac);let cc=uc=class extends wn{constructor(e){super(e),Object.setPrototypeOf(this,uc.prototype)}};cc=uc=An([yn({type:Bt.Sequence,itemType:Ji})],cc);class fc{constructor(e={}){this.version=0,this.subject=new Cn,this.subjectPKInfo=new oo,this.attributes=new cc,Object.assign(this,e)}}An([bn({type:Ot.Integer})],fc.prototype,"version",void 0),An([bn({type:Cn})],fc.prototype,"subject",void 0),An([bn({type:oo})],fc.prototype,"subjectPKInfo",void 0),An([bn({type:cc,implicit:!0,context:0})],fc.prototype,"attributes",void 0);class lc{constructor(e={}){this.certificationRequestInfo=new fc,this.signatureAlgorithm=new io,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}An([bn({type:fc})],lc.prototype,"certificationRequestInfo",void 0),An([bn({type:io})],lc.prototype,"signatureAlgorithm",void 0),An([bn({type:Ot.BitString})],lc.prototype,"signature",void 0);const hc="crypto.algorithm",dc="crypto.algorithmProvider";var pc;cu.registerSingleton(dc,class{getAlgorithms(){return cu.resolveAll(hc)}toAsnAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toAsnAlgorithm(e);if(r)return r}if(/^[0-9.]+$/.test(e.name)){const t=new io({algorithm:e.name});if("parameters"in e){const r=e;t.parameters=r.parameters}return t}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toWebAlgorithm(e);if(r)return r}return{name:e.algorithm,parameters:e.parameters}}});const yc="1.3.36.3.3.2.8.1.1",bc=`${yc}.1`,vc=`${yc}.2`,gc=`${yc}.3`,mc=`${yc}.4`,wc=`${yc}.5`,Sc=`${yc}.6`,Ac=`${yc}.7`,_c=`${yc}.8`,Mc=`${yc}.9`,kc=`${yc}.10`,xc=`${yc}.11`,Ec=`${yc}.12`,Bc=`${yc}.13`,Oc=`${yc}.14`,jc="brainpoolP160r1",Ic="brainpoolP160t1",Pc="brainpoolP192r1",Cc="brainpoolP192t1",Nc="brainpoolP224r1",Uc="brainpoolP224t1",Tc="brainpoolP256r1",Rc="brainpoolP256t1",Dc="brainpoolP320r1",Kc="brainpoolP320t1",Lc="brainpoolP384r1",zc="brainpoolP384t1",Hc="brainpoolP512r1",qc="brainpoolP512t1",Fc="ECDSA";let Vc=pc=class{toAsnAlgorithm(e){if(e.name.toLowerCase()===Fc.toLowerCase())if("hash"in e)switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return ra;case"sha-256":return na;case"sha-384":return ia;case"sha-512":return oa}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=Xs;break;case"K-256":t=pc.SECP256K1;break;case"P-384":t=Qs;break;case"P-521":t=ea;break;case jc:t=bc;break;case Ic:t=vc;break;case Pc:t=gc;break;case Cc:t=mc;break;case Nc:t=wc;break;case Uc:t=Sc;break;case Tc:t=Ac;break;case Rc:t=_c;break;case Dc:t=Mc;break;case Kc:t=kc;break;case Lc:t=xc;break;case zc:t=Ec;break;case Hc:t=Bc;break;case qc:t=Oc}if(t)return new io({algorithm:$s,parameters:Sn.serialize(new sa({namedCurve:t}))})}return null}toWebAlgorithm(e){switch(e.algorithm){case Js:return{name:Fc,hash:{name:"SHA-1"}};case Gs:return{name:Fc,hash:{name:"SHA-256"}};case Zs:return{name:Fc,hash:{name:"SHA-384"}};case Ys:return{name:Fc,hash:{name:"SHA-512"}};case $s:if(!e.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(Sn.parse(e.parameters,sa).namedCurve){case Xs:return{name:Fc,namedCurve:"P-256"};case pc.SECP256K1:return{name:Fc,namedCurve:"K-256"};case Qs:return{name:Fc,namedCurve:"P-384"};case ea:return{name:Fc,namedCurve:"P-521"};case bc:return{name:Fc,namedCurve:jc};case vc:return{name:Fc,namedCurve:Ic};case gc:return{name:Fc,namedCurve:Pc};case mc:return{name:Fc,namedCurve:Cc};case wc:return{name:Fc,namedCurve:Nc};case Sc:return{name:Fc,namedCurve:Uc};case Ac:return{name:Fc,namedCurve:Tc};case _c:return{name:Fc,namedCurve:Rc};case Mc:return{name:Fc,namedCurve:Dc};case kc:return{name:Fc,namedCurve:Kc};case xc:return{name:Fc,namedCurve:Lc};case Ec:return{name:Fc,namedCurve:zc};case Bc:return{name:Fc,namedCurve:Hc};case Oc:return{name:Fc,namedCurve:qc}}}return null}};Vc.SECP256K1="1.3.132.0.10",Vc=pc=An([fu()],Vc),cu.registerSingleton(hc,Vc);const $c=Symbol("name"),Jc=Symbol("value");class Wc{constructor(e,t={},r=""){this[$c]=e,this[Jc]=r;for(const e in t)this[e]=t[e]}}Wc.NAME=$c,Wc.VALUE=Jc;class Gc{static toString(e){return this.items[e]||e}}Gc.items={[_a]:"sha1",[Ma]:"sha224",[ka]:"sha256",[xa]:"sha384",[Ea]:"sha512",[fa]:"rsaEncryption",[ba]:"sha1WithRSAEncryption",[va]:"sha224WithRSAEncryption",[ga]:"sha256WithRSAEncryption",[ma]:"sha384WithRSAEncryption",[wa]:"sha512WithRSAEncryption",[$s]:"ecPublicKey",[Js]:"ecdsaWithSHA1",[Ws]:"ecdsaWithSHA224",[Gs]:"ecdsaWithSHA256",[Zs]:"ecdsaWithSHA384",[Ys]:"ecdsaWithSHA512",[_i]:"TLS WWW server authentication",[Mi]:"TLS WWW client authentication",[ki]:"Code Signing",[xi]:"E-mail Protection",[Ei]:"Time Stamping",[Bi]:"OCSP Signing",[Hs]:"Signed Data"};class Zc{static serialize(e){return this.serializeObj(e).join("\n")}static pad(e=0){return"".padStart(2*e," ")}static serializeObj(e,t=0){const r=[];let n=this.pad(t++),i="";const o=e[Wc.VALUE];o&&(i=` ${o}`),r.push(`${n}${e[Wc.NAME]}:${i}`),n=this.pad(t);for(const i in e){if("symbol"==typeof i)continue;const o=e[i],s=i?`${i}: `:"";if("string"==typeof o||"number"==typeof o||"boolean"==typeof o)r.push(`${n}${s}${o}`);else if(o instanceof Date)r.push(`${n}${s}${o.toUTCString()}`);else if(Array.isArray(o))for(const e of o)e[Wc.NAME]=i,r.push(...this.serializeObj(e,t));else if(o instanceof Wc)o[Wc.NAME]=i,r.push(...this.serializeObj(o,t));else if(le.vJ.isBufferSource(o))i?(r.push(`${n}${s}`),r.push(...this.serializeBufferSource(o,t+1))):r.push(...this.serializeBufferSource(o,t));else{if(!("toTextObject"in o))throw new TypeError("Cannot serialize data in text format. Unsupported type.");{const e=o.toTextObject();e[Wc.NAME]=i,r.push(...this.serializeObj(e,t))}}}return r}static serializeBufferSource(e,t=0){const r=this.pad(t),n=le.vJ.toUint8Array(e),i=[];for(let e=0;e<n.length;){const t=[];for(let r=0;r<16&&e<n.length;r++){8===r&&t.push("");const i=n[e++].toString(16).padStart(2,"0");t.push(i)}i.push(`${r}${t.join(" ")}`)}return i}static serializeAlgorithm(e){return this.algorithmSerializer.toTextObject(e)}}Zc.oidSerializer=Gc,Zc.algorithmSerializer=class{static toTextObject(e){const t=new Wc("Algorithm Identifier",{},Gc.toString(e.algorithm));if(e.parameters)switch(e.algorithm){case $s:{const r=(new Vc).toWebAlgorithm(e);r&&"namedCurve"in r?t["Named Curve"]=r.namedCurve:t.Parameters=e.parameters;break}default:t.Parameters=e.parameters}return t}};class Yc{constructor(...e){if(1===e.length){const t=e[0];this.rawData=Sn.serialize(t),this.onInit(t)}else{const t=Sn.parse(e[0],e[1]);this.rawData=le.vJ.toArrayBuffer(e[0]),this.onInit(t)}}equal(e){return e instanceof Yc&&(0,le.Xy)(e.rawData,this.rawData)}toString(e="text"){switch(e){case"asn":return Sn.toString(this.rawData);case"text":return Zc.serialize(this.toTextObject());case"hex":return le.ep.ToHex(this.rawData);case"base64":return le.ep.ToBase64(this.rawData);case"base64url":return le.ep.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){const e=this.toTextObjectEmpty();return e[""]=this.rawData,e}toTextObjectEmpty(e){return new Wc(this.getTextName(),{},e)}}Yc.NAME="ASN";class Xc extends Yc{constructor(...e){let t;t=le.vJ.isBufferSource(e[0])?le.vJ.toArrayBuffer(e[0]):Sn.serialize(new co({extnID:e[0],critical:e[1],extnValue:new Rr(le.vJ.toArrayBuffer(e[2]))})),super(t,co)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}toTextObject(){const e=this.toTextObjectWithoutValue();return e[""]=this.value,e}toTextObjectWithoutValue(){const e=this.toTextObjectEmpty(this.critical?"critical":void 0);return e[Wc.NAME]===Xc.NAME&&(e[Wc.NAME]=Gc.toString(this.type)),e}}var Qc;class ef{static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}constructor(){this.items=new Map,this[Qc]="CryptoProvider","undefined"!=typeof self&&"undefined"!=typeof crypto&&this.set(ef.DEFAULT,crypto)}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,t){return this.items.forEach(e,t)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=ef.DEFAULT){const t=this.items.get(e.toLowerCase());if(!t)throw new Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw new TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),t)}else this.items.set(ef.DEFAULT,e);return this}}Qc=Symbol.toStringTag,ef.DEFAULT="default";const tf=new ef,rf=/^[0-2](?:\.[1-9][0-9]*)+$/;class nf{constructor(e={}){this.items={};for(const t in e)this.register(t,e[t])}get(e){return this.items[e]||null}findId(e){return t=e,new RegExp(rf).test(t)?e:this.get(e);var t}register(e,t){this.items[e]=t,this.items[t]=e}}const of=new nf;function sf(e,t){return`\\${le.ep.ToHex(le.ep.FromUtf8String(t)).toUpperCase()}`}of.register("CN","2.5.4.3"),of.register("L","2.5.4.7"),of.register("ST","2.5.4.8"),of.register("O","2.5.4.10"),of.register("OU","2.5.4.11"),of.register("C","2.5.4.6"),of.register("DC","0.9.2342.19200300.100.1.25"),of.register("E","1.2.840.113549.1.9.1"),of.register("G","2.5.4.42"),of.register("I","2.5.4.43"),of.register("SN","2.5.4.4"),of.register("T","2.5.4.12");class af{static isASCII(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!1;return!0}constructor(e,t={}){this.extraNames=new nf,this.asn=new Cn;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof Cn?this.asn=e:le.vJ.isBufferSource(e)?this.asn=Sn.parse(e,Cn):this.asn=this.fromJSON(e)}getField(e){const t=this.extraNames.findId(e)||of.findId(e),r=[];for(const e of this.asn)for(const n of e)n.type===t&&r.push(n.value.toString());return r}getName(e){return this.extraNames.get(e)||of.get(e)}toString(){return this.asn.map((e=>e.map((e=>`${this.getName(e.type)||e.type}=${e.value.anyValue?`#${le.ep.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,sf)}`)).join("+"))).join(", ")}toJSON(){var e;const t=[];for(const r of this.asn){const n={};for(const t of r){const r=this.getName(t.type)||t.type;null!==(e=n[r])&&void 0!==e||(n[r]=[]),n[r].push(t.value.anyValue?`#${le.ep.ToHex(t.value.anyValue)}`:t.value.toString())}t.push(n)}return t}fromString(e){const t=new Cn,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let n=null,i=",";for(;n=r.exec(`${e},`);){let[,e,r]=n;const o=r[r.length-1];","!==o&&"+"!==o||(r=r.slice(0,r.length-1),n[3]=o);const s=n[3];if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw new Error(`Cannot get OID for name type '${e}'`);const a=new jn({type:e});if("#"===r.charAt(0))a.value.anyValue=le.ep.FromHex(r.slice(1));else{const t=/"(.*?[^\\])?"/.exec(r);t&&(r=t[1]),r=r.replace(/\\0a/gi,"\n").replace(/\\0d/gi,"\r").replace(/\\0g/gi,"\t").replace(/\\(.)/g,"$1"),e===this.getName("E")||e===this.getName("DC")?a.value.ia5String=r:af.isASCII(r)?a.value.printableString=r:a.value.utf8String=r}"+"===i?t[t.length-1].push(a):t.push(new In([a])),i=s}return t}fromJSON(e){const t=new Cn;for(const r of e){const e=new In;for(const t in r){let n=t;if(/[\d.]+/.test(t)||(n=this.getName(t)||""),!n)throw new Error(`Cannot get OID for name type '${t}'`);const i=r[t];for(const t of i){const r=new jn({type:n});if("object"==typeof t)for(const e in t)switch(e){case"ia5String":r.value.ia5String=t[e];break;case"utf8String":r.value.utf8String=t[e];break;case"universalString":r.value.universalString=t[e];break;case"bmpString":r.value.bmpString=t[e];break;case"printableString":r.value.printableString=t[e]}else"#"===t[0]?r.value.anyValue=le.ep.FromHex(t.slice(1)):n===this.getName("E")||n===this.getName("DC")?r.value.ia5String=t:r.value.printableString=t;e.push(r)}}t.push(e)}return t}toArrayBuffer(){return Sn.serialize(this.asn)}async getThumbprint(...e){var t;let r,n="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(n=e[0]||n,r=e[1]||tf.get()):r=e[0]||tf.get(),await r.subtle.digest(n,this.toArrayBuffer())}}const uf="Cannot initialize GeneralName from ASN.1 data.",cf=`${uf} Unsupported string format in use.`,ff=`${uf} Value doesn't match to GUID regular expression.`,lf=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,hf="1.3.6.1.4.1.311.25.1",df="1.3.6.1.4.1.311.20.2.3",pf="dns",yf="dn",bf="email",vf="ip",gf="url",mf="guid",wf="upn",Sf="id";class Af extends Yc{constructor(...e){let t;if(2===e.length)switch(e[0]){case yf:{const r=new af(e[1]).toArrayBuffer(),n=Sn.parse(r,Cn);t=new Rn({directoryName:n});break}case pf:t=new Rn({dNSName:e[1]});break;case bf:t=new Rn({rfc822Name:e[1]});break;case mf:{const r=new RegExp(lf,"i").exec(e[1]);if(!r)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const n=r.slice(1).map(((e,t)=>t<3?le.ep.ToHex(new Uint8Array(le.ep.FromHex(e)).reverse()):e)).join("");t=new Rn({otherName:new Un({typeId:hf,value:Sn.serialize(new Rr(le.ep.FromHex(n)))})});break}case vf:t=new Rn({iPAddress:e[1]});break;case Sf:t=new Rn({registeredID:e[1]});break;case wf:t=new Rn({otherName:new Un({typeId:df,value:Sn.serialize(Wr.toASN(e[1]))})});break;case gf:t=new Rn({uniformResourceIdentifier:e[1]});break;default:throw new Error("Cannot create GeneralName. Unsupported type of the name")}else t=le.vJ.isBufferSource(e[0])?Sn.parse(e[0],Rn):e[0];super(t)}onInit(e){if(null!=e.dNSName)this.type=pf,this.value=e.dNSName;else if(null!=e.rfc822Name)this.type=bf,this.value=e.rfc822Name;else if(null!=e.iPAddress)this.type=vf,this.value=e.iPAddress;else if(null!=e.uniformResourceIdentifier)this.type=gf,this.value=e.uniformResourceIdentifier;else if(null!=e.registeredID)this.type=Sf,this.value=e.registeredID;else if(null!=e.directoryName)this.type=yf,this.value=new af(e.directoryName).toString();else{if(null==e.otherName)throw new Error(cf);if(e.otherName.typeId===hf){this.type=mf;const t=Sn.parse(e.otherName.value,Rr),r=new RegExp(lf,"i").exec(le.ep.ToHex(t));if(!r)throw new Error(ff);this.value=r.slice(1).map(((e,t)=>t<3?le.ep.ToHex(new Uint8Array(le.ep.FromHex(e)).reverse()):e)).join("-")}else{if(e.otherName.typeId!==df)throw new Error(cf);this.type=wf,this.value=Sn.parse(e.otherName.value,Bn).toString()}}}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let e;switch(this.type){case yf:case pf:case mf:case vf:case Sf:case wf:case gf:e=this.type.toUpperCase();break;case bf:e="Email";break;default:throw new Error("Unsupported GeneralName type")}let t=this.value;return this.type===Sf&&(t=Gc.toString(t)),new Wc(e,void 0,t)}}class _f extends Yc{constructor(e){let t;if(e instanceof Gn)t=e;else if(Array.isArray(e)){const r=[];for(const t of e)if(t instanceof Rn)r.push(t);else{const e=Sn.parse(new Af(t.type,t.value).rawData,Rn);r.push(e)}t=new Gn(r)}else{if(!le.vJ.isBufferSource(e))throw new Error("Cannot initialize GeneralNames. Incorrect incoming arguments");t=Sn.parse(e,Gn)}super(t)}onInit(e){const t=[];for(const r of e){let e=null;try{e=new Af(r)}catch{continue}t.push(e)}this.items=t}toJSON(){return this.items.map((e=>e.toJSON()))}toTextObject(){const e=super.toTextObjectEmpty();for(const t of this.items){const r=t.toTextObject();let n=e[r[Wc.NAME]];Array.isArray(n)||(n=[],e[r[Wc.NAME]]=n),n.push(r)}return e}}_f.NAME="GeneralNames";const Mf="-{5}",kf="\\n",xf="\\n",Ef=`${Mf}BEGIN ([^${kf}]+(?=${Mf}))${Mf}${xf}(?:((?:[^:${kf}]+: (?:[^${kf}]+${xf}(?: +[^${kf}]+${xf})*))+))?${xf}?((?:[a-zA-Z0-9=+/]+${xf})+)${Mf}END \\1${Mf}`;class Bf{static isPem(e){return"string"==typeof e&&new RegExp(Ef,"g").test(e)}static decodeWithHeaders(e){e=e.replace(/\r/g,"");const t=new RegExp(Ef,"g"),r=[];let n=null;for(;n=t.exec(e);){const e=n[3].replace(new RegExp(`[${kf}]+`,"g"),""),t={type:n[1],headers:[],rawData:le.ep.FromBase64(e)},i=n[2];if(i){const e=i.split(new RegExp(xf,"g"));let r=null;for(const n of e){const[e,i]=n.split(/:(.*)/);if(void 0===i){if(!r)throw new Error("Cannot parse PEM string. Incorrect header value");r.value+=e.trim()}else r&&t.headers.push(r),r={key:e,value:i.trim()}}r&&t.headers.push(r)}r.push(t)}return r}static decode(e){return this.decodeWithHeaders(e).map((e=>e.rawData))}static decodeFirst(e){const t=this.decode(e);if(!t.length)throw new RangeError("PEM string doesn't contain any objects");return t[0]}static encode(e,t){if(Array.isArray(e)){const r=new Array;return t?e.forEach((e=>{if(!le.vJ.isBufferSource(e))throw new TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");r.push(this.encodeStruct({type:t,rawData:le.vJ.toArrayBuffer(e)}))})):e.forEach((e=>{if(!("type"in e))throw new TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");r.push(this.encodeStruct(e))})),r.join("\n")}if(!t)throw new Error("Required argument 'tag' is missed");return this.encodeStruct({type:t,rawData:le.vJ.toArrayBuffer(e)})}static encodeStruct(e){var t;const r=e.type.toLocaleUpperCase(),n=[];if(n.push(`-----BEGIN ${r}-----`),null===(t=e.headers)||void 0===t?void 0:t.length){for(const t of e.headers)n.push(`${t.key}: ${t.value}`);n.push("")}const i=le.ep.ToBase64(e.rawData);let o,s=0;const a=Array();for(;s<i.length&&(i.length-s<64?o=i.substring(s):(o=i.substring(s,s+64),s+=64),0!==o.length)&&(a.push(o),!(o.length<64)););return n.push(...a),n.push(`-----END ${r}-----`),n.join("\n")}}Bf.CertificateTag="CERTIFICATE",Bf.CrlTag="CRL",Bf.CertificateRequestTag="CERTIFICATE REQUEST",Bf.PublicKeyTag="PUBLIC KEY",Bf.PrivateKeyTag="PRIVATE KEY";class Of extends Yc{static isAsnEncoded(e){return le.vJ.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e){if(Bf.isPem(e))return Bf.decode(e)[0];if(le.ep.isHex(e))return le.ep.FromHex(e);if(le.ep.isBase64(e))return le.ep.FromBase64(e);if(le.ep.isBase64Url(e))return le.ep.FromBase64Url(e);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}{const t=le.ep.ToBinary(e);return Bf.isPem(t)?Bf.decode(t)[0]:le.ep.isHex(t)?le.ep.FromHex(t):le.ep.isBase64(t)?le.ep.FromBase64(t):le.ep.isBase64Url(t)?le.ep.FromBase64Url(t):le.vJ.toArrayBuffer(e)}}constructor(...e){Of.isAsnEncoded(e[0])?super(Of.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){return"pem"===e?Bf.encode(this.rawData,this.tag):super.toString(e)}}class jf extends Of{constructor(e){Of.isAsnEncoded(e)?super(e,oo):super(e),this.tag=Bf.PublicKeyTag}async export(...e){let t,r=["verify"],n={hash:"SHA-256",...this.algorithm};return e.length>1?(n=e[0]||n,r=e[1]||r,t=e[2]||tf.get()):t=e[0]||tf.get(),t.subtle.importKey("spki",this.rawData,n,!0,r)}onInit(e){const t=cu.resolve(dc),r=this.algorithm=t.toWebAlgorithm(e.algorithm);switch(e.algorithm.algorithm){case fa:{const t=Sn.parse(e.subjectPublicKey,La),n=le.vJ.toUint8Array(t.modulus);r.publicExponent=le.vJ.toUint8Array(t.publicExponent),r.modulusLength=(n[0]?n:n.slice(1)).byteLength<<3;break}}}async getThumbprint(...e){var t;let r,n="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(n=e[0]||n,r=e[1]||tf.get()):r=e[0]||tf.get(),await r.subtle.digest(n,this.rawData)}async getKeyIdentifier(e){e||(e=tf.get());const t=Sn.parse(this.rawData,oo);return await e.subtle.digest("SHA-1",t.subjectPublicKey)}toTextObject(){const e=this.toTextObjectEmpty(),t=Sn.parse(this.rawData,oo);return e.Algorithm=Zc.serializeAlgorithm(t.algorithm),t.algorithm.algorithm===$s?e["EC Point"]=t.subjectPublicKey:e["Raw Data"]=t.subjectPublicKey,e}}class If{static register(e,t){this.items.set(e,t)}static create(e){const t=new Xc(e),r=this.items.get(t.type);return r?new r(e):t}}If.items=new Map;const Pf="crypto.signatureFormatter";class Cf extends Of{constructor(e){Of.isAsnEncoded(e)?super(e,po):super(e),this.tag=Bf.CertificateTag}onInit(e){const t=e.tbsCertificate;this.tbs=Sn.serialize(t),this.serialNumber=le.ep.ToHex(t.serialNumber),this.subjectName=new af(t.subject),this.subject=new af(t.subject).toString(),this.issuerName=new af(t.issuer),this.issuer=this.issuerName.toString();const r=cu.resolve(dc);this.signatureAlgorithm=r.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signatureValue;const n=t.validity.notBefore.utcTime||t.validity.notBefore.generalTime;if(!n)throw new Error("Cannot get 'notBefore' value");this.notBefore=n;const i=t.validity.notAfter.utcTime||t.validity.notAfter.generalTime;if(!i)throw new Error("Cannot get 'notAfter' value");this.notAfter=i,this.extensions=[],t.extensions&&(this.extensions=t.extensions.map((e=>If.create(Sn.serialize(e))))),this.publicKey=new jf(t.subjectPublicKeyInfo)}getExtension(e){for(const t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter((t=>"string"==typeof e?t.type===e:t instanceof e))}async verify(e={},t=tf.get()){let r,n;const i=e.publicKey;try{if(i)if("publicKey"in i)r={...i.publicKey.algorithm,...this.signatureAlgorithm},n=await i.publicKey.export(r,["verify"],t);else if(i instanceof jf)r={...i.algorithm,...this.signatureAlgorithm},n=await i.export(r,["verify"],t);else if(le.vJ.isBufferSource(i)){const e=new jf(i);r={...e.algorithm,...this.signatureAlgorithm},n=await e.export(r,["verify"],t)}else r={...i.algorithm,...this.signatureAlgorithm},n=i;else r={...this.publicKey.algorithm,...this.signatureAlgorithm},n=await this.publicKey.export(r,["verify"],t)}catch(e){return!1}const o=cu.resolveAll(Pf).reverse();let s=null;for(const e of o)if(s=e.toWebSignature(r,this.signature),s)break;if(!s)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const a=await t.subtle.verify(this.signatureAlgorithm,n,s,this.tbs);if(e.signatureOnly)return a;{const t=(e.date||new Date).getTime();return a&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=tf.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(e=tf.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}toTextObject(){const e=this.toTextObjectEmpty(),t=Sn.parse(this.rawData,po),r=t.tbsCertificate,n=new Wc("",{Version:`${lo[r.version]} (${r.version})`,"Serial Number":r.serialNumber,"Signature Algorithm":Zc.serializeAlgorithm(r.signature),Issuer:this.issuer,Validity:new Wc("",{"Not Before":r.validity.notBefore.getTime(),"Not After":r.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(r.issuerUniqueID&&(n["Issuer Unique ID"]=r.issuerUniqueID),r.subjectUniqueID&&(n["Subject Unique ID"]=r.subjectUniqueID),this.extensions.length){const e=new Wc("");for(const t of this.extensions){const r=t.toTextObject();e[r[Wc.NAME]]=r}n.Extensions=e}return e.Data=n,e.Signature=new Wc("",{Algorithm:Zc.serializeAlgorithm(t.signatureAlgorithm),"":t.signatureValue}),e}}Cf.NAME="Certificate";class Nf extends Xc{static async create(e,t=!1,r=tf.get()){if(e instanceof Cf||ef.isCryptoKey(e)){const n=e instanceof Cf?await e.publicKey.export(r):e,i=await r.subtle.exportKey("spki",n),o=new jf(i),s=await o.getKeyIdentifier(r);return new Nf(le.ep.ToHex(s),t)}return new Nf(e,t)}constructor(...e){if(le.vJ.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0]){const t=new Vn({keyIdentifier:new Fn(le.ep.FromHex(e[0]))});super(qn,e[1],Sn.serialize(t))}else{const t=e[0],r=t.name instanceof _f?Sn.parse(t.name.rawData,Gn):t.name,n=new Vn({authorityCertIssuer:r,authorityCertSerialNumber:le.ep.FromHex(t.serialNumber)});super(qn,e[1],Sn.serialize(n))}}onInit(e){super.onInit(e);const t=Sn.parse(e.extnValue,Vn);t.keyIdentifier&&(this.keyId=le.ep.ToHex(t.keyIdentifier)),t.authorityCertIssuer&&t.authorityCertSerialNumber&&(this.certId={name:t.authorityCertIssuer,serialNumber:le.ep.ToHex(t.authorityCertSerialNumber)})}toTextObject(){const e=this.toTextObjectWithoutValue(),t=Sn.parse(this.value,Vn);return t.authorityCertIssuer&&(e["Authority Issuer"]=new _f(t.authorityCertIssuer).toTextObject()),t.authorityCertSerialNumber&&(e["Authority Serial Number"]=t.authorityCertSerialNumber),t.keyIdentifier&&(e[""]=t.keyIdentifier),e}}Nf.NAME="Authority Key Identifier";class Uf extends Xc{constructor(...e){if(le.vJ.isBufferSource(e[0])){super(e[0]);const t=Sn.parse(this.value,Jn);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else{const t=new Jn({cA:e[0],pathLenConstraint:e[1]});super($n,e[2],Sn.serialize(t)),this.ca=e[0],this.pathLength=e[1]}}toTextObject(){const e=this.toTextObjectWithoutValue();return this.ca&&(e.CA=this.ca),void 0!==this.pathLength&&(e["Path Length"]=this.pathLength),e}}var Tf,Rf;Uf.NAME="Basic Constraints",function(e){e.serverAuth="1.3.6.1.5.5.7.3.1",e.clientAuth="1.3.6.1.5.5.7.3.2",e.codeSigning="1.3.6.1.5.5.7.3.3",e.emailProtection="1.3.6.1.5.5.7.3.4",e.timeStamping="1.3.6.1.5.5.7.3.8",e.ocspSigning="1.3.6.1.5.5.7.3.9"}(Tf||(Tf={}));class Df extends Xc{constructor(...e){if(le.vJ.isBufferSource(e[0])){super(e[0]);const t=Sn.parse(this.value,Ai);this.usages=t.map((e=>e))}else{const t=new Ai(e[0]);super(Si,e[1],Sn.serialize(t)),this.usages=e[0]}}toTextObject(){const e=this.toTextObjectWithoutValue();return e[""]=this.usages.map((e=>Gc.toString(e))).join(", "),e}}Df.NAME="Extended Key Usages",function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(Rf||(Rf={}));class Kf extends Xc{constructor(...e){if(le.vJ.isBufferSource(e[0])){super(e[0]);const t=Sn.parse(this.value,Ti);this.usages=t.toNumber()}else{const t=new Ti(e[0]);super(Ci,e[1],Sn.serialize(t)),this.usages=e[0]}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=Sn.parse(this.value,Ti);return e[""]=t.toJSON().join(", "),e}}Kf.NAME="Key Usages";class Lf extends Xc{static async create(e,t=!1,r=tf.get()){let n;n=e instanceof jf?e.rawData:"publicKey"in e?e.publicKey.rawData:le.vJ.isBufferSource(e)?e:await r.subtle.exportKey("spki",e);const i=new jf(n),o=await i.getKeyIdentifier(r);return new Lf(le.ep.ToHex(o),t)}constructor(...e){if(le.vJ.isBufferSource(e[0])){super(e[0]);const t=Sn.parse(this.value,Yi);this.keyId=le.ep.ToHex(t)}else{const t="string"==typeof e[0]?le.ep.FromHex(e[0]):e[0],r=new Yi(t);super(Zi,e[1],Sn.serialize(r)),this.keyId=le.ep.ToHex(t)}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=Sn.parse(this.value,Yi);return e[""]=t,e}}Lf.NAME="Subject Key Identifier";class zf extends Xc{constructor(...e){le.vJ.isBufferSource(e[0])?super(e[0]):super(Vi,e[1],new _f(e[0]||[]).rawData)}onInit(e){super.onInit(e);const t=Sn.parse(e.extnValue,$i);this.names=new _f(t)}toTextObject(){const e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(const r in t)e[r]=t[r];return e}}zf.NAME="Subject Alternative Name";class Hf extends Xc{constructor(...e){var t;if(le.vJ.isBufferSource(e[0])){super(e[0]);const t=Sn.parse(this.value,si);this.policies=t.map((e=>e.policyIdentifier))}else{const r=e[0],n=null!==(t=e[1])&&void 0!==t&&t,i=new si(r.map((e=>new oi({policyIdentifier:e}))));super(Qn,n,Sn.serialize(i)),this.policies=r}}toTextObject(){const e=this.toTextObjectWithoutValue();return e.Policy=this.policies.map((e=>new Wc("",{},Gc.toString(e)))),e}}Hf.NAME="Certificate Policies",If.register(Qn,Hf);class qf extends Yc{constructor(...e){let t;if(le.vJ.isBufferSource(e[0]))t=le.vJ.toArrayBuffer(e[0]);else{const r=e[0],n=Array.isArray(e[1])?e[1].map((e=>le.vJ.toArrayBuffer(e))):[];t=Sn.serialize(new Ji({type:r,values:n}))}super(t,Ji)}onInit(e){this.type=e.type,this.values=e.values}toTextObject(){const e=this.toTextObjectWithoutValue();return e.Value=this.values.map((e=>new Wc("",{"":e}))),e}toTextObjectWithoutValue(){const e=this.toTextObjectEmpty();return e[Wc.NAME]===qf.NAME&&(e[Wc.NAME]=Gc.toString(this.type)),e}}qf.NAME="Attribute";class Ff extends qf{constructor(...e){var t;if(le.vJ.isBufferSource(e[0]))super(e[0]);else{const t=new rc({printableString:e[0]});super(Ru,[Sn.serialize(t)])}null!==(t=this.password)&&void 0!==t||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){const e=Sn.parse(this.values[0],rc);this.password=e.toString()}}toTextObject(){const e=this.toTextObjectWithoutValue();return e[Wc.VALUE]=this.password,e}}Ff.NAME="Challenge Password";class Vf extends qf{constructor(...e){var t;if(le.vJ.isBufferSource(e[0]))super(e[0]);else{const t=e[0],r=new fo;for(const e of t)r.push(Sn.parse(e.rawData,co));super(Du,[Sn.serialize(r)])}null!==(t=this.items)&&void 0!==t||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){const e=Sn.parse(this.values[0],fo);this.items=e.map((e=>If.create(Sn.serialize(e))))}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=this.items.map((e=>e.toTextObject()));for(const r of t)e[r[Wc.NAME]]=r;return e}}Vf.NAME="Extensions";class $f{static register(e,t){this.items.set(e,t)}static create(e){const t=new qf(e),r=this.items.get(t.type);return r?new r(e):t}}$f.items=new Map;let Jf=class{toAsnAlgorithm(e){if("rsassa-pkcs1-v1_5"===e.name.toLowerCase()){if(!("hash"in e))return new io({algorithm:fa,parameters:null});{let t;if("string"==typeof e.hash)t=e.hash;else{if(!e.hash||"object"!=typeof e.hash||!("name"in e.hash)||"string"!=typeof e.hash.name)throw new Error("Cannot get hash algorithm name");t=e.hash.name.toUpperCase()}switch(t.toLowerCase()){case"sha-1":return new io({algorithm:ba,parameters:null});case"sha-256":return new io({algorithm:ga,parameters:null});case"sha-384":return new io({algorithm:ma,parameters:null});case"sha-512":return new io({algorithm:wa,parameters:null})}}}return null}toWebAlgorithm(e){switch(e.algorithm){case fa:return{name:"RSASSA-PKCS1-v1_5"};case ba:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case ga:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case ma:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case wa:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}}}return null}};Jf=An([fu()],Jf),cu.registerSingleton(hc,Jf);class Wf{addPadding(e,t){const r=le.vJ.toUint8Array(t),n=new Uint8Array(e);return n.set(r,e-r.length),n}removePadding(e,t=!1){let r=le.vJ.toUint8Array(e);for(let e=0;e<r.length;e++)if(r[e]){r=r.slice(e);break}if(t&&r[0]>127){const e=new Uint8Array(r.length+1);return e.set(r,1),e.buffer}return r.buffer}toAsnSignature(e,t){if("ECDSA"===e.name){const r=e.namedCurve,n=Wf.namedCurveSize.get(r)||Wf.defaultNamedCurveSize,i=new ua,o=le.vJ.toUint8Array(t);return i.r=this.removePadding(o.slice(0,n),!0),i.s=this.removePadding(o.slice(n,n+n),!0),Sn.serialize(i)}return null}toWebSignature(e,t){if("ECDSA"===e.name){const r=Sn.parse(t,ua),n=e.namedCurve,i=Wf.namedCurveSize.get(n)||Wf.defaultNamedCurveSize,o=this.addPadding(i,this.removePadding(r.r)),s=this.addPadding(i,this.removePadding(r.s));return(0,le.$e)(o,s)}return null}}Wf.namedCurveSize=new Map,Wf.defaultNamedCurveSize=32;const Gf="1.3.101.110",Zf="1.3.101.111",Yf="1.3.101.112",Xf="1.3.101.113";let Qf=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=Yf;break;case"ed448":t=Xf}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=Gf;break;case"x448":t=Zf}}return t?new io({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case Yf:return{name:"EdDSA",namedCurve:"Ed25519"};case Xf:return{name:"EdDSA",namedCurve:"Ed448"};case Gf:return{name:"ECDH-ES",namedCurve:"X25519"};case Zf:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};Qf=An([fu()],Qf),cu.registerSingleton(hc,Qf);var el;(class extends Of{constructor(e){Of.isAsnEncoded(e)?super(e,lc):super(e),this.tag=Bf.CertificateRequestTag}onInit(e){this.tbs=Sn.serialize(e.certificationRequestInfo),this.publicKey=new jf(e.certificationRequestInfo.subjectPKInfo);const t=cu.resolve(dc);this.signatureAlgorithm=t.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signature,this.attributes=e.certificationRequestInfo.attributes.map((e=>$f.create(Sn.serialize(e))));const r=this.getAttribute(Du);this.extensions=[],r instanceof Vf&&(this.extensions=r.items),this.subjectName=new af(e.certificationRequestInfo.subject),this.subject=this.subjectName.toString()}getAttribute(e){for(const t of this.attributes)if(t.type===e)return t;return null}getAttributes(e){return this.attributes.filter((t=>t.type===e))}getExtension(e){for(const t of this.extensions)if(t.type===e)return t;return null}getExtensions(e){return this.extensions.filter((t=>t.type===e))}async verify(e=tf.get()){const t={...this.publicKey.algorithm,...this.signatureAlgorithm},r=await this.publicKey.export(t,["verify"],e),n=cu.resolveAll(Pf).reverse();let i=null;for(const e of n)if(i=e.toWebSignature(t,this.signature),i)break;if(!i)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await e.subtle.verify(this.signatureAlgorithm,r,i,this.tbs)}toTextObject(){const e=this.toTextObjectEmpty(),t=Sn.parse(this.rawData,lc),r=t.certificationRequestInfo,n=new Wc("",{Version:`${lo[r.version]} (${r.version})`,Subject:this.subject,"Subject Public Key Info":this.publicKey});if(this.attributes.length){const e=new Wc("");for(const t of this.attributes){const r=t.toTextObject();e[r[Wc.NAME]]=r}n.Attributes=e}return e.Data=n,e.Signature=new Wc("",{Algorithm:Zc.serializeAlgorithm(t.signatureAlgorithm),"":t.signature}),e}}).NAME="PKCS#10 Certificate Request",function(e){e[e.unspecified=0]="unspecified",e[e.keyCompromise=1]="keyCompromise",e[e.cACompromise=2]="cACompromise",e[e.affiliationChanged=3]="affiliationChanged",e[e.superseded=4]="superseded",e[e.cessationOfOperation=5]="cessationOfOperation",e[e.certificateHold=6]="certificateHold",e[e.removeFromCRL=8]="removeFromCRL",e[e.privilegeWithdrawn=9]="privilegeWithdrawn",e[e.aACompromise=10]="aACompromise"}(el||(el={})),If.register($n,Uf),If.register(Si,Df),If.register(Ci,Kf),If.register(Zi,Lf),If.register(qn,Nf),If.register(Vi,zf),$f.register(Ru,Ff),$f.register(Du,Vf),cu.registerSingleton(Pf,class{toAsnSignature(e,t){return le.vJ.toArrayBuffer(t)}toWebSignature(e,t){return le.vJ.toArrayBuffer(t)}}),cu.registerSingleton(Pf,Wf),Wf.namedCurveSize.set("P-256",32),Wf.namedCurveSize.set("K-256",32),Wf.namedCurveSize.set("P-384",48),Wf.namedCurveSize.set("P-521",66),window.Buffer=window.Buffer||ae.Buffer;var tl=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},rl=function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},nl=function(e){return tl(void 0,void 0,Promise,(function(){var t,r,n,i,o,s,a;return rl(this,(function(u){switch(u.label){case 0:return t=e.slice(37,e.length),r=t.slice(0,16),n=(t[16]<<8)+t[17],i=t.slice(18,18+n),o=t.slice(18+n,t.length),s=function(e){var t=ne(ae.Buffer.from(e)),r={};return Object.keys(t).forEach((function(e){switch(parseInt(e)){case 1:2===t[e]&&(r.kty="EC");break;case 3:-7===t[e]&&(r.alg="ES256");break;case-1:1===t[e]&&(r.crv="P-256");break;case-2:r.x=oe().encoder.encodeBase64Url(new Uint8Array(t[e]));break;case-3:r.y=oe().encoder.encodeBase64Url(new Uint8Array(t[e]))}})),r}(o),[4,new(se().Key)("jwk",s).export("pem")];case 1:return a=u.sent(),[2,{aaguid:r,credentialId:oe().encoder.encodeBase64Url(i),publicKeyPem:a}]}}))}))},il=fe,ol=function(e,t){return tl(void 0,void 0,Promise,(function(){var r,n,i,o,s,a,u,c,f,l,h,d,p;return rl(this,(function(y){switch(y.label){case 0:return r=se(),ue(e)?(n=e.response,i=fe(n),o=i.attestationObject.authData,[4,ce(i.clientDataJSON,o,"webauthn.create",t)]):(console.log("Credential ID is not valid"),[2,{valid:!1}]);case 1:return(s=y.sent()).valid?[4,r.hash.compute(new Uint8Array(n.clientDataJSON),"SHA-256")]:(console.log(s.msg),[2,{valid:!1}]);case 2:return a=y.sent(),u=i.attestationObject.fmt,c=i.attestationObject.attStmt,"packed"!==u?[3,5]:((f=new Uint8Array(o.length+a.length)).set(o,0),f.set(a,o.length),l=oe().formatter.binToPem(new Uint8Array(c.x5c[0]),"certificate"),h=new Cf(l),d=new r.Key("der",new Uint8Array(h.publicKey.rawData)),p=new Uint8Array(c.sig),[4,r.pkc.verify(new Uint8Array(f),p,d,"SHA-256",{format:"der"})]);case 3:return y.sent()?[4,nl(new Uint8Array(o))]:(console.log("Signature is not valid"),[2,{valid:!1}]);case 4:return[2,{valid:!0,credentialPublicKey:y.sent().publicKeyPem,attestationCertificate:l}];case 5:return console.log("This format is not supported: ".concat(u)),[2,{valid:!1}]}}))}))},sl=function(e,t,r){return n=void 0,i=void 0,s=function(){var n,i,o,s,a,u,c,f,l;return function(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}(this,(function(h){switch(h.label){case 0:return n=se(),ue(e)?(i=e.response,[4,n.hash.compute(new Uint8Array(i.clientDataJSON),"SHA-256")]):[2,{valid:!1,msg:"InvalidId"}];case 1:return o=h.sent(),s=fe(i),a=s.authenticatorData,u=s.signature,[4,ce(s.clientDataJSON,a,"webauthn.get",t)];case 2:return(c=h.sent()).valid?((f=new Uint8Array(a.length+o.length)).set(a,0),f.set(o,a.length),l=new n.Key("pem",r),[4,n.pkc.verify(f,u,l,"SHA-256",{format:"der"})]):(console.log(c.msg),[2,{valid:!1,msg:c.msg}]);case 3:return[2,h.sent()?{valid:!0,msg:"OK"}:{valid:!1,msg:"InvalidSignature"}]}}))},new((o=Promise)||(o=Promise))((function(e,t){function r(e){try{u(s.next(e))}catch(e){t(e)}}function a(e){try{u(s.throw(e))}catch(e){t(e)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,a)}u((s=s.apply(n,i||[])).next())}));var n,i,o,s},al=function(e){return new Uint8Array(e.rawId)};const ul={parseAuthenticatorResponse:fe,verifyAttestation:ol,verifyAssertion:sl,getPublicKeyIdFromAssertion:al}})(),i})()));